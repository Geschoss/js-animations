var gt=Object.defineProperty;var wt=(i,e,t)=>e in i?gt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var n=(i,e,t)=>(wt(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();function lt(i,e){return e.expamples.find(({settings:t})=>t.name===i)}function ht(i,e){let t=new URL(window.location.href);t.searchParams.set(i,e),window.history.pushState("Animations",i,t)}function ct(){let i=new URLSearchParams(window.location.search);return{chapter:i.get("chapter")||"",example:i.get("example")||""}}function Tt(i,e){let t=e[i];return t??Object.values(e)[0]}function vt(i,e){let t=lt(i,e);return t??e.expamples[0]}const bt=()=>{let i={chapters:document.getElementById("chapters_menu"),examples:document.getElementById("examples_menu"),canvas:document.getElementById("canvas"),body:document.body};return{...i,onResize:kt(),updateExamplesMenu:Mt(i.examples),updateChaptersMenu:_t(i.chapters)}};function kt(){return i=>{window.addEventListener("resize",()=>{i()})}}function Mt(i){return(e,t,s)=>{Pt(i);let o;e.expamples.forEach(r=>{let a=document.createElement("div");a.classList.add("menu__item"),a.innerText=r.settings.name,t===r&&(o=a,o.classList.add("menu__item_selected")),a.addEventListener("click",()=>{o!==a&&(o&&o.classList.remove("menu__item_selected"),o=a,o.classList.add("menu__item_selected"),ht("example",r.settings.name),s(r.settings.name))}),i.appendChild(a)})}}function _t(i){return(e,t,s)=>{let o;Object.keys(e).forEach(r=>{let a=e[r],l=document.createElement("div");l.classList.add("menu__item"),l.innerText=a.name,t===a&&(o=l,o.classList.add("menu__item_selected")),l.addEventListener("click",()=>{o!==l&&(o&&o.classList.remove("menu__item_selected"),o=l,o.classList.add("menu__item_selected"),ht("chapter",r),s(r))}),i.appendChild(l)}),s(t.name)}}function Pt(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function k(i){return i==null||i==null}function St(i){return Object.values(i)}function ge(i,e){let t=[];for(let s=0;s<i;s++)t.push(e(s,i));return t}function pe(i,e){return Math.random()>.5?i:e}function Et(i){const e=i.reduce((T,U)=>({...T,[U.name]:U}),{}),t=bt(),s=ct(),o=t.canvas.getContext("2d");let r=Tt(s.chapter,e),a,l,f,m={width:t.body.offsetWidth,height:t.body.offsetHeight,injectors:{}},p=m;t.updateChaptersMenu(e,r,ft),t.onResize(()=>{p={...p,width:a.settings.width||t.body.offsetWidth,height:a.settings.height||t.body.offsetHeight},t.canvas.width=p.width,t.canvas.height=p.height,a.resize&&a.resize(o,p)});function ft(T){Be(),r=e[T],a=vt(s.example,r),t.updateExamplesMenu(r,a,yt),Ce()}function yt(T){Be(),a=lt(T,r),Ce()}function Ce(){var U;if(a.inited)return;let T=((U=a.settings.injectors)==null?void 0:U.reduce((pt,je)=>({...pt,[je.name]:It(je,{canvas:t.canvas})}),{}))||{};p={width:a.settings.width||t.body.offsetWidth,height:a.settings.height||t.body.offsetHeight,injectors:T},t.canvas.width=p.width,t.canvas.height=p.height,a.init(t.canvas,p,o),a.inited=!0,De(0)}function De(T){k(f)?mt():f(),f=a.render(o,p,T)||null,l=requestAnimationFrame(De)}function Be(){l&&cancelAnimationFrame(l),a&&a.inited&&(k(p.injectors)||St(p.injectors).map(T=>T.destroy()),a.destroy(t.canvas),a.inited=!1),p=m}function mt(){o.clearRect(0,0,t.canvas.width,t.canvas.height)}}function It(i,e){let t=i.deps.map(({name:s})=>{let o=e[s];if(k(o))throw new Error(`${i.name} has unknow dep ${s}`);return o});return new i.instance(...t)}class Lt{constructor(e=0,t=0){n(this,"dx");n(this,"dy");this.dx=e,this.dy=t}think(e){e.x+=this.dx,e.y+=this.dy}}class $t{constructor(e=.3,t=.3){n(this,"vy");n(this,"vx");this.vx=e,this.vy=t}think(e){e.x+=this.vx,e.y+=this.vy}}class Ae{think(){}}class Re{render(e,{x:t,y:s,radius:o,color:r}){e.save(),e.beginPath(),e.arc(t,s,o,0,2*Math.PI),e.fillStyle=r,e.fill(),e.closePath(),e.restore()}}class Wt{render(e,{x:t,y:s,width:o,height:r,color:a}){e.save(),e.strokeStyle=a,e.beginPath(),e.rect(t,s,o,r),e.closePath(),e.stroke(),e.restore()}}let dt=class{constructor(e=0,t=0,s=10,o="#ff6600",r=new Ae,a=new Re){n(this,"x");n(this,"y");n(this,"color");n(this,"radius");n(this,"behavior");n(this,"view");this.x=e,this.y=t,this.color=o,this.radius=s,this.view=a,this.behavior=r}static create({x:e=0,y:t=0,radius:s=10,color:o="#ff6600",view:r=new Re,behavior:a=new Ae}){return new dt(e,t,s,o,a,r)}think(){this.behavior.think(this)}render(e){this.view.render(e,this)}};class R{constructor(e=100,t=100,s=200,o=200,r="#ff0000",a=new Ae,l=new Wt){n(this,"width");n(this,"height");n(this,"y");n(this,"x");n(this,"right");n(this,"bottom");n(this,"color");n(this,"behavior");n(this,"view");this.x=e,this.y=t,this.color=r,this.width=s,this.height=o,this.right=e+s,this.bottom=t+o,this.view=l,this.behavior=a}static create({x:e,y:t,width:s,height:o,color:r,view:a,behavior:l}){return new R(e,t,s,o,r,l,a)}think(){this.behavior.think(this)}render(e){this.view.render(e,this)}}class At{constructor(e){n(this,"x",0);n(this,"y",0);n(this,"pressed",!1);n(this,"rect");n(this,"canvas");n(this,"touch_start",()=>{this.pressed=!0});n(this,"touch_end",()=>{this.pressed=!1,this.x=0,this.y=0});n(this,"touch_move",e=>{let t=0,s=0,o=e.touches[0];o.pageX||o.pageY?(t=o.pageX,s=o.pageY):(t=o.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=o.clientY+document.body.scrollTop+document.documentElement.scrollTop),t-=this.canvas.offsetLeft,s-=this.canvas.offsetTop,this.x=t,this.y=s});this.canvas=e,e.addEventListener("touchstart",this.touch_start,!1),e.addEventListener("touchmove",this.touch_move,!1),e.addEventListener("touchend",this.touch_end,!1)}destroy(){this.canvas.removeEventListener("touchstart",this.touch_start,!1),this.canvas.removeEventListener("touchmove",this.touch_move,!1),this.canvas.removeEventListener("touchend",this.touch_end,!1)}}class z{constructor(e){n(this,"x",0);n(this,"y",0);n(this,"leftButtonDown",!1);n(this,"rect");n(this,"canvas");n(this,"mousedown",e=>{this.leftButtonDown=!0});n(this,"mouseup",e=>{this.leftButtonDown=!1});n(this,"move",e=>{let t=0,s=0;e.pageX||e.pageY?(t=e.pageX,s=e.pageY):(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),t-=this.canvas.offsetLeft,s-=this.canvas.offsetTop,this.x=t,this.y=s});this.canvas=e,e.addEventListener("mousemove",this.move,!1),e.addEventListener("mousedown",this.mousedown,!1),e.addEventListener("mouseup",this.mouseup,!1)}destroy(){this.canvas.removeEventListener("mousemove",this.move,!1),this.canvas.removeEventListener("mousedown",this.mousedown,!1),this.canvas.removeEventListener("mouseup",this.mouseup,!1)}copyPos(){return{x:this.x,y:this.y}}}const Y={name:"mouse",instance:z,deps:[{name:"canvas"}]};var G=(i=>(i.KeyO="KeyO",i.KeyP="KeyP",i.KeyL="KeyL",i.Space="Space",i.Enter="Enter",i.ArrowUp="ArrowUp",i.Semicolon="Semicolon",i.ArrowLeft="ArrowLeft",i.ArrowDown="ArrowDown",i.ArrowRight="ArrowRight",i))(G||{});function Ye(){return Math.random().toString(16).slice(2)}class d{constructor(){n(this,"keys_pressed",[]);n(this,"up_subscribers",[]);n(this,"down_subscribers",[]);n(this,"keydown",e=>{let t=e.code;this.keys_pressed.push(t),this.down_subscribers.forEach(({keys:s,cb:o})=>{(s.length===0||s.includes(t))&&o(t)})});n(this,"keyup",e=>{this.keys_pressed=this.keys_pressed.filter(s=>s!==e.code);let t=e.code;this.up_subscribers.forEach(({keys:s,cb:o})=>{(s.length===0||s.includes(t))&&o(t)})});window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1)}destroy(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1)}pressed(e){return k(e)?this.keys_pressed.length!=0:this.keys_pressed.includes(e)}down(e){let t=Ye();return this.down_subscribers.push({...e,hash:t}),t}up(e){let t=Ye();return this.up_subscribers.push({...e,hash:t}),t}}n(d,"keys",G);const we={name:"keyboard",instance:d,deps:[]};class ut{constructor(){n(this,"rect");n(this,"velocity");n(this,"keyboard");this.rect=R.create({x:150,y:350,width:50,height:50,color:"#00ff00"}),this.velocity=0}render(e){this.rect.render(e)}think(){this.rect.y+=this.velocity,this.velocity<6&&(this.velocity+=.2)}collision(e,t){return this.rect.color="#00ff00",t.y>this.rect.y||t.bottom<this.rect.y+this.rect.width?!0:e.some(s=>s.collision(this.rect))}}const h=class{constructor(e,t,s){n(this,"top");n(this,"bottom");n(this,"x");n(this,"y");n(this,"behavior");this.x=e,this.y=t,this.behavior=new Lt(h.SPEED),this.top=R.create({x:e,y:t,width:h.WIDTH,height:h.MIN_HEIGHT+Math.random()*(s-(h.GAP+h.MIN_HEIGHT))}),this.bottom=R.create({x:this.top.x,y:this.top.bottom+h.GAP,width:h.WIDTH,height:s-this.top.height-h.GAP})}think(){this.behavior.think(this),this.top.x=this.x,this.bottom.x=this.x}render(e){this.top.render(e),this.bottom.render(e)}collision(e){let t={x:e.x,y:e.y},s={x:e.x+e.width,y:e.y},o={x:e.x,y:e.y+e.height},r={x:e.x+e.width,y:e.y+e.height},a={x:this.top.x,y:this.top.y+this.top.height},l={x:this.top.x+h.WIDTH,y:this.top.y+this.top.height},f={x:this.bottom.x,y:this.bottom.y},m={x:this.bottom.x+h.WIDTH,y:this.bottom.y};return s.x<this.x||this.x+h.WIDTH<e.x?!1:!!(H(a.x,s.x,l.x)&&H(this.y,s.y,a.y)||H(a.x,t.x,l.x)&&H(this.y,t.y,a.y)||H(f.x,r.x,m.x)&&f.y<r.y||H(f.x,o.x,m.x)&&f.y<o.y)}static create(e){let t=[],s=e.width,o=e.y,r=e.height,a=e.width/(h.WIDTH+h.DISTANCE_BEETWEN)+1;for(let l=0;l<a;l++)t.push(new h(s,o,r)),s+=h.WIDTH+h.DISTANCE_BEETWEN;return t}static move(e,t){let s=e[0],o=e[e.length-1],r=t.x-h.WIDTH;if(s.x<r){e.shift();let a=t.y,l=t.height;e.push(new h(o.x+h.WIDTH+h.DISTANCE_BEETWEN,a,l))}}};let v=h;n(v,"GAP",200),n(v,"WIDTH",50),n(v,"MIN_HEIGHT",10),n(v,"DISTANCE_BEETWEN",290),n(v,"SPEED",-4);function H(i,e,t){return i<e&&e<t}let A={type:"init",bird:null,screen:null,pipes:[]};const Ct={settings:{name:"Flappy_Bird",injectors:[we]},init(i,e){A.screen=Rt(e)},render(i,e){switch(A.screen.render(i),A.type){case"init":Dt(A,e,i);break;case"play":Bt(A,e,i);break;case"dead":jt(A,e,i);break}},destroy(){A=null}};function Dt(i,e,t){t.font="30px Arial",t.fillStyle="#0000ff",t.fillText("Press ENTER to start",e.width/2-150,e.height/2),e.injectors.keyboard.pressed(d.keys.Enter)&&(i.type="play",i.bird=new ut,i.pipes=v.create(i.screen))}function Bt(i,e,t){if(e.injectors.keyboard.pressed(d.keys.Space)&&(i.bird.velocity=-6),i.bird.think(),i.bird.collision(i.pipes,i.screen)){i.type="dead";return}i.bird.render(t),i.pipes.forEach(s=>{s.think(),s.render(t)}),v.move(i.pipes,i.screen)}function jt(i,e,t){t.font="30px Arial",t.fillStyle="#0000ff",t.fillText("You are dead",e.width/2-100,e.height/2-30),t.fillText("Press ENTER to start",e.width/2-150,e.height/2),e.injectors.keyboard.pressed(d.keys.Enter)&&(i.type="play",i.bird=new ut,i.pipes=v.create(i.screen))}function Rt(i){let e=i.width*5/100,t=i.height*10/100;return new R(e,t,i.width-2*e,i.height-2*t,"#0000ff")}class Yt{constructor(){n(this,"vr",0);n(this,"vx",0);n(this,"vy",0);n(this,"trust",0);n(this,"gravity",.01);n(this,"rotation",0)}left(){this.vr=-3}rigth(){this.vr=3}up(){this.trust=.05}forward(){this.vr=0}stop(){this.trust=0}calculate(){this.rotation+=this.vr*Math.PI/180;let e=Math.cos(this.rotation)*this.trust,t=Math.sin(this.rotation)*this.trust;return this.vx+=e,this.vy+=t,this.vx+=this.vx>0?-this.gravity:this.gravity,this.vy+=this.vy>0?-this.gravity:this.gravity,{vx:this.vx,vy:this.vy,rotation:this.rotation}}}class Ht{constructor(e,t,s=0,o=0,r,a){n(this,"x");n(this,"y");n(this,"width");n(this,"height");n(this,"rotation");n(this,"moving");n(this,"keyboard");n(this,"acceleration");n(this,"weapon");n(this,"view");this.x=s,this.y=o,this.width=25,this.height=20,this.rotation=0,this.keyboard=e,this.moving=!1,this.acceleration=t,this.weapon=r,this.view=new a(r),this.keyboard.up({keys:[d.keys.ArrowUp,d.keys.ArrowLeft,d.keys.ArrowRight],cb:l=>{if(l===d.keys.ArrowUp){this.moving=!1,this.acceleration.stop();return}this.acceleration.forward()}})}changeChip(e){this.view=new e(this.weapon)}cnahgeWeapon(e){this.view.changeWeapon(e)}shot(e){const t=this.view.shot(this);t&&e.bullets.push(...t)}think(e){this.keyboard.pressed(d.keys.Space)&&this.shot(e),this.keyboard.pressed(d.keys.ArrowLeft)&&this.acceleration.left(),this.keyboard.pressed(d.keys.ArrowRight)&&this.acceleration.rigth(),this.keyboard.pressed(d.keys.ArrowUp)&&(this.acceleration.up(),this.moving=!0);let{vx:t,vy:s,rotation:o}=this.acceleration.calculate();this.rotation=o,this.x+=t,this.y+=s}render(e){this.view.render(e,this)}}class Xt{constructor(e){n(this,"name","classic");n(this,"weapon_name");n(this,"weapon");const t=new e;this.weapon_name=t.name,this.weapon=new e}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapon=new e}shot(e){const t=this.weapon.shot({x:e.x,y:e.y,rotation:e.rotation});if(t)return[t]}render(e,t){if(e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(10,0),e.lineTo(-10,10),e.lineTo(-5,0),e.lineTo(-10,-10),e.lineTo(10,0),e.stroke(),t.moving){let s=Math.random()>.5?17:15;e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-7.5,-5),e.lineTo(-s,0),e.lineTo(-7.5,5),e.stroke()}e.restore()}}class Nt{constructor(e){n(this,"name","эх-100");n(this,"weapon_name");n(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}shot(e){const o=this.weapons[0].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*1.88),y:e.y+15*Math.sin(e.rotation+Math.PI*1.88),rotation:e.rotation}),r=.12,a=this.weapons[1].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*r),y:e.y+15*Math.sin(e.rotation+Math.PI*r),rotation:e.rotation});let l=[];return o&&l.push(o),a&&l.push(a),l.length>0?l:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(15,10),e.lineTo(10,10),e.lineTo(10,5),e.lineTo(-10,5),e.lineTo(-10,10),e.lineTo(-15,10),e.lineTo(-15,-10),e.lineTo(-10,-10),e.lineTo(-10,-5),e.lineTo(-10,-5),e.lineTo(10,-5),e.lineTo(10,-10),e.lineTo(15,-10),e.stroke(),e.beginPath(),e.moveTo(15,10),e.quadraticCurveTo(30,0,15,-10),e.stroke(),t.moving&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-15,-10),e.lineTo(-He(25,22),-5),e.lineTo(-15,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-15,10),e.lineTo(-He(25,22),5),e.lineTo(-15,0),e.stroke()),e.restore()}}function He(i,e){return Math.random()>.5?i:e}class qt{constructor(e){n(this,"name","еф-100");n(this,"weapon_name");n(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}shot(e){const o=this.weapons[0].shot({x:e.x+17*Math.cos(e.rotation+Math.PI*1.88),y:e.y+17*Math.sin(e.rotation+Math.PI*1.88),rotation:e.rotation}),r=.12,a=this.weapons[1].shot({x:e.x+17*Math.cos(e.rotation+Math.PI*r),y:e.y+17*Math.sin(e.rotation+Math.PI*r),rotation:e.rotation});let l=[];return o&&l.push(o),a&&l.push(a),l.length>0?l:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.strokeStyle="#ff0000",e.beginPath(),e.arc(0,0,15,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.arc(0,0,5,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(3,15),e.quadraticCurveTo(5,22,10,21),e.stroke(),e.beginPath(),e.moveTo(8,13),e.quadraticCurveTo(10,18,15,17),e.stroke(),e.beginPath(),e.moveTo(15,17),e.lineTo(20,17),e.stroke(),e.beginPath(),e.moveTo(10,21),e.lineTo(20,21),e.stroke(),e.beginPath(),e.moveTo(20,21),e.lineTo(20,17),e.stroke(),e.beginPath(),e.moveTo(20,21),e.lineTo(24,19),e.stroke(),e.beginPath(),e.moveTo(20,17),e.lineTo(24,18),e.stroke(),e.beginPath(),e.moveTo(13,7),e.lineTo(30,3),e.stroke(),e.beginPath(),e.moveTo(15,2),e.lineTo(30,2),e.stroke(),e.beginPath(),e.moveTo(13,-7),e.lineTo(30,-3),e.stroke(),e.beginPath(),e.moveTo(15,-2),e.lineTo(30,-2),e.stroke(),e.beginPath(),e.moveTo(15,0),e.lineTo(5,0),e.stroke(),e.beginPath(),e.moveTo(0,15),e.lineTo(0,5),e.stroke(),e.beginPath(),e.moveTo(0,-15),e.lineTo(0,-5),e.stroke(),e.beginPath(),e.moveTo(-15,0),e.lineTo(-5,0),e.stroke(),e.beginPath(),e.moveTo(4,4),e.lineTo(11,11),e.stroke(),e.beginPath(),e.moveTo(4,-4),e.lineTo(11,-11),e.stroke(),e.beginPath(),e.moveTo(-4,-4),e.lineTo(-11,-11),e.stroke(),e.beginPath(),e.moveTo(-4,4),e.lineTo(-11,11),e.stroke(),t.moving&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-10,-12),e.lineTo(-he(21,19),-11),e.lineTo(-14,-7),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-12,-7),e.lineTo(-he(22,20),-4),e.lineTo(-14,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-12,7),e.lineTo(-he(22,20),4),e.lineTo(-14,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-14,7),e.lineTo(-he(21,19),11),e.lineTo(-10,12),e.stroke()),e.restore()}}function he(i,e){return Math.random()>.5?i:e}class Ot{constructor(e){n(this,"name","т-50");n(this,"weapon_name");n(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}shot(e){const s=[],r=this.weapons[0].shot({x:e.x+10*Math.cos(e.rotation+Math.PI*1.5),y:e.y+10*Math.sin(e.rotation+Math.PI*1.5),rotation:e.rotation});r&&s.push(r);const a=.5,l=this.weapons[1].shot({x:e.x+10*Math.cos(e.rotation+Math.PI*a),y:e.y+10*Math.sin(e.rotation+Math.PI*a),rotation:e.rotation});return l&&s.push(l),s.length>0?s:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(20,0),e.lineTo(15,-5),e.lineTo(-15,-5),e.lineTo(-20,-10),e.lineTo(-20,10),e.lineTo(-15,5),e.lineTo(15,5),e.lineTo(20,0),e.stroke(),e.beginPath(),e.moveTo(0,-5),e.lineTo(0,-10),e.lineTo(5,-10),e.lineTo(5,-5),e.stroke(),e.beginPath(),e.moveTo(0,5),e.lineTo(0,10),e.lineTo(5,10),e.lineTo(5,5),e.stroke(),t.moving&&(e.strokeStyle="#ff9200",e.beginPath(),e.moveTo(-20,-10),e.lineTo(-pe(30,27),-6),e.lineTo(-20,-2),e.stroke(),e.beginPath(),e.moveTo(-20,10),e.lineTo(-pe(30,27),6),e.lineTo(-20,2),e.stroke()),e.restore()}}class Gt{constructor(e){n(this,"name","еф-50");n(this,"weapon_name");n(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e,new e]}shot(e){const s=[],r=this.weapons[0].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*1.84),y:e.y+15*Math.sin(e.rotation+Math.PI*1.84),rotation:e.rotation-.03});r&&s.push(r);const a=.16,l=this.weapons[1].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*a),y:e.y+15*Math.sin(e.rotation+Math.PI*a),rotation:e.rotation+.03});l&&s.push(l);const f=0,m=this.weapons[2].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*f),y:e.y+15*Math.sin(e.rotation+Math.PI*f),rotation:e.rotation});return m&&s.push(m),s.length>0?s:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(20,0),e.lineTo(15,-10),e.lineTo(-15,-15),e.lineTo(-10,0),e.lineTo(-15,15),e.lineTo(15,10),e.lineTo(20,0),e.stroke(),e.beginPath(),e.moveTo(15,-10),e.quadraticCurveTo(8,0,15,10),e.stroke(),e.beginPath(),e.moveTo(-12,-2),e.lineTo(-20,-2),e.lineTo(-20,-9),e.lineTo(-14,-9),e.stroke(),e.beginPath(),e.moveTo(-12,2),e.lineTo(-20,2),e.lineTo(-20,9),e.lineTo(-14,9),e.stroke(),e.beginPath(),e.moveTo(7,11),e.lineTo(7,15),e.lineTo(14,15),e.stroke(),e.beginPath(),e.moveTo(7,-11),e.lineTo(7,-15),e.lineTo(14,-15),e.stroke(),t.moving&&(e.strokeStyle="#ff9200",e.beginPath(),e.moveTo(-20,-9),e.lineTo(-pe(30,27),-6),e.lineTo(-20,-2),e.stroke(),e.beginPath(),e.moveTo(-20,9),e.lineTo(-pe(30,27),6),e.lineTo(-20,2),e.stroke()),e.restore()}}class zt{constructor(){n(this,"name","Рокетница");n(this,"rate");n(this,"prevShotTime");this.rate=1,this.prevShotTime=0}shot(e){let t=new Date().getTime();if(t-this.prevShotTime>1e3/this.rate)return this.prevShotTime=t,new Ut(e.x,e.y,e.rotation)}}class Ut{constructor(e=0,t=0,s=0,o=0,r=.04){n(this,"x");n(this,"y");n(this,"speed");n(this,"rotation");n(this,"acceleration");n(this,"max_speed");this.x=e+5*Math.cos(s),this.y=t+5*Math.sin(s),this.speed=o,this.rotation=s,this.acceleration=r,this.max_speed=6}think(){this.speed+=this.acceleration,this.speed>=this.max_speed?this.acceleration=0:this.acceleration+=.02,this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(8,1),e.lineTo(-8,1),e.lineTo(-8,-1),e.lineTo(8,-1),e.lineTo(8,1),e.stroke(),Math.random()>.1&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-8,-2),e.lineTo(-12,0),e.lineTo(-8,2),e.stroke()),e.restore()}}class Ft{constructor(){n(this,"name","Пулимет");n(this,"rate");n(this,"bulletSpeed");n(this,"prevShotTime");this.rate=10,this.prevShotTime=0,this.bulletSpeed=6}shot(e){let t=new Date().getTime();if(t-this.prevShotTime>1e3/this.rate)return this.prevShotTime=t,new Kt(e.x,e.y,e.rotation,this.bulletSpeed)}}class Kt{constructor(e,t,s,o=3){n(this,"x");n(this,"y");n(this,"speed");n(this,"rotation");this.x=e,this.y=t,this.speed=o,this.rotation=s}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){let t=5*Math.cos(this.rotation),s=5*Math.sin(this.rotation);e.save(),e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=2,e.moveTo(this.x,this.y),e.lineTo(this.x+t,this.y+s),e.closePath(),e.stroke(),e.restore()}}class Jt{constructor(){n(this,"name","Плазма");n(this,"rate");n(this,"bulletSpeed");n(this,"prevShotTime");this.rate=5,this.prevShotTime=0,this.bulletSpeed=6}shot(e){let t=new Date().getTime();if(t-this.prevShotTime>1e3/this.rate)return this.prevShotTime=t,new Vt(e.x,e.y,e.rotation,this.bulletSpeed)}}class Vt{constructor(e,t,s,o=4){n(this,"x");n(this,"y");n(this,"speed");n(this,"rotation");this.x=e,this.y=t,this.speed=o,this.rotation=s}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){e.save(),e.beginPath(),e.fillStyle="#00ff00",e.beginPath(),e.arc(this.x,this.y,3,0,2*Math.PI),e.fill(),e.closePath(),e.restore()}}const ce=[Gt,Ot,Xt,Nt,qt],me=[Ft,zt,Jt];let B=0,j=0,X={enemies:[],bullets:[]},M;const Qt={settings:{name:"Spacesship",injectors:[we]},init(i,e){let t=e.injectors.keyboard,s=new Yt,o=ce[j];M=new Ht(t,s,e.width/2,e.height/2,me[B],o),t.down({keys:[d.keys.KeyL,d.keys.Semicolon,d.keys.KeyO,d.keys.KeyP],cb:r=>{r===d.keys.KeyL&&Ne(M,ce,1),r===d.keys.Semicolon&&Ne(M,ce,-1),r===d.keys.KeyO&&qe(M,1),r===d.keys.KeyP&&qe(M,-1)}})},render(i,e){xt(i,e),ei(i,e,M),X.enemies.forEach(t=>{t.think(X),t.render(i)}),X.bullets.forEach(t=>{t.think(X),t.render(i)}),M.think(X),M.render(i),Zt(X,e)},destroy(){M=void 0}};function Zt(i,e){i.bullets=i.bullets.filter(t=>Xe(0,e.width,t.x)&&Xe(0,e.height,t.y))}function Xe(i,e,t){return t>i&&t<e}function Ne(i,e,t){j+=t,j>=e.length&&(j=0),j<0&&(j=e.length-1),i.changeChip(e[j])}function qe(i,e){B+=e,B>=me.length&&(B=0),B<0&&(B=me.length-1),i.cnahgeWeapon(me[B])}function xt(i,e){i.save(),i.fillStyle="#ff0000",i.font="20px Arial",i.fillText("Смена корабля: Д или Ж",10,e.height-10),i.fillText("Смена оружия: Щ или З",10,e.height-30),i.fillText("Летать на стрелки",10,e.height-50),i.restore()}function ei(i,e,t){i.save(),i.fillStyle="#ff0000",i.font="20px Arial",i.fillText(`корабль: ${t.view.name}`,10,e.height-80),i.fillText(`оружие: ${t.view.weapon_name}`,10,e.height-100),i.restore()}const ti={name:"games",expamples:[Qt,Ct]};let P=class{constructor(e=0,t=0,s=0,o="#ff6600"){n(this,"x");n(this,"y");n(this,"r");n(this,"c");n(this,"vx");n(this,"vy");n(this,"originX");n(this,"originY");this.x=e,this.y=t,this.r=s,this.c=o,this.vx=0,this.vy=0,this.originX=e,this.originY=t}set(e,t){this.x=e,this.y=t}think(e,t){let s=this.x-e.x,o=this.y-e.y;if(Math.sqrt(s*s+o*o)<e.r){let a=Math.atan2(o,s),l=e.x+Math.cos(a)*e.r,f=e.y+Math.sin(a)*e.r;this.vx+=l-this.x,this.vy+=f-this.y}this.vx+=t.spring.vx(this.x,this.originX,t),this.vy+=t.spring.vy(this.y,this.originY,t),this.vx*=t.friction.vx(this.x,this.originX,t),this.vy*=t.friction.vy(this.x,this.originX,t),this.x+=this.vx,this.y+=this.vy}render(e){e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI),e.fillStyle=this.c,e.fill(),e.closePath()}},F,Te,ve,Oe;const ii={settings:{name:"arrow"},init(i){Te=new si(150,150),F=new z(i),ve=new P(100,100,20,"#eebe0a"),Oe=new d},render(i){ve.set(F.x,F.y),ve.render(i),Te.ratateTo(F),Te.draw(i)},destroy(){Oe.destroy(),F.destroy()}};let si=class{constructor(e=0,t=0,s="#ffff00"){n(this,"x");n(this,"y");n(this,"color","");n(this,"rotation",0);this.x=e,this.y=t,this.color=s,this.rotation=0}ratateTo({x:e,y:t}){let s=e-this.x,o=t-this.y;this.rotation=Math.atan2(o,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}},K={x:0,y:0},S={x:0,y:0},J;const oi={settings:{name:"distance"},init(i,e){J=new z(i),K.x=Math.random()*e.width,K.y=Math.random()*e.height,S.x=Math.random()*e.width,S.y=Math.random()*e.height},render(i){i.fillStyle="#000000",i.fillRect(K.x-2,K.y-2,4,4),i.fillStyle="#ff0000",i.fillRect(S.x-2,S.y-2,4,4),i.font="30px Arial",i.fillText(`points distance: ${Ge(K,S)}`,10,100),i.fillText(`mouse distance: ${Ge(J,S)}`,10,130),i.beginPath(),i.moveTo(S.x,S.y),i.lineTo(J.x,J.y),i.closePath(),i.stroke()},destroy(){J.destroy()}};function Ge(i,e){let t=i.x-e.x,s=i.y-e.y;return Math.sqrt(t*t+s*s).toFixed(2)}class b{constructor(e=100,t=100,s=20,o="#ff0000"){n(this,"x",200);n(this,"y",100);n(this,"scaleX",1);n(this,"scaleY",1);n(this,"lineWidth",1);n(this,"color","");n(this,"radius",10);n(this,"rotation",0);this.x=e,this.y=t,this.color=o,this.radius=s}ratateTo({x:e,y:t}){let s=e-this.x,o=t-this.y;this.rotation=Math.atan2(o,s)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY),e.lineWidth=this.lineWidth,e.fillStyle=this.color,e.beginPath(),e.arc(0,0,this.radius,0,Math.PI*2,!0),e.closePath(),e.fill(),this.lineWidth>0&&e.stroke(),e.restore()}}let E,C={angle:0,centrY:200,range:50,xspeed:3,yspeed:.05},de,I={angle:0,centryScale:1,range:.5,speed:.1},ue,g={angleX:0,angleY:0,range:150,centerX:0,centerY:0,xspeed:.07,yspeed:.11};const ni={settings:{name:"liner"},init(i,e){E=new b(0,0),de=new b(e.width/2,e.height/2,30,"#00ff00"),ue=new b(e.width/2,e.height/2,30,"#0000ff"),g.centerX=e.width/2,g.centerY=e.height/2},render(i,e){return C.angle+=C.yspeed,E.x+=C.xspeed,E.y=C.centrY/2+Math.sin(C.angle)*C.range,E.x>e.width+E.radius&&(E.x=-E.radius,C.range+=1),de.scaleX=I.centryScale+Math.sin(I.angle)*I.range,de.scaleY=I.centryScale+Math.sin(I.angle)*I.range,I.angle+=I.speed,ue.x=g.centerX+Math.sin(g.angleX)*g.range,ue.y=g.centerY+Math.sin(g.angleY)*g.range,g.angleX+=g.xspeed,g.angleY+=g.yspeed,g.range+=.01,de.render(i),E.render(i),ue.render(i),()=>{}},destroy(){}};let L,N,V=0,ze=0,Ue=0,Fe=100,ri=.02;const ai={settings:{name:"circle"},init(i,e){L=new b(200,200,40,"#11bbff"),N=new b(200,200,20,"#00ffff"),ze=e.width/2,Ue=e.height/2},render(i){V+=ri,L.x=ze+Math.sin(V)*Fe,L.y=Ue+Math.cos(V)*Fe,N.x=L.x+Math.sin(V*2)*100,N.y=L.y+Math.cos(V*2)*40,L.y-N.y>0?(N.render(i),L.render(i)):(L.render(i),N.render(i))},destroy(){}};let be,ke,fe,ye,Me,c=40,$=0;const li={settings:{name:"waves"},init(i,e){be=new b(e.width/2,e.height/2,c,"#ffee00"),ke=new b(e.width/2,e.height/2,c,"#00ff00"),fe=new b(e.width/2,e.height/2,c,"#0000ff"),ye=new b(e.width/2,e.height/2,c,"#f0f0f0"),Me=new b(e.width/2,e.height/2,c)},render(i,e){$+=.03;let t=e.width/2,s=e.height/2;be.x=t+Math.sin($*.2)*(t-c),ke.y=s+Math.sin($*.3)*(s-c),fe.y=s+Math.sin($*.4)*(s-c),fe.x=t+Math.sin($)*(t-c),ye.y=s+Math.sin($*.5)*(s-c),ye.x=t+Math.cos($*.2)*(t-c),Me.x=t+Math.sin($*2)*(t-c),be.render(i),ke.render(i),fe.render(i),ye.render(i),Me.render(i)},destroy(){}},hi=[oi,ai,ni,li,ii],di={name:"chapter 3",expamples:hi};let Q,_e,Z,ui={friction:pi(),spring:mi()};const fi={settings:{name:"balls_2"},init:(i,e)=>{Q=new z(i),_e=yi(5e3,e),Z=new P(100,100,20,"#eebe0a")},render:(i,e)=>{Z.set(Q.x,Q.y),Z.render(i),_e.forEach(t=>{t.think(Z,{...e,...ui}),t.render(i)})},destroy(){Q.destroy(),Q=void 0,_e=void 0,Z=void 0}};function yi(i,e){let t=[],s=e.width/10,o=e.height/10;for(let r=0;r<i;r++){let a=s+Math.random()*(e.width-s*2),l=o+Math.random()*(e.height-o*2);t.push(new P(a,l,a>e.width/2?2:3,a>e.width/2?"#00bcd4":"#bdb76b"))}return t}function mi(){let i=0,e=0;return{vx(t,s,o){let r=s>o.width/2?i:e;return-(t-s)*r},vy(t,s,o){let r=s>o.width/2?i:e;return-(t-s)*r}}}function pi(){let i=.99,e=.4;return{vx(t,s,o){return s>o.width/2?i:e},vy(t,s,o){return s>o.width/2?i:e}}}let x,Pe,ee,gi={friction:vi(.5),spring:Ti(.01)};const wi={settings:{name:"balls"},init:(i,e)=>{x=new z(i),Pe=ci(5e3,e),ee=new P(100,100,20,"#eebe0a")},render:i=>{ee.set(x.x,x.y),ee.render(i),Pe.forEach(e=>{e.think(ee,gi),e.render(i)})},destroy(){x.destroy(),x=void 0,Pe=void 0,ee=void 0}};function ci(i,e){let t=[],s=e.width/10,o=e.height/10;for(let r=0;r<i;r++){let a=s+Math.random()*(e.width-s*2),l=o+Math.random()*(e.height-o*2);t.push(new P(a,l,2,"#ff0000"))}return t}function Ti(i){return{vx(e,t){return-(e-t)*i},vy(e,t){return-(e-t)*i}}}function vi(i){return{vx(){return i},vy(){return i}}}let te,Se,ie,bi={friction:Bi(.8),spring:Di(.007)};const ki={settings:{name:"p_dor"},init:i=>{te=new z(i),Se=Pi().map(e=>(e.set(100+Math.random()*500,100+Math.random()*400),e)),ie=new P(100,100,20,"#eebe0a")},render:i=>{ie.set(te.x,te.y),ie.render(i),Se.forEach(e=>{e.think(ie,bi),e.render(i)})},destroy(){te.destroy(),te=void 0,Se=void 0,ie=void 0}},Mi="#ff0000",_i=2,y=(i,e,t=Mi)=>new P(i,e,_i,t),u=20;function Pi(){return[...Si(),...Ei(),...Ii(),...Li(),...$i(),...Wi(),...Ai()]}function Si(){return[...w(200,250,u,i=>y(i,100)),...w(100,150,u,i=>y(225,i))]}function Ei(){return[...w(100,150,u,i=>y(270,i)),...le(270,135,u),...w(100,150,u,i=>y(310,i))]}function Ii(){return[...w(170,220,u,i=>y(150,i)),...w(150,170,u,i=>y(i,170)),...w(170,220,u,i=>y(170,i))]}function Li(){return[...w(170,220,u,i=>y(190,i)),...Ci(190,220,u),...w(170,220,u,i=>y(230,i))]}function $i(){return[...w(170,220,u,i=>y(260,i)),...le(260,195,u,25)]}function Wi(){return[...le(325,185,u,15,1),...w(180,210,u,i=>y(310,i)),...w(180,210,u,i=>y(340,i)),...le(325,205,u,15,2)]}function Ai(){return[...w(170,220,u,i=>y(370,i)),...le(370,185,u,15,1.5)]}function le(i,e,t,s=15,o=1.5){let r=[];for(var a=0;a<=t;a++)r.push(y(i+s*Math.cos(Math.PI*a/t+Math.PI*o),e+s*Math.sin(Math.PI*a/t+Math.PI*o)));return r}function Ci(i,e,t){let s=[];for(var o=0;o<t;o++)s.push(y(i+2*o,e-2.5*o));return s}function w(i,e,t,s){let o=e-i,r=Math.trunc(o/(t-1)),a=[];for(let l=i;l<=e;l+=r)a.push(s(l));return a}function Di(i){return{vx(e,t){return-(e-t)*i},vy(e,t){return-(e-t)*i}}}function Bi(i){return{vx(){return i},vy(){return i}}}let Ee,se,q,ji={friction:Xi(.99),spring:Hi(0)};const Ri={settings:{name:"balls_touch"},init:(i,e)=>{q=new At(i),Ee=Yi(2e3,e),se=new P(e.width/2,e.height/2,30,"#eebe0a")},render:i=>{q.pressed&&se.set(q.x,q.y),se.render(i),Ee.forEach(e=>{e.think(se,ji),e.render(i)})},destroy(){q.destroy(),q=void 0,Ee=void 0,se=void 0}};function Yi(i,e){let t=[],s=e.width/20,o=e.height/20;for(let r=0;r<i;r++){let a=s+Math.random()*(e.width-s*2),l=o+Math.random()*(e.height-o*2);t.push(new P(a,l,2,"#00bcd4"))}return t}function Hi(i){return{vx(e,t){return-(e-t)*i},vy(e,t){return-(e-t)*i}}}function Xi(i){return{vx(){return i},vy(){return i}}}const Ni=[wi,fi,ki,Ri],qi={name:"chapter_2",expamples:Ni};let Ke;const Oi={settings:{name:"curves",injectors:[Y]},init(i,e){Ke=new Gi(e.injectors.mouse,e)},render(i){Ke.draw(i)},destroy(){}};let Gi=class{constructor(e,t){n(this,"points",[]);n(this,"point",{x0:0,y0:0,x1:0,y1:0});n(this,"mouse");this.mouse=e,this.points=ge(20,()=>({x:Math.random()*t.width,y:Math.random()*t.height})),this.point={x0:Math.random()*t.width,y0:Math.random()*t.height,x1:Math.random()*t.width,y1:Math.random()*t.height}}draw(e){e.beginPath(),e.strokeStyle="#00ff00",e.lineWidth=10,e.lineCap="butt",e.lineJoin="round",e.miterLimit=20,e.moveTo(this.point.x0,this.point.y0),e.quadraticCurveTo(this.mouse.x,this.mouse.y,this.point.x1,this.point.y1),e.stroke(),e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10,e.moveTo(this.points[0].x,this.points[0].y);for(let t=1;t<this.points.length-1;t+=2)e.quadraticCurveTo(this.points[t].x,this.points[t].y,this.points[t+1].x,this.points[t+1].y);e.stroke()}},Je={x:100,y:100},Ve={x:200,y:200},Ie={x:350,y:150,r:0},Le={x:350,y:150,r:50};const zi={settings:{name:"gradient"},init(){},render(i){let e=i.createLinearGradient(Je.x,Je.y,Ve.x,Ve.y);e.addColorStop(0,"#ffffff"),e.addColorStop(.5,"#0000ff"),e.addColorStop(1,"#ff0000"),i.fillStyle=e,i.fillRect(100,100,200,200);let t=i.createRadialGradient(Ie.x,Ie.y,Ie.r,Le.x,Le.y,Le.r);t.addColorStop(0,"#000000"),t.addColorStop(1,"rgba(0, 0, 0, 0)"),i.fillStyle=t,i.fillRect(300,100,100,100)},destroy(){}};let oe={status:"new",data:new Image},Qe,Ze;const Ui={settings:{name:"image"},init(){oe.data.src="./vovka.png",oe.data.onload=()=>{oe.status="ready"},Qe=document.getElementById("picture"),Ze=document.getElementById("video")},render(i){oe.status==="ready"&&i.drawImage(oe.data,80,0,135,135,90,90,65,65),i.drawImage(Qe,230,20,80,140,200,130,100,120),i.drawImage(Ze,300,150,100,100)},destroy(){}};let xe;const Fi={settings:{name:"line",injectors:[Y]},init(i,e){xe=new Ji(e.injectors.mouse)},render(i){return xe.draw(i),Ki},destroy(){}};function Ki(){}let Ji=class{constructor(e){n(this,"mouse");n(this,"prevPos");this.mouse=e}draw(e){k(this.prevPos)&&this.mouse.leftButtonDown?(e.strokeStyle="#ff0000",e.lineWidth=2,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.beginPath(),e.moveTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos()):!k(this.prevPos)&&this.mouse.leftButtonDown?(e.lineTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos(),e.stroke()):!k(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},et;const Vi={settings:{name:"multi_curves",injectors:[Y]},init(i,e){et=new Qi(e.injectors.mouse,e)},render(i){et.draw(i)},destroy(){}};let Qi=class{constructor(e,t){n(this,"count",10);n(this,"mouse");n(this,"points",[]);n(this,"ctrlPoint",{});this.mouse=e,this.points=ge(this.count,()=>({x:Math.random()*t.width,y:Math.random()*t.height}))}draw(e){e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10;let t=(this.points[0].x+this.points[this.count-1].x)/2,s=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(t,s);let o;for(o=1;o<this.points.length-2;o++){let r=(this.points[o].x+this.points[o+1].x)/2,a=(this.points[o].y+this.points[o+1].y)/2;e.quadraticCurveTo(this.points[o].x,this.points[o].y,r,a)}e.quadraticCurveTo(this.points[o].x,this.points[o].y,t,s),e.stroke(),e.beginPath(),e.strokeStyle="#0000ff",e.lineWidth=3,e.arc(100,200,40,0,Math.PI*2,!0),e.closePath(),e.stroke(),e.beginPath(),e.strokeStyle="#00ff44",e.lineWidth=5,e.moveTo(200,200),e.arcTo(200,50,150,200,20),e.stroke()}};class Zi{static colorToRGB(e,t=1){let s;typeof e=="string"&&e[0]==="#"&&(s=parseInt(e.slice(1),16));var o=s>>16&255,r=s>>8&255,a=s&255,l=t<0?0:t>1?1:t;return l===1?`rgb(${o},${r},${a})`:`rgb(${o},${r},${a},${l})`}static parse(e,t=!1){return t===!0?typeof e=="number"?e|0:(typeof e=="string"&&e[0]==="#"&&(e=e.slice(1)),parseInt(e,16)):(typeof e=="number"&&(e="#"+("00000"+(e|0).toString(16)).substr(-6)),e)}}let tt,it;const xi={settings:{name:"pixel",injectors:[Y]},init(i,e,t){it=t.getImageData(0,0,e.width,e.height),tt=new ts(e.injectors.mouse)},render(i){return tt.draw(i,it),es},destroy(){}};function es(){}let ts=class{constructor(e){n(this,"mouse");n(this,"prevPos");n(this,"brush_size",25);n(this,"brush_density",50);n(this,"brush_color",0);this.mouse=e}draw(e,t){let s=t.data;if(k(this.prevPos)&&this.mouse.leftButtonDown)this.brush_color=Zi.parse(Math.random()*16777215,!0),this.prevPos=this.mouse.copyPos();else if(!k(this.prevPos)&&this.mouse.leftButtonDown){for(let o=0;o<this.brush_density;o++){let r=Math.random()*Math.PI*2,a=Math.random()*this.brush_size,l=this.mouse.x+Math.cos(r)*a|0,f=this.mouse.y+Math.sin(r)*a|0,m=(l+f*t.width)*4;s[m]=this.brush_color>>16&255,s[m+1]=this.brush_color>>8&255,s[m+2]=this.brush_color&255,s[m+3]=255}e.putImageData(t,0,0),this.prevPos=this.mouse.copyPos()}else!k(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},st;const is={settings:{name:"shapes",injectors:[Y]},init(i,e){st=new ss(e.injectors.mouse,e)},render(i){st.draw(i)},destroy(){}};class ss{constructor(e,t){n(this,"count",10);n(this,"mouse");n(this,"points",[]);n(this,"ctrlPoint",{});this.mouse=e,this.points=ge(this.count,()=>({x:Math.random()*t.width,y:Math.random()*t.height}))}draw(e){e.beginPath(),e.fillStyle="#ff0000";let t=(this.points[0].x+this.points[this.count-1].x)/2,s=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(t,s);let o;for(o=1;o<this.points.length-2;o++){let r=(this.points[o].x+this.points[o+1].x)/2,a=(this.points[o].y+this.points[o+1].y)/2;e.quadraticCurveTo(this.points[o].x,this.points[o].y,r,a)}e.quadraticCurveTo(this.points[o].x,this.points[o].y,t,s),e.fill(),e.beginPath(),e.fillStyle="#00ff44",e.moveTo(100,100),e.arcTo(200,50,150,200,20),e.fill()}}const os={name:"chapter 4",expamples:[xi,Ui,zi,is,Vi,Oi,Fi]};let ne,W,_=0;const ns={settings:{name:"acceleration",injectors:[Y,we]},init(i,e){W=new rs(e.width/2,e.height/2),_=0,ne=e.injectors.keyboard},render(i){ne.pressed(G.ArrowLeft)&&(W.rotation-=2*Math.PI/180),ne.pressed(G.ArrowRight)&&(W.rotation+=2*Math.PI/180),ne.pressed(G.ArrowUp)&&_<4&&(_+=.2),ne.pressed(G.ArrowDown)&&(_-=.2),_<0?_=0:_-=.05;let e=Math.cos(W.rotation)*_,t=Math.sin(W.rotation)*_;W.x+=e,W.y+=t,W.draw(i)},destroy(){}};let rs=class{constructor(e=0,t=0,s="#ffff00"){n(this,"x");n(this,"y");n(this,"color","");n(this,"rotation",0);this.x=e,this.y=t,this.color=s,this.rotation=0}ratateTo({x:e,y:t}){let s=e-this.x,o=t-this.y;this.rotation=Math.atan2(o,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}};class as{constructor(e=0,t=0,s="#ffff00"){n(this,"x");n(this,"y");n(this,"color","");n(this,"rotation",0);this.x=e,this.y=t,this.color=s,this.rotation=0}ratateTo({x:e,y:t}){let s=e-this.x,o=t-this.y;this.rotation=Math.atan2(o,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}}let $e,D,We=.05,ot=0,nt=0;const ls={settings:{name:"mouse_1",injectors:[Y,we]},init(i,e){D=new as(e.width/2,e.height/2),We=.05,$e=e.injectors.mouse},render(i){let e=$e.x-D.x,t=$e.y-D.y,s=Math.atan2(t,e),o=Math.cos(s)*We,r=Math.sin(s)*We;D.rotation=s,ot+=o,nt+=r,D.x+=ot,D.y+=nt,D.draw(i)},destroy(){}},hs={name:"chapter 5",expamples:[ls,ns]},ds=50,re=10;let O,ae=[];const us={settings:{name:"removal"},init(i,e){O=rt(e),ae=at(O)},render(i){ae=fs(ae,O),ae.forEach(e=>{e.think(),e.render(i)}),O.render(i)},destroy(){},resize(i,e){O=rt(e),ae=at(O)}};function fs(i,e){return i.filter(t=>!(t.x-t.radius>e.right||t.x+t.radius<e.x||t.y-t.radius>e.bottom||t.y+t.radius<e.y))}function rt(i){return new R(100,100,i.width-200,i.height-200,"#00ff00")}function at(i){return ge(ds,()=>new dt(re+i.x+Math.random()*(i.right-2*re),re+i.y+Math.random()*(i.bottom-2*re),re,"#ff6600",new $t(Math.random()*2-1,Math.random()*2-1)))}const ys={name:"chapter 6",expamples:[us]};Et([ti,ys,hs,os,di,qi]);
