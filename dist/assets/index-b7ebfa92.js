var yt=Object.defineProperty;var pt=(t,e,i)=>e in t?yt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var o=(t,e,i)=>(pt(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}})();function at(t,e){return e.expamples.find(({settings:i})=>i.name===t)}function lt(t,e){let i=new URL(window.location.href);i.searchParams.set(t,e),window.history.pushState("Animations",t,i)}function gt(){let t=new URLSearchParams(window.location.search);return{chapter:t.get("chapter")||"",example:t.get("example")||""}}function wt(t,e){let i=e[t];return i??Object.values(e)[0]}function ct(t,e){let i=at(t,e);return i??e.expamples[0]}const vt=()=>{let t={chapters:document.getElementById("chapters_menu"),examples:document.getElementById("examples_menu"),canvas:document.getElementById("canvas"),body:document.body};return{...t,onResize:Tt(),updateExamplesMenu:bt(t.examples),updateChaptersMenu:_t(t.chapters)}};function Tt(){return t=>{window.addEventListener("resize",()=>{t()})}}function bt(t){return(e,i,s)=>{Mt(t);let n;e.expamples.forEach(r=>{let a=document.createElement("div");a.classList.add("menu__item"),a.innerText=r.settings.name,i===r&&(n=a,n.classList.add("menu__item_selected")),a.addEventListener("click",()=>{n!==a&&(n&&n.classList.remove("menu__item_selected"),n=a,n.classList.add("menu__item_selected"),lt("example",r.settings.name),s(r.settings.name))}),t.appendChild(a)})}}function _t(t){return(e,i,s)=>{let n;Object.keys(e).forEach(r=>{let a=e[r],l=document.createElement("div");l.classList.add("menu__item"),l.innerText=a.name,i===a&&(n=l,n.classList.add("menu__item_selected")),l.addEventListener("click",()=>{n!==l&&(n&&n.classList.remove("menu__item_selected"),n=l,n.classList.add("menu__item_selected"),lt("chapter",r),s(r))}),t.appendChild(l)}),s(i.name)}}function Mt(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function _(t){return t==null||t==null}function kt(t){return Object.values(t)}function pe(t,e){let i=[];for(let s=0;s<t;s++)i.push(e(s,t));return i}function ye(t,e){return Math.random()>.5?t:e}function Pt(t){const e=t.reduce((w,z)=>({...w,[z.name]:z}),{}),i=vt(),s=gt(),n=i.canvas.getContext("2d");let r=wt(s.chapter,e),a,l,c,v={width:i.body.offsetWidth,height:i.body.offsetHeight,injectors:{}},m=v;i.updateChaptersMenu(e,r,dt),i.onResize(()=>{m={...m,width:a.settings.width||i.body.offsetWidth,height:a.settings.height||i.body.offsetHeight},i.canvas.width=m.width,i.canvas.height=m.height,a.resize&&a.resize(n,m)});function dt(w){De(),r=e[w],a=ct(s.example,r),i.updateExamplesMenu(r,a,ut),Ae()}function ut(w){De(),a=at(w,r),Ae()}function Ae(){var z;if(a.inited)return;let w=((z=a.settings.injectors)==null?void 0:z.reduce((mt,Be)=>({...mt,[Be.name]:St(Be,{canvas:i.canvas})}),{}))||{};m={width:a.settings.width||i.body.offsetWidth,height:a.settings.height||i.body.offsetHeight,injectors:w},i.canvas.width=m.width,i.canvas.height=m.height,a.init(i.canvas,m,n),a.inited=!0,Ce(0)}function Ce(w){_(c)?ft():c(),c=a.render(n,m,w)||null,l=requestAnimationFrame(Ce)}function De(){l&&cancelAnimationFrame(l),a&&a.inited&&(_(m.injectors)||kt(m.injectors).map(w=>w.destroy()),a.destroy(i.canvas),a.inited=!1),m=v}function ft(){n.clearRect(0,0,i.canvas.width,i.canvas.height)}}function St(t,e){let i=t.deps.map(({name:s})=>{let n=e[s];if(_(n))throw new Error(`${t.name} has unknow dep ${s}`);return n});return new t.instance(...i)}class Et{constructor(e=0,i=0){o(this,"dx");o(this,"dy");this.dx=e,this.dy=i}think(e){e.x+=this.dx,e.y+=this.dy}}class It{constructor(e=.3,i=.3){o(this,"vy");o(this,"vx");this.vx=e,this.vy=i}think(e){e.x+=this.vx,e.y+=this.vy}}class Le{think(){}}class je{render(e,{x:i,y:s,radius:n,color:r}){e.save(),e.beginPath(),e.arc(i,s,n,0,2*Math.PI),e.fillStyle=r,e.fill(),e.closePath(),e.restore()}}class $t{render(e,{x:i,y:s,width:n,height:r,color:a}){e.save(),e.strokeStyle=a,e.beginPath(),e.rect(i,s,n,r),e.closePath(),e.stroke(),e.restore()}}let ht=class{constructor(e=0,i=0,s=10,n="#ff6600",r=new Le,a=new je){o(this,"x");o(this,"y");o(this,"color");o(this,"radius");o(this,"behavior");o(this,"view");this.x=e,this.y=i,this.color=n,this.radius=s,this.view=a,this.behavior=r}static create({x:e=0,y:i=0,radius:s=10,color:n="#ff6600",view:r=new je,behavior:a=new Le}){return new ht(e,i,s,n,a,r)}think(){this.behavior.think(this)}render(e){this.view.render(e,this)}};class j{constructor(e=100,i=100,s=200,n=200,r="#ff0000",a=new Le,l=new $t){o(this,"width");o(this,"height");o(this,"y");o(this,"x");o(this,"right");o(this,"bottom");o(this,"color");o(this,"behavior");o(this,"view");this.x=e,this.y=i,this.color=r,this.width=s,this.height=n,this.right=e+s,this.bottom=i+n,this.view=l,this.behavior=a}static create({x:e,y:i,width:s,height:n,color:r,view:a,behavior:l}){return new j(e,i,s,n,r,l,a)}think(){this.behavior.think(this)}render(e){this.view.render(e,this)}}const T=class{constructor(e,i,s){o(this,"top");o(this,"bottom");o(this,"x");o(this,"y");o(this,"behavior");this.x=e,this.y=i,this.behavior=new Et(T.SPEED),this.top=j.create({x:e,y:i,width:T.WIDTH,height:T.MIN_HEIGHT+Math.random()*(s-(T.GAP+T.MIN_HEIGHT))}),this.bottom=j.create({x:this.top.x,y:this.top.bottom+T.GAP,width:T.WIDTH,height:s-this.top.height-T.GAP})}think(){this.behavior.think(this),this.top.x=this.x,this.bottom.x=this.x}render(e){this.top.render(e),this.bottom.render(e)}};let u=T;o(u,"GAP",200),o(u,"WIDTH",50),o(u,"MIN_HEIGHT",10),o(u,"DISTANCE_BEETWEN",220),o(u,"SPEED",-4);let X={bird:null,screen:null,pipes:[]};const Lt={settings:{name:"Flappy_Bird"},init(t,e){let i=Dt(e),s=Ct(),n=Wt(i);X={bird:s,screen:i,pipes:n}},render(t){X.screen.render(t),X.bird.render(t),X.pipes.forEach(e=>{e.think(),e.render(t)}),At(X)},destroy(){X=null}};function Wt(t){let e=[],i=t.width/2,s=t.y,n=t.height,r=t.width/(u.WIDTH+u.DISTANCE_BEETWEN)+1;for(let a=0;a<r;a++)e.push(new u(i,s,n)),i+=u.WIDTH+u.DISTANCE_BEETWEN;return e}function At(t){let e=t.pipes[0],i=t.pipes[t.pipes.length-1],s=t.screen.x-u.WIDTH;if(e.x<s){t.pipes.shift();let n=t.screen.y,r=t.screen.height;t.pipes.push(new u(i.x+u.WIDTH+u.DISTANCE_BEETWEN,n,r))}}function Ct(){return j.create({x:150,y:350,width:50,height:50,color:"#00ff00"})}function Dt(t){let e=t.width*5/100,i=t.height*10/100;return new j(e,i,t.width-2*e,t.height-2*i,"#0000ff")}class Bt{constructor(e){o(this,"x",0);o(this,"y",0);o(this,"pressed",!1);o(this,"rect");o(this,"canvas");o(this,"touch_start",()=>{this.pressed=!0});o(this,"touch_end",()=>{this.pressed=!1,this.x=0,this.y=0});o(this,"touch_move",e=>{let i=0,s=0,n=e.touches[0];n.pageX||n.pageY?(i=n.pageX,s=n.pageY):(i=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=n.clientY+document.body.scrollTop+document.documentElement.scrollTop),i-=this.canvas.offsetLeft,s-=this.canvas.offsetTop,this.x=i,this.y=s});this.canvas=e,e.addEventListener("touchstart",this.touch_start,!1),e.addEventListener("touchmove",this.touch_move,!1),e.addEventListener("touchend",this.touch_end,!1)}destroy(){this.canvas.removeEventListener("touchstart",this.touch_start,!1),this.canvas.removeEventListener("touchmove",this.touch_move,!1),this.canvas.removeEventListener("touchend",this.touch_end,!1)}}class G{constructor(e){o(this,"x",0);o(this,"y",0);o(this,"leftButtonDown",!1);o(this,"rect");o(this,"canvas");o(this,"mousedown",e=>{this.leftButtonDown=!0});o(this,"mouseup",e=>{this.leftButtonDown=!1});o(this,"move",e=>{let i=0,s=0;e.pageX||e.pageY?(i=e.pageX,s=e.pageY):(i=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),i-=this.canvas.offsetLeft,s-=this.canvas.offsetTop,this.x=i,this.y=s});this.canvas=e,e.addEventListener("mousemove",this.move,!1),e.addEventListener("mousedown",this.mousedown,!1),e.addEventListener("mouseup",this.mouseup,!1)}destroy(){this.canvas.removeEventListener("mousemove",this.move,!1),this.canvas.removeEventListener("mousedown",this.mousedown,!1),this.canvas.removeEventListener("mouseup",this.mouseup,!1)}copyPos(){return{x:this.x,y:this.y}}}const R={name:"mouse",instance:G,deps:[{name:"canvas"}]};var O=(t=>(t.KeyO="KeyO",t.KeyP="KeyP",t.KeyL="KeyL",t.Space="Space",t.ArrowUp="ArrowUp",t.Semicolon="Semicolon",t.ArrowLeft="ArrowLeft",t.ArrowDown="ArrowDown",t.ArrowRight="ArrowRight",t))(O||{});function Re(){return Math.random().toString(16).slice(2)}class h{constructor(){o(this,"keys_pressed",[]);o(this,"up_subscribers",[]);o(this,"down_subscribers",[]);o(this,"keydown",e=>{let i=e.code;this.keys_pressed.push(i),this.down_subscribers.forEach(({keys:s,cb:n})=>{(s.length===0||s.includes(i))&&n(i)})});o(this,"keyup",e=>{this.keys_pressed=this.keys_pressed.filter(s=>s!==e.code);let i=e.code;this.up_subscribers.forEach(({keys:s,cb:n})=>{(s.length===0||s.includes(i))&&n(i)})});window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1)}destroy(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1)}pressed(e){return _(e)?this.keys_pressed.length!=0:this.keys_pressed.includes(e)}down(e){let i=Re();return this.down_subscribers.push({...e,hash:i}),i}up(e){let i=Re();return this.up_subscribers.push({...e,hash:i}),i}}o(h,"keys",O);const We={name:"keyboard",instance:h,deps:[]};class jt{constructor(){o(this,"vr",0);o(this,"vx",0);o(this,"vy",0);o(this,"trust",0);o(this,"gravity",.01);o(this,"rotation",0)}left(){this.vr=-3}rigth(){this.vr=3}up(){this.trust=.05}forward(){this.vr=0}stop(){this.trust=0}calculate(){this.rotation+=this.vr*Math.PI/180;let e=Math.cos(this.rotation)*this.trust,i=Math.sin(this.rotation)*this.trust;return this.vx+=e,this.vy+=i,this.vx+=this.vx>0?-this.gravity:this.gravity,this.vy+=this.vy>0?-this.gravity:this.gravity,{vx:this.vx,vy:this.vy,rotation:this.rotation}}}class Rt{constructor(e,i,s=0,n=0,r,a){o(this,"x");o(this,"y");o(this,"width");o(this,"height");o(this,"rotation");o(this,"moving");o(this,"keyboard");o(this,"acceleration");o(this,"weapon");o(this,"view");this.x=s,this.y=n,this.width=25,this.height=20,this.rotation=0,this.keyboard=e,this.moving=!1,this.acceleration=i,this.weapon=r,this.view=new a(r),this.keyboard.up({keys:[h.keys.ArrowUp,h.keys.ArrowLeft,h.keys.ArrowRight],cb:l=>{if(l===h.keys.ArrowUp){this.moving=!1,this.acceleration.stop();return}this.acceleration.forward()}})}changeChip(e){this.view=new e(this.weapon)}cnahgeWeapon(e){this.view.changeWeapon(e)}shot(e){const i=this.view.shot(this);i&&e.bullets.push(...i)}think(e){this.keyboard.pressed(h.keys.Space)&&this.shot(e),this.keyboard.pressed(h.keys.ArrowLeft)&&this.acceleration.left(),this.keyboard.pressed(h.keys.ArrowRight)&&this.acceleration.rigth(),this.keyboard.pressed(h.keys.ArrowUp)&&(this.acceleration.up(),this.moving=!0);let{vx:i,vy:s,rotation:n}=this.acceleration.calculate();this.rotation=n,this.x+=i,this.y+=s}render(e){this.view.render(e,this)}}class Xt{constructor(e){o(this,"name","classic");o(this,"weapon_name");o(this,"weapon");this.weapon_name=e.name,this.weapon=new e}changeWeapon(e){this.weapon_name=e.name,this.weapon=new e}shot(e){const i=this.weapon.shot({x:e.x,y:e.y,rotation:e.rotation});if(i)return[i]}render(e,i){if(e.save(),e.translate(i.x,i.y),e.rotate(i.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(10,0),e.lineTo(-10,10),e.lineTo(-5,0),e.lineTo(-10,-10),e.lineTo(10,0),e.stroke(),i.moving){let s=Math.random()>.5?17:15;e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-7.5,-5),e.lineTo(-s,0),e.lineTo(-7.5,5),e.stroke()}e.restore()}}class Yt{constructor(e){o(this,"name","эх-100");o(this,"weapon_name");o(this,"weapons");this.weapon_name=e.name,this.weapons=[new e,new e]}changeWeapon(e){this.weapon_name=e.name,this.weapons=[new e,new e]}shot(e){const n=this.weapons[0].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*1.88),y:e.y+15*Math.sin(e.rotation+Math.PI*1.88),rotation:e.rotation}),r=.12,a=this.weapons[1].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*r),y:e.y+15*Math.sin(e.rotation+Math.PI*r),rotation:e.rotation});let l=[];return n&&l.push(n),a&&l.push(a),l.length>0?l:void 0}render(e,i){e.save(),e.translate(i.x,i.y),e.rotate(i.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(15,10),e.lineTo(10,10),e.lineTo(10,5),e.lineTo(-10,5),e.lineTo(-10,10),e.lineTo(-15,10),e.lineTo(-15,-10),e.lineTo(-10,-10),e.lineTo(-10,-5),e.lineTo(-10,-5),e.lineTo(10,-5),e.lineTo(10,-10),e.lineTo(15,-10),e.stroke(),e.beginPath(),e.moveTo(15,10),e.quadraticCurveTo(30,0,15,-10),e.stroke(),i.moving&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-15,-10),e.lineTo(-Xe(25,22),-5),e.lineTo(-15,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-15,10),e.lineTo(-Xe(25,22),5),e.lineTo(-15,0),e.stroke()),e.restore()}}function Xe(t,e){return Math.random()>.5?t:e}class Ht{constructor(e){o(this,"name","еф-100");o(this,"weapon_name");o(this,"weapons");this.weapon_name=e.name,this.weapons=[new e,new e]}changeWeapon(e){this.weapon_name=e.name,this.weapons=[new e,new e]}shot(e){const n=this.weapons[0].shot({x:e.x+17*Math.cos(e.rotation+Math.PI*1.88),y:e.y+17*Math.sin(e.rotation+Math.PI*1.88),rotation:e.rotation}),r=.12,a=this.weapons[1].shot({x:e.x+17*Math.cos(e.rotation+Math.PI*r),y:e.y+17*Math.sin(e.rotation+Math.PI*r),rotation:e.rotation});let l=[];return n&&l.push(n),a&&l.push(a),l.length>0?l:void 0}render(e,i){e.save(),e.translate(i.x,i.y),e.rotate(i.rotation),e.strokeStyle="#ff0000",e.beginPath(),e.arc(0,0,15,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.arc(0,0,5,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(3,15),e.quadraticCurveTo(5,22,10,21),e.stroke(),e.beginPath(),e.moveTo(8,13),e.quadraticCurveTo(10,18,15,17),e.stroke(),e.beginPath(),e.moveTo(15,17),e.lineTo(20,17),e.stroke(),e.beginPath(),e.moveTo(10,21),e.lineTo(20,21),e.stroke(),e.beginPath(),e.moveTo(20,21),e.lineTo(20,17),e.stroke(),e.beginPath(),e.moveTo(20,21),e.lineTo(24,19),e.stroke(),e.beginPath(),e.moveTo(20,17),e.lineTo(24,18),e.stroke(),e.beginPath(),e.moveTo(13,7),e.lineTo(30,3),e.stroke(),e.beginPath(),e.moveTo(15,2),e.lineTo(30,2),e.stroke(),e.beginPath(),e.moveTo(13,-7),e.lineTo(30,-3),e.stroke(),e.beginPath(),e.moveTo(15,-2),e.lineTo(30,-2),e.stroke(),e.beginPath(),e.moveTo(15,0),e.lineTo(5,0),e.stroke(),e.beginPath(),e.moveTo(0,15),e.lineTo(0,5),e.stroke(),e.beginPath(),e.moveTo(0,-15),e.lineTo(0,-5),e.stroke(),e.beginPath(),e.moveTo(-15,0),e.lineTo(-5,0),e.stroke(),e.beginPath(),e.moveTo(4,4),e.lineTo(11,11),e.stroke(),e.beginPath(),e.moveTo(4,-4),e.lineTo(11,-11),e.stroke(),e.beginPath(),e.moveTo(-4,-4),e.lineTo(-11,-11),e.stroke(),e.beginPath(),e.moveTo(-4,4),e.lineTo(-11,11),e.stroke(),i.moving&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-10,-12),e.lineTo(-le(21,19),-11),e.lineTo(-14,-7),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-12,-7),e.lineTo(-le(22,20),-4),e.lineTo(-14,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-12,7),e.lineTo(-le(22,20),4),e.lineTo(-14,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-14,7),e.lineTo(-le(21,19),11),e.lineTo(-10,12),e.stroke()),e.restore()}}function le(t,e){return Math.random()>.5?t:e}class Nt{constructor(e){o(this,"name","т-50");o(this,"weapon_name");o(this,"weapons");this.weapon_name=e.name,this.weapons=[new e,new e]}changeWeapon(e){this.weapon_name=e.name,this.weapons=[new e,new e]}shot(e){const s=[],r=this.weapons[0].shot({x:e.x+10*Math.cos(e.rotation+Math.PI*1.5),y:e.y+10*Math.sin(e.rotation+Math.PI*1.5),rotation:e.rotation});r&&s.push(r);const a=.5,l=this.weapons[1].shot({x:e.x+10*Math.cos(e.rotation+Math.PI*a),y:e.y+10*Math.sin(e.rotation+Math.PI*a),rotation:e.rotation});return l&&s.push(l),s.length>0?s:void 0}render(e,i){e.save(),e.translate(i.x,i.y),e.rotate(i.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(20,0),e.lineTo(15,-5),e.lineTo(-15,-5),e.lineTo(-20,-10),e.lineTo(-20,10),e.lineTo(-15,5),e.lineTo(15,5),e.lineTo(20,0),e.stroke(),e.beginPath(),e.moveTo(0,-5),e.lineTo(0,-10),e.lineTo(5,-10),e.lineTo(5,-5),e.stroke(),e.beginPath(),e.moveTo(0,5),e.lineTo(0,10),e.lineTo(5,10),e.lineTo(5,5),e.stroke(),i.moving&&(e.strokeStyle="#ff9200",e.beginPath(),e.moveTo(-20,-10),e.lineTo(-ye(30,27),-6),e.lineTo(-20,-2),e.stroke(),e.beginPath(),e.moveTo(-20,10),e.lineTo(-ye(30,27),6),e.lineTo(-20,2),e.stroke()),e.restore()}}class qt{constructor(e){o(this,"name","еф-50");o(this,"weapon_name");o(this,"weapons");this.weapon_name=e.name,this.weapons=[new e,new e,new e]}changeWeapon(e){this.weapon_name=e.name,this.weapons=[new e,new e,new e]}shot(e){const s=[],r=this.weapons[0].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*1.84),y:e.y+15*Math.sin(e.rotation+Math.PI*1.84),rotation:e.rotation-.03});r&&s.push(r);const a=.16,l=this.weapons[1].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*a),y:e.y+15*Math.sin(e.rotation+Math.PI*a),rotation:e.rotation+.03});l&&s.push(l);const c=0,v=this.weapons[2].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*c),y:e.y+15*Math.sin(e.rotation+Math.PI*c),rotation:e.rotation});return v&&s.push(v),s.length>0?s:void 0}render(e,i){e.save(),e.translate(i.x,i.y),e.rotate(i.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(20,0),e.lineTo(15,-10),e.lineTo(-15,-15),e.lineTo(-10,0),e.lineTo(-15,15),e.lineTo(15,10),e.lineTo(20,0),e.stroke(),e.beginPath(),e.moveTo(15,-10),e.quadraticCurveTo(8,0,15,10),e.stroke(),e.beginPath(),e.moveTo(-12,-2),e.lineTo(-20,-2),e.lineTo(-20,-9),e.lineTo(-14,-9),e.stroke(),e.beginPath(),e.moveTo(-12,2),e.lineTo(-20,2),e.lineTo(-20,9),e.lineTo(-14,9),e.stroke(),e.beginPath(),e.moveTo(7,11),e.lineTo(7,15),e.lineTo(14,15),e.stroke(),e.beginPath(),e.moveTo(7,-11),e.lineTo(7,-15),e.lineTo(14,-15),e.stroke(),i.moving&&(e.strokeStyle="#ff9200",e.beginPath(),e.moveTo(-20,-9),e.lineTo(-ye(30,27),-6),e.lineTo(-20,-2),e.stroke(),e.beginPath(),e.moveTo(-20,9),e.lineTo(-ye(30,27),6),e.lineTo(-20,2),e.stroke()),e.restore()}}class Ot{constructor(){o(this,"name","Рокетница");o(this,"rate");o(this,"prevShotTime");this.rate=1,this.prevShotTime=0}shot(e){let i=new Date().getTime();if(i-this.prevShotTime>1e3/this.rate)return this.prevShotTime=i,new Gt(e.x,e.y,e.rotation)}}class Gt{constructor(e=0,i=0,s=0,n=0,r=.04){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");o(this,"acceleration");o(this,"max_speed");this.x=e+5*Math.cos(s),this.y=i+5*Math.sin(s),this.speed=n,this.rotation=s,this.acceleration=r,this.max_speed=6}think(){this.speed+=this.acceleration,this.speed>=this.max_speed?this.acceleration=0:this.acceleration+=.02,this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(8,1),e.lineTo(-8,1),e.lineTo(-8,-1),e.lineTo(8,-1),e.lineTo(8,1),e.stroke(),Math.random()>.1&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-8,-2),e.lineTo(-12,0),e.lineTo(-8,2),e.stroke()),e.restore()}}class zt{constructor(){o(this,"name","Пулимет");o(this,"rate");o(this,"bulletSpeed");o(this,"prevShotTime");this.rate=10,this.prevShotTime=0,this.bulletSpeed=6}shot(e){let i=new Date().getTime();if(i-this.prevShotTime>1e3/this.rate)return this.prevShotTime=i,new Ut(e.x,e.y,e.rotation,this.bulletSpeed)}}class Ut{constructor(e,i,s,n=3){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");this.x=e,this.y=i,this.speed=n,this.rotation=s}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){let i=5*Math.cos(this.rotation),s=5*Math.sin(this.rotation);e.save(),e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=2,e.moveTo(this.x,this.y),e.lineTo(this.x+i,this.y+s),e.closePath(),e.stroke(),e.restore()}}class Ft{constructor(){o(this,"name","Плазма");o(this,"rate");o(this,"bulletSpeed");o(this,"prevShotTime");this.rate=5,this.prevShotTime=0,this.bulletSpeed=6}shot(e){let i=new Date().getTime();if(i-this.prevShotTime>1e3/this.rate)return this.prevShotTime=i,new Kt(e.x,e.y,e.rotation,this.bulletSpeed)}}class Kt{constructor(e,i,s,n=4){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");this.x=e,this.y=i,this.speed=n,this.rotation=s}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){e.save(),e.beginPath(),e.fillStyle="#00ff00",e.beginPath(),e.arc(this.x,this.y,3,0,2*Math.PI),e.fill(),e.closePath(),e.restore()}}const ge=[qt,Nt,Xt,Yt,Ht],me=[zt,Ot,Ft];let D=0,B=0,Y={enemies:[],bullets:[]},M;const Jt={settings:{name:"Spacesship",injectors:[We]},init(t,e){let i=e.injectors.keyboard,s=new jt,n=ge[B];M=new Rt(i,s,e.width/2,e.height/2,me[D],n),i.down({keys:[h.keys.KeyL,h.keys.Semicolon,h.keys.KeyO,h.keys.KeyP],cb:r=>{r===h.keys.KeyL&&He(M,ge,1),r===h.keys.Semicolon&&He(M,ge,-1),r===h.keys.KeyO&&Ne(M,1),r===h.keys.KeyP&&Ne(M,-1)}})},render(t,e){Qt(t,e),Zt(t,e,M),Y.enemies.forEach(i=>{i.think(Y),i.render(t)}),Y.bullets.forEach(i=>{i.think(Y),i.render(t)}),M.think(Y),M.render(t),Vt(Y,e)},destroy(){M=void 0}};function Vt(t,e){t.bullets=t.bullets.filter(i=>Ye(0,e.width,i.x)&&Ye(0,e.height,i.y))}function Ye(t,e,i){return i>t&&i<e}function He(t,e,i){B+=i,B>=e.length&&(B=0),B<0&&(B=e.length-1),t.changeChip(e[B])}function Ne(t,e){D+=e,D>=me.length&&(D=0),D<0&&(D=me.length-1),t.cnahgeWeapon(me[D])}function Qt(t,e){t.save(),t.fillStyle="#ff0000",t.font="20px Arial",t.fillText("Смена корабля: Д или Ж",10,e.height-10),t.fillText("Смена оружия: Щ или З",10,e.height-30),t.fillText("Летать на стрелки",10,e.height-50),t.restore()}function Zt(t,e,i){t.save(),t.fillStyle="#ff0000",t.font="20px Arial",t.fillText(`корабль: ${i.view.name}`,10,e.height-80),t.fillText(`оружие: ${i.view.weapon_name}`,10,e.height-100),t.restore()}const xt={name:"games",expamples:[Jt,Lt]};let P=class{constructor(e=0,i=0,s=0,n="#ff6600"){o(this,"x");o(this,"y");o(this,"r");o(this,"c");o(this,"vx");o(this,"vy");o(this,"originX");o(this,"originY");this.x=e,this.y=i,this.r=s,this.c=n,this.vx=0,this.vy=0,this.originX=e,this.originY=i}set(e,i){this.x=e,this.y=i}think(e,i){let s=this.x-e.x,n=this.y-e.y;if(Math.sqrt(s*s+n*n)<e.r){let a=Math.atan2(n,s),l=e.x+Math.cos(a)*e.r,c=e.y+Math.sin(a)*e.r;this.vx+=l-this.x,this.vy+=c-this.y}this.vx+=i.spring.vx(this.x,this.originX,i),this.vy+=i.spring.vy(this.y,this.originY,i),this.vx*=i.friction.vx(this.x,this.originX,i),this.vy*=i.friction.vy(this.x,this.originX,i),this.x+=this.vx,this.y+=this.vy}render(e){e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI),e.fillStyle=this.c,e.fill(),e.closePath()}},U,we,ce,qe;const ei={settings:{name:"arrow"},init(t){we=new ti(150,150),U=new G(t),ce=new P(100,100,20,"#eebe0a"),qe=new h},render(t){ce.set(U.x,U.y),ce.render(t),we.ratateTo(U),we.draw(t)},destroy(){qe.destroy(),U.destroy()}};let ti=class{constructor(e=0,i=0,s="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=e,this.y=i,this.color=s,this.rotation=0}ratateTo({x:e,y:i}){let s=e-this.x,n=i-this.y;this.rotation=Math.atan2(n,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}},F={x:0,y:0},S={x:0,y:0},K;const ii={settings:{name:"distance"},init(t,e){K=new G(t),F.x=Math.random()*e.width,F.y=Math.random()*e.height,S.x=Math.random()*e.width,S.y=Math.random()*e.height},render(t){t.fillStyle="#000000",t.fillRect(F.x-2,F.y-2,4,4),t.fillStyle="#ff0000",t.fillRect(S.x-2,S.y-2,4,4),t.font="30px Arial",t.fillText(`points distance: ${Oe(F,S)}`,10,100),t.fillText(`mouse distance: ${Oe(K,S)}`,10,130),t.beginPath(),t.moveTo(S.x,S.y),t.lineTo(K.x,K.y),t.closePath(),t.stroke()},destroy(){K.destroy()}};function Oe(t,e){let i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s).toFixed(2)}class b{constructor(e=100,i=100,s=20,n="#ff0000"){o(this,"x",200);o(this,"y",100);o(this,"scaleX",1);o(this,"scaleY",1);o(this,"lineWidth",1);o(this,"color","");o(this,"radius",10);o(this,"rotation",0);this.x=e,this.y=i,this.color=n,this.radius=s}ratateTo({x:e,y:i}){let s=e-this.x,n=i-this.y;this.rotation=Math.atan2(n,s)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY),e.lineWidth=this.lineWidth,e.fillStyle=this.color,e.beginPath(),e.arc(0,0,this.radius,0,Math.PI*2,!0),e.closePath(),e.fill(),this.lineWidth>0&&e.stroke(),e.restore()}}let E,A={angle:0,centrY:200,range:50,xspeed:3,yspeed:.05},he,I={angle:0,centryScale:1,range:.5,speed:.1},de,y={angleX:0,angleY:0,range:150,centerX:0,centerY:0,xspeed:.07,yspeed:.11};const si={settings:{name:"liner"},init(t,e){E=new b(0,0),he=new b(e.width/2,e.height/2,30,"#00ff00"),de=new b(e.width/2,e.height/2,30,"#0000ff"),y.centerX=e.width/2,y.centerY=e.height/2},render(t,e){return A.angle+=A.yspeed,E.x+=A.xspeed,E.y=A.centrY/2+Math.sin(A.angle)*A.range,E.x>e.width+E.radius&&(E.x=-E.radius,A.range+=1),he.scaleX=I.centryScale+Math.sin(I.angle)*I.range,he.scaleY=I.centryScale+Math.sin(I.angle)*I.range,I.angle+=I.speed,de.x=y.centerX+Math.sin(y.angleX)*y.range,de.y=y.centerY+Math.sin(y.angleY)*y.range,y.angleX+=y.xspeed,y.angleY+=y.yspeed,y.range+=.01,he.render(t),E.render(t),de.render(t),()=>{}},destroy(){}};let $,H,J=0,Ge=0,ze=0,Ue=100,ni=.02;const oi={settings:{name:"circle"},init(t,e){$=new b(200,200,40,"#11bbff"),H=new b(200,200,20,"#00ffff"),Ge=e.width/2,ze=e.height/2},render(t){J+=ni,$.x=Ge+Math.sin(J)*Ue,$.y=ze+Math.cos(J)*Ue,H.x=$.x+Math.sin(J*2)*100,H.y=$.y+Math.cos(J*2)*40,$.y-H.y>0?(H.render(t),$.render(t)):($.render(t),H.render(t))},destroy(){}};let ve,Te,ue,fe,be,g=40,L=0;const ri={settings:{name:"waves"},init(t,e){ve=new b(e.width/2,e.height/2,g,"#ffee00"),Te=new b(e.width/2,e.height/2,g,"#00ff00"),ue=new b(e.width/2,e.height/2,g,"#0000ff"),fe=new b(e.width/2,e.height/2,g,"#f0f0f0"),be=new b(e.width/2,e.height/2,g)},render(t,e){L+=.03;let i=e.width/2,s=e.height/2;ve.x=i+Math.sin(L*.2)*(i-g),Te.y=s+Math.sin(L*.3)*(s-g),ue.y=s+Math.sin(L*.4)*(s-g),ue.x=i+Math.sin(L)*(i-g),fe.y=s+Math.sin(L*.5)*(s-g),fe.x=i+Math.cos(L*.2)*(i-g),be.x=i+Math.sin(L*2)*(i-g),ve.render(t),Te.render(t),ue.render(t),fe.render(t),be.render(t)},destroy(){}},ai=[ii,oi,si,ri,ei],li={name:"chapter 3",expamples:ai};let V,_e,Q,hi={friction:mi(),spring:fi()};const di={settings:{name:"balls_2"},init:(t,e)=>{V=new G(t),_e=ui(5e3,e),Q=new P(100,100,20,"#eebe0a")},render:(t,e)=>{Q.set(V.x,V.y),Q.render(t),_e.forEach(i=>{i.think(Q,{...e,...hi}),i.render(t)})},destroy(){V.destroy(),V=void 0,_e=void 0,Q=void 0}};function ui(t,e){let i=[],s=e.width/10,n=e.height/10;for(let r=0;r<t;r++){let a=s+Math.random()*(e.width-s*2),l=n+Math.random()*(e.height-n*2);i.push(new P(a,l,a>e.width/2?2:3,a>e.width/2?"#00bcd4":"#bdb76b"))}return i}function fi(){let t=0,e=0;return{vx(i,s,n){let r=s>n.width/2?t:e;return-(i-s)*r},vy(i,s,n){let r=s>n.width/2?t:e;return-(i-s)*r}}}function mi(){let t=.99,e=.4;return{vx(i,s,n){return s>n.width/2?t:e},vy(i,s,n){return s>n.width/2?t:e}}}let Z,Me,x,yi={friction:ci(.5),spring:wi(.01)};const pi={settings:{name:"balls"},init:(t,e)=>{Z=new G(t),Me=gi(5e3,e),x=new P(100,100,20,"#eebe0a")},render:t=>{x.set(Z.x,Z.y),x.render(t),Me.forEach(e=>{e.think(x,yi),e.render(t)})},destroy(){Z.destroy(),Z=void 0,Me=void 0,x=void 0}};function gi(t,e){let i=[],s=e.width/10,n=e.height/10;for(let r=0;r<t;r++){let a=s+Math.random()*(e.width-s*2),l=n+Math.random()*(e.height-n*2);i.push(new P(a,l,2,"#ff0000"))}return i}function wi(t){return{vx(e,i){return-(e-i)*t},vy(e,i){return-(e-i)*t}}}function ci(t){return{vx(){return t},vy(){return t}}}let ee,ke,te,vi={friction:Ci(.8),spring:Ai(.007)};const Ti={settings:{name:"p_dor"},init:t=>{ee=new G(t),ke=Mi().map(e=>(e.set(100+Math.random()*500,100+Math.random()*400),e)),te=new P(100,100,20,"#eebe0a")},render:t=>{te.set(ee.x,ee.y),te.render(t),ke.forEach(e=>{e.think(te,vi),e.render(t)})},destroy(){ee.destroy(),ee=void 0,ke=void 0,te=void 0}},bi="#ff0000",_i=2,f=(t,e,i=bi)=>new P(t,e,_i,i),d=20;function Mi(){return[...ki(),...Pi(),...Si(),...Ei(),...Ii(),...$i(),...Li()]}function ki(){return[...p(200,250,d,t=>f(t,100)),...p(100,150,d,t=>f(225,t))]}function Pi(){return[...p(100,150,d,t=>f(270,t)),...ae(270,135,d),...p(100,150,d,t=>f(310,t))]}function Si(){return[...p(170,220,d,t=>f(150,t)),...p(150,170,d,t=>f(t,170)),...p(170,220,d,t=>f(170,t))]}function Ei(){return[...p(170,220,d,t=>f(190,t)),...Wi(190,220,d),...p(170,220,d,t=>f(230,t))]}function Ii(){return[...p(170,220,d,t=>f(260,t)),...ae(260,195,d,25)]}function $i(){return[...ae(325,185,d,15,1),...p(180,210,d,t=>f(310,t)),...p(180,210,d,t=>f(340,t)),...ae(325,205,d,15,2)]}function Li(){return[...p(170,220,d,t=>f(370,t)),...ae(370,185,d,15,1.5)]}function ae(t,e,i,s=15,n=1.5){let r=[];for(var a=0;a<=i;a++)r.push(f(t+s*Math.cos(Math.PI*a/i+Math.PI*n),e+s*Math.sin(Math.PI*a/i+Math.PI*n)));return r}function Wi(t,e,i){let s=[];for(var n=0;n<i;n++)s.push(f(t+2*n,e-2.5*n));return s}function p(t,e,i,s){let n=e-t,r=Math.trunc(n/(i-1)),a=[];for(let l=t;l<=e;l+=r)a.push(s(l));return a}function Ai(t){return{vx(e,i){return-(e-i)*t},vy(e,i){return-(e-i)*t}}}function Ci(t){return{vx(){return t},vy(){return t}}}let Pe,ie,N,Di={friction:Xi(.99),spring:Ri(0)};const Bi={settings:{name:"balls_touch"},init:(t,e)=>{N=new Bt(t),Pe=ji(2e3,e),ie=new P(e.width/2,e.height/2,30,"#eebe0a")},render:t=>{N.pressed&&ie.set(N.x,N.y),ie.render(t),Pe.forEach(e=>{e.think(ie,Di),e.render(t)})},destroy(){N.destroy(),N=void 0,Pe=void 0,ie=void 0}};function ji(t,e){let i=[],s=e.width/20,n=e.height/20;for(let r=0;r<t;r++){let a=s+Math.random()*(e.width-s*2),l=n+Math.random()*(e.height-n*2);i.push(new P(a,l,2,"#00bcd4"))}return i}function Ri(t){return{vx(e,i){return-(e-i)*t},vy(e,i){return-(e-i)*t}}}function Xi(t){return{vx(){return t},vy(){return t}}}const Yi=[pi,di,Ti,Bi],Hi={name:"chapter_2",expamples:Yi};let Fe;const Ni={settings:{name:"curves",injectors:[R]},init(t,e){Fe=new qi(e.injectors.mouse,e)},render(t){Fe.draw(t)},destroy(){}};let qi=class{constructor(e,i){o(this,"points",[]);o(this,"point",{x0:0,y0:0,x1:0,y1:0});o(this,"mouse");this.mouse=e,this.points=pe(20,()=>({x:Math.random()*i.width,y:Math.random()*i.height})),this.point={x0:Math.random()*i.width,y0:Math.random()*i.height,x1:Math.random()*i.width,y1:Math.random()*i.height}}draw(e){e.beginPath(),e.strokeStyle="#00ff00",e.lineWidth=10,e.lineCap="butt",e.lineJoin="round",e.miterLimit=20,e.moveTo(this.point.x0,this.point.y0),e.quadraticCurveTo(this.mouse.x,this.mouse.y,this.point.x1,this.point.y1),e.stroke(),e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10,e.moveTo(this.points[0].x,this.points[0].y);for(let i=1;i<this.points.length-1;i+=2)e.quadraticCurveTo(this.points[i].x,this.points[i].y,this.points[i+1].x,this.points[i+1].y);e.stroke()}},Ke={x:100,y:100},Je={x:200,y:200},Se={x:350,y:150,r:0},Ee={x:350,y:150,r:50};const Oi={settings:{name:"gradient"},init(){},render(t){let e=t.createLinearGradient(Ke.x,Ke.y,Je.x,Je.y);e.addColorStop(0,"#ffffff"),e.addColorStop(.5,"#0000ff"),e.addColorStop(1,"#ff0000"),t.fillStyle=e,t.fillRect(100,100,200,200);let i=t.createRadialGradient(Se.x,Se.y,Se.r,Ee.x,Ee.y,Ee.r);i.addColorStop(0,"#000000"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=i,t.fillRect(300,100,100,100)},destroy(){}};let se={status:"new",data:new Image},Ve,Qe;const Gi={settings:{name:"image"},init(){se.data.src="./vovka.png",se.data.onload=()=>{se.status="ready"},Ve=document.getElementById("picture"),Qe=document.getElementById("video")},render(t){se.status==="ready"&&t.drawImage(se.data,80,0,135,135,90,90,65,65),t.drawImage(Ve,230,20,80,140,200,130,100,120),t.drawImage(Qe,300,150,100,100)},destroy(){}};let Ze;const zi={settings:{name:"line",injectors:[R]},init(t,e){Ze=new Fi(e.injectors.mouse)},render(t){return Ze.draw(t),Ui},destroy(){}};function Ui(){}let Fi=class{constructor(e){o(this,"mouse");o(this,"prevPos");this.mouse=e}draw(e){_(this.prevPos)&&this.mouse.leftButtonDown?(e.strokeStyle="#ff0000",e.lineWidth=2,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.beginPath(),e.moveTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos()):!_(this.prevPos)&&this.mouse.leftButtonDown?(e.lineTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos(),e.stroke()):!_(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},xe;const Ki={settings:{name:"multi_curves",injectors:[R]},init(t,e){xe=new Ji(e.injectors.mouse,e)},render(t){xe.draw(t)},destroy(){}};let Ji=class{constructor(e,i){o(this,"count",10);o(this,"mouse");o(this,"points",[]);o(this,"ctrlPoint",{});this.mouse=e,this.points=pe(this.count,()=>({x:Math.random()*i.width,y:Math.random()*i.height}))}draw(e){e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10;let i=(this.points[0].x+this.points[this.count-1].x)/2,s=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(i,s);let n;for(n=1;n<this.points.length-2;n++){let r=(this.points[n].x+this.points[n+1].x)/2,a=(this.points[n].y+this.points[n+1].y)/2;e.quadraticCurveTo(this.points[n].x,this.points[n].y,r,a)}e.quadraticCurveTo(this.points[n].x,this.points[n].y,i,s),e.stroke(),e.beginPath(),e.strokeStyle="#0000ff",e.lineWidth=3,e.arc(100,200,40,0,Math.PI*2,!0),e.closePath(),e.stroke(),e.beginPath(),e.strokeStyle="#00ff44",e.lineWidth=5,e.moveTo(200,200),e.arcTo(200,50,150,200,20),e.stroke()}};class Vi{static colorToRGB(e,i=1){let s;typeof e=="string"&&e[0]==="#"&&(s=parseInt(e.slice(1),16));var n=s>>16&255,r=s>>8&255,a=s&255,l=i<0?0:i>1?1:i;return l===1?`rgb(${n},${r},${a})`:`rgb(${n},${r},${a},${l})`}static parse(e,i=!1){return i===!0?typeof e=="number"?e|0:(typeof e=="string"&&e[0]==="#"&&(e=e.slice(1)),parseInt(e,16)):(typeof e=="number"&&(e="#"+("00000"+(e|0).toString(16)).substr(-6)),e)}}let et,tt;const Qi={settings:{name:"pixel",injectors:[R]},init(t,e,i){tt=i.getImageData(0,0,e.width,e.height),et=new xi(e.injectors.mouse)},render(t){return et.draw(t,tt),Zi},destroy(){}};function Zi(){}let xi=class{constructor(e){o(this,"mouse");o(this,"prevPos");o(this,"brush_size",25);o(this,"brush_density",50);o(this,"brush_color",0);this.mouse=e}draw(e,i){let s=i.data;if(_(this.prevPos)&&this.mouse.leftButtonDown)this.brush_color=Vi.parse(Math.random()*16777215,!0),this.prevPos=this.mouse.copyPos();else if(!_(this.prevPos)&&this.mouse.leftButtonDown){for(let n=0;n<this.brush_density;n++){let r=Math.random()*Math.PI*2,a=Math.random()*this.brush_size,l=this.mouse.x+Math.cos(r)*a|0,c=this.mouse.y+Math.sin(r)*a|0,v=(l+c*i.width)*4;s[v]=this.brush_color>>16&255,s[v+1]=this.brush_color>>8&255,s[v+2]=this.brush_color&255,s[v+3]=255}e.putImageData(i,0,0),this.prevPos=this.mouse.copyPos()}else!_(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},it;const es={settings:{name:"shapes",injectors:[R]},init(t,e){it=new ts(e.injectors.mouse,e)},render(t){it.draw(t)},destroy(){}};class ts{constructor(e,i){o(this,"count",10);o(this,"mouse");o(this,"points",[]);o(this,"ctrlPoint",{});this.mouse=e,this.points=pe(this.count,()=>({x:Math.random()*i.width,y:Math.random()*i.height}))}draw(e){e.beginPath(),e.fillStyle="#ff0000";let i=(this.points[0].x+this.points[this.count-1].x)/2,s=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(i,s);let n;for(n=1;n<this.points.length-2;n++){let r=(this.points[n].x+this.points[n+1].x)/2,a=(this.points[n].y+this.points[n+1].y)/2;e.quadraticCurveTo(this.points[n].x,this.points[n].y,r,a)}e.quadraticCurveTo(this.points[n].x,this.points[n].y,i,s),e.fill(),e.beginPath(),e.fillStyle="#00ff44",e.moveTo(100,100),e.arcTo(200,50,150,200,20),e.fill()}}const is={name:"chapter 4",expamples:[Qi,Gi,Oi,es,Ki,Ni,zi]};let ne,W,k=0;const ss={settings:{name:"acceleration",injectors:[R,We]},init(t,e){W=new ns(e.width/2,e.height/2),k=0,ne=e.injectors.keyboard},render(t){ne.pressed(O.ArrowLeft)&&(W.rotation-=2*Math.PI/180),ne.pressed(O.ArrowRight)&&(W.rotation+=2*Math.PI/180),ne.pressed(O.ArrowUp)&&k<4&&(k+=.2),ne.pressed(O.ArrowDown)&&(k-=.2),k<0?k=0:k-=.05;let e=Math.cos(W.rotation)*k,i=Math.sin(W.rotation)*k;W.x+=e,W.y+=i,W.draw(t)},destroy(){}};let ns=class{constructor(e=0,i=0,s="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=e,this.y=i,this.color=s,this.rotation=0}ratateTo({x:e,y:i}){let s=e-this.x,n=i-this.y;this.rotation=Math.atan2(n,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}};class os{constructor(e=0,i=0,s="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=e,this.y=i,this.color=s,this.rotation=0}ratateTo({x:e,y:i}){let s=e-this.x,n=i-this.y;this.rotation=Math.atan2(n,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}}let Ie,C,$e=.05,st=0,nt=0;const rs={settings:{name:"mouse_1",injectors:[R,We]},init(t,e){C=new os(e.width/2,e.height/2),$e=.05,Ie=e.injectors.mouse},render(t){let e=Ie.x-C.x,i=Ie.y-C.y,s=Math.atan2(i,e),n=Math.cos(s)*$e,r=Math.sin(s)*$e;C.rotation=s,st+=n,nt+=r,C.x+=st,C.y+=nt,C.draw(t)},destroy(){}},as={name:"chapter 5",expamples:[rs,ss]},ls=50,oe=10;let q,re=[];const hs={settings:{name:"removal"},init(t,e){q=ot(e),re=rt(q)},render(t){re=ds(re,q),re.forEach(e=>{e.think(),e.render(t)}),q.render(t)},destroy(){},resize(t,e){q=ot(e),re=rt(q)}};function ds(t,e){return t.filter(i=>!(i.x-i.radius>e.right||i.x+i.radius<e.x||i.y-i.radius>e.bottom||i.y+i.radius<e.y))}function ot(t){return new j(100,100,t.width-200,t.height-200,"#00ff00")}function rt(t){return pe(ls,()=>new ht(oe+t.x+Math.random()*(t.right-2*oe),oe+t.y+Math.random()*(t.bottom-2*oe),oe,"#ff6600",new It(Math.random()*2-1,Math.random()*2-1)))}const us={name:"chapter 6",expamples:[hs]};Pt([xt,us,as,is,li,Hi]);
