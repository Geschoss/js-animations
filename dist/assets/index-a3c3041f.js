var Je=Object.defineProperty;var Ne=(t,e,s)=>e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var n=(t,e,s)=>(Ne(t,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();function Fe(t,e){return e.expamples.find(({settings:s})=>s.name===t)}function xe(t,e){let s=new URL(window.location.href);s.searchParams.set(t,e),window.history.pushState("Animations",t,s)}function He(){let t=new URLSearchParams(window.location.search);return{chapter:t.get("chapter")||"",example:t.get("example")||""}}function Qe(t,e){let s=e[t];return s??Object.values(e)[0]}function Ve(t,e){let s=Fe(t,e);return s??e.expamples[0]}const Ze=()=>{let t={chapters:document.getElementById("chapters_menu"),examples:document.getElementById("examples_menu"),canvas:document.getElementById("canvas"),body:document.body};return{...t,updateExamplesMenu:Ke(t.examples),updateChaptersMenu:et(t.chapters)}};function Ke(t){return(e,s,i)=>{tt(t);let r;e.expamples.forEach(a=>{let o=document.createElement("div");o.classList.add("menu__item"),o.innerText=a.settings.name,s===a&&(r=o,r.classList.add("menu__item_selected")),o.addEventListener("click",()=>{r!==o&&(r&&r.classList.remove("menu__item_selected"),r=o,r.classList.add("menu__item_selected"),xe("example",a.settings.name),i(a.settings.name))}),t.appendChild(o)})}}function et(t){return(e,s,i)=>{let r;Object.keys(e).forEach(a=>{let o=e[a],l=document.createElement("div");l.classList.add("menu__item"),l.innerText=o.name,s===o&&(r=l,r.classList.add("menu__item_selected")),l.addEventListener("click",()=>{r!==l&&(r&&r.classList.remove("menu__item_selected"),r=l,r.classList.add("menu__item_selected"),xe("chapter",a),i(a))}),t.appendChild(l)}),i(s.name)}}function tt(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function g(t){return t==null||t==null}function st(t){return Object.values(t)}function pe(t,e){let s=[];for(let i=0;i<t;i++)s.push(e(i,t));return s}function it(t){const e=t.reduce((y,D)=>({...y,[D.name]:D}),{}),s=Ze(),i=He(),r=s.canvas.getContext("2d");let a=Qe(i.chapter,e),o,l,S,L={width:s.body.offsetWidth,height:s.body.offsetHeight,injectors:{}},b=L;s.updateChaptersMenu(e,a,Oe);function Oe(y){we(),a=e[y],o=Ve(i.example,a),s.updateExamplesMenu(a,o,Ue),ve()}function Ue(y){we(),o=Fe(y,a),ve()}function we(){l&&cancelAnimationFrame(l),o&&o.inited&&(g(b.injectors)||st(b.injectors).map(y=>y.destroy()),o.destroy(s.canvas),o.inited=!1),b=L}function ve(){var D;if(o.inited)return;let y=((D=o.settings.injectors)==null?void 0:D.reduce((Ge,Me)=>({...Ge,[Me.name]:rt(Me,{canvas:s.canvas})}),{}))||{};b={width:o.settings.width||s.body.offsetWidth,height:o.settings.height||s.body.offsetHeight,injectors:y},s.canvas.width=b.width,s.canvas.height=b.height,o.init(s.canvas,b,r),o.inited=!0,be(0)}function be(y){g(S)?ze():S(),S=o.render(r,b,y)||null,l=requestAnimationFrame(be)}function ze(){r.clearRect(0,0,s.canvas.width,s.canvas.height)}}function rt(t,e){let s=t.deps.map(({name:i})=>{let r=e[i];if(g(r))throw new Error(`${t.name} has unknow dep ${i}`);return r});return new t.instance(...s)}class Y{constructor(e){n(this,"x",0);n(this,"y",0);n(this,"leftButtonDown",!1);n(this,"rect");n(this,"canvas");n(this,"mousedown",e=>{this.leftButtonDown=!0});n(this,"mouseup",e=>{this.leftButtonDown=!1});n(this,"move",e=>{let s=0,i=0;e.pageX||e.pageY?(s=e.pageX,i=e.pageY):(s=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),s-=this.canvas.offsetLeft,i-=this.canvas.offsetTop,this.x=s,this.y=i});this.canvas=e,e.addEventListener("mousemove",this.move,!1),e.addEventListener("mousedown",this.mousedown,!1),e.addEventListener("mouseup",this.mouseup,!1)}destroy(){this.canvas.removeEventListener("mousemove",this.move,!1),this.canvas.removeEventListener("mousedown",this.mousedown,!1),this.canvas.removeEventListener("mouseup",this.mouseup,!1)}copyPos(){return{x:this.x,y:this.y}}}const A={name:"mouse",instance:Y,deps:[{name:"canvas"}]};let v=class{constructor(e=0,s=0,i=0,r="#ff6600"){n(this,"x");n(this,"y");n(this,"r");n(this,"c");n(this,"vx");n(this,"vy");n(this,"originX");n(this,"originY");this.x=e,this.y=s,this.r=i,this.c=r,this.vx=0,this.vy=0,this.originX=e,this.originY=s}set(e,s){this.x=e,this.y=s}think(e,s){let i=this.x-e.x,r=this.y-e.y;if(Math.sqrt(i*i+r*r)<e.r){let o=Math.atan2(r,i),l=e.x+Math.cos(o)*e.r,S=e.y+Math.sin(o)*e.r;this.vx+=l-this.x,this.vy+=S-this.y}this.vx+=s.spring.vx(this.x,this.originX,s),this.vy+=s.spring.vy(this.y,this.originY,s),this.vx*=s.friction.vx(this.x,this.originX,s),this.vy*=s.friction.vy(this.x,this.originX,s),this.x+=this.vx,this.y+=this.vy}render(e){e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI),e.fillStyle=this.c,e.fill(),e.closePath()}};class nt{constructor(e){n(this,"x",0);n(this,"y",0);n(this,"pressed",!1);n(this,"rect");n(this,"canvas");n(this,"touch_start",()=>{this.pressed=!0});n(this,"touch_end",()=>{this.pressed=!1,this.x=0,this.y=0});n(this,"touch_move",e=>{let s=0,i=0,r=e.touches[0];r.pageX||r.pageY?(s=r.pageX,i=r.pageY):(s=r.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=r.clientY+document.body.scrollTop+document.documentElement.scrollTop),s-=this.canvas.offsetLeft,i-=this.canvas.offsetTop,this.x=s,this.y=i});this.canvas=e,e.addEventListener("touchstart",this.touch_start,!1),e.addEventListener("touchmove",this.touch_move,!1),e.addEventListener("touchend",this.touch_end,!1)}destroy(){this.canvas.removeEventListener("touchstart",this.touch_start,!1),this.canvas.removeEventListener("touchmove",this.touch_move,!1),this.canvas.removeEventListener("touchend",this.touch_end,!1)}}var X=(t=>(t.Space="Space",t.ArrowUp="ArrowUp",t.ArrowLeft="ArrowLeft",t.ArrowDown="ArrowDown",t.ArrowRight="ArrowRight",t))(X||{});function _e(){return Math.random().toString(16).slice(2)}class m{constructor(){n(this,"keys_pressed",[]);n(this,"up_subscribers",[]);n(this,"down_subscribers",[]);n(this,"keydown",e=>{let s=e.code;this.keys_pressed.push(s),this.down_subscribers.forEach(({keys:i,cb:r})=>{(i.length===0||i.includes(s))&&r(s)})});n(this,"keyup",e=>{this.keys_pressed=this.keys_pressed.filter(i=>i!==e.code);let s=e.code;this.up_subscribers.forEach(({keys:i,cb:r})=>{(i.length===0||i.includes(s))&&r(s)})});window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1)}destroy(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1)}pressed(e){return g(e)?this.keys_pressed.length!=0:this.keys_pressed.includes(e)}down(e){let s=_e();return this.down_subscribers.push({...e,hash:s}),s}up(e){let s=_e();return this.up_subscribers.push({...e,hash:s}),s}}n(m,"keys",X);const ge={name:"keyboard",instance:m,deps:[]};let R,ie,re,ke;const ot={settings:{name:"arrow"},init(t){ie=new at(150,150),R=new Y(t),re=new v(100,100,20,"#eebe0a"),ke=new m},render(t){re.set(R.x,R.y),re.render(t),ie.ratateTo(R),ie.draw(t)},destroy(){ke.destroy(),R.destroy()}};let at=class{constructor(e=0,s=0,i="#ffff00"){n(this,"x");n(this,"y");n(this,"color","");n(this,"rotation",0);this.x=e,this.y=s,this.color=i,this.rotation=0}ratateTo({x:e,y:s}){let i=e-this.x,r=s-this.y;this.rotation=Math.atan2(r,i)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}},W={x:0,y:0},M={x:0,y:0},q;const lt={settings:{name:"distance"},init(t,e){q=new Y(t),W.x=Math.random()*e.width,W.y=Math.random()*e.height,M.x=Math.random()*e.width,M.y=Math.random()*e.height},render(t){t.fillStyle="#000000",t.fillRect(W.x-2,W.y-2,4,4),t.fillStyle="#ff0000",t.fillRect(M.x-2,M.y-2,4,4),t.font="30px Arial",t.fillText(`points distance: ${Te(W,M)}`,10,100),t.fillText(`mouse distance: ${Te(q,M)}`,10,130),t.beginPath(),t.moveTo(M.x,M.y),t.lineTo(q.x,q.y),t.closePath(),t.stroke()},destroy(){q.destroy()}};function Te(t,e){let s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i).toFixed(2)}class p{constructor(e=100,s=100,i=20,r="#ff0000"){n(this,"x",200);n(this,"y",100);n(this,"scaleX",1);n(this,"scaleY",1);n(this,"lineWidth",1);n(this,"color","");n(this,"radius",10);n(this,"rotation",0);this.x=e,this.y=s,this.color=r,this.radius=i}ratateTo({x:e,y:s}){let i=e-this.x,r=s-this.y;this.rotation=Math.atan2(r,i)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY),e.lineWidth=this.lineWidth,e.fillStyle=this.color,e.beginPath(),e.arc(0,0,this.radius,0,Math.PI*2,!0),e.closePath(),e.fill(),this.lineWidth>0&&e.stroke(),e.restore()}}let _,E={angle:0,centrY:200,range:50,xspeed:3,yspeed:.05},Z,k={angle:0,centryScale:1,range:.5,speed:.1},K,u={angleX:0,angleY:0,range:150,centerX:0,centerY:0,xspeed:.07,yspeed:.11};const ht={settings:{name:"liner"},init(t,e){_=new p(0,0),Z=new p(e.width/2,e.height/2,30,"#00ff00"),K=new p(e.width/2,e.height/2,30,"#0000ff"),u.centerX=e.width/2,u.centerY=e.height/2},render(t,e){return E.angle+=E.yspeed,_.x+=E.xspeed,_.y=E.centrY/2+Math.sin(E.angle)*E.range,_.x>e.width+_.radius&&(_.x=-_.radius,E.range+=1),Z.scaleX=k.centryScale+Math.sin(k.angle)*k.range,Z.scaleY=k.centryScale+Math.sin(k.angle)*k.range,k.angle+=k.speed,K.x=u.centerX+Math.sin(u.angleX)*u.range,K.y=u.centerY+Math.sin(u.angleY)*u.range,u.angleX+=u.xspeed,u.angleY+=u.yspeed,u.range+=.01,Z.render(t),_.render(t),K.render(t),()=>{}},destroy(){}};let T,I,F=0,Pe=0,$e=0,Se=100,dt=.02;const ut={settings:{name:"circle"},init(t,e){T=new p(200,200,40,"#11bbff"),I=new p(200,200,20,"#00ffff"),Pe=e.width/2,$e=e.height/2},render(t){F+=dt,T.x=Pe+Math.sin(F)*Se,T.y=$e+Math.cos(F)*Se,I.x=T.x+Math.sin(F*2)*100,I.y=T.y+Math.cos(F*2)*40,T.y-I.y>0?(I.render(t),T.render(t)):(T.render(t),I.render(t))},destroy(){}};let ne,oe,ee,te,ae,c=40,P=0;const ft={settings:{name:"waves"},init(t,e){ne=new p(e.width/2,e.height/2,c,"#ffee00"),oe=new p(e.width/2,e.height/2,c,"#00ff00"),ee=new p(e.width/2,e.height/2,c,"#0000ff"),te=new p(e.width/2,e.height/2,c,"#f0f0f0"),ae=new p(e.width/2,e.height/2,c)},render(t,e){P+=.03;let s=e.width/2,i=e.height/2;ne.x=s+Math.sin(P*.2)*(s-c),oe.y=i+Math.sin(P*.3)*(i-c),ee.y=i+Math.sin(P*.4)*(i-c),ee.x=s+Math.sin(P)*(s-c),te.y=i+Math.sin(P*.5)*(i-c),te.x=s+Math.cos(P*.2)*(s-c),ae.x=s+Math.sin(P*2)*(s-c),ne.render(t),oe.render(t),ee.render(t),te.render(t),ae.render(t)},destroy(){}},ct=[lt,ut,ht,ft,ot],yt={name:"chapter 3",expamples:ct};let x,le,O,mt={friction:vt(),spring:wt()};const pt={settings:{name:"balls_2"},init:(t,e)=>{x=new Y(t),le=gt(5e3,e),O=new v(100,100,20,"#eebe0a")},render:(t,e)=>{O.set(x.x,x.y),O.render(t),le.forEach(s=>{s.think(O,{...e,...mt}),s.render(t)})},destroy(){x.destroy(),x=void 0,le=void 0,O=void 0}};function gt(t,e){let s=[],i=e.width/10,r=e.height/10;for(let a=0;a<t;a++){let o=i+Math.random()*(e.width-i*2),l=r+Math.random()*(e.height-r*2);s.push(new v(o,l,o>e.width/2?2:3,o>e.width/2?"#00bcd4":"#bdb76b"))}return s}function wt(){let t=0,e=0;return{vx(s,i,r){let a=i>r.width/2?t:e;return-(s-i)*a},vy(s,i,r){let a=i>r.width/2?t:e;return-(s-i)*a}}}function vt(){let t=.99,e=.4;return{vx(s,i,r){return i>r.width/2?t:e},vy(s,i,r){return i>r.width/2?t:e}}}let U,he,z,bt={friction:Tt(.5),spring:kt(.01)};const Mt={settings:{name:"balls"},init:(t,e)=>{U=new Y(t),he=_t(5e3,e),z=new v(100,100,20,"#eebe0a")},render:t=>{z.set(U.x,U.y),z.render(t),he.forEach(e=>{e.think(z,bt),e.render(t)})},destroy(){U.destroy(),U=void 0,he=void 0,z=void 0}};function _t(t,e){let s=[],i=e.width/10,r=e.height/10;for(let a=0;a<t;a++){let o=i+Math.random()*(e.width-i*2),l=r+Math.random()*(e.height-r*2);s.push(new v(o,l,2,"#ff0000"))}return s}function kt(t){return{vx(e,s){return-(e-s)*t},vy(e,s){return-(e-s)*t}}}function Tt(t){return{vx(){return t},vy(){return t}}}let G,de,J,Pt={friction:Wt(.8),spring:Rt(.007)};const $t={settings:{name:"p_dor"},init:t=>{G=new Y(t),de=Et().map(e=>(e.set(100+Math.random()*500,100+Math.random()*400),e)),J=new v(100,100,20,"#eebe0a")},render:t=>{J.set(G.x,G.y),J.render(t),de.forEach(e=>{e.think(J,Pt),e.render(t)})},destroy(){G.destroy(),G=void 0,de=void 0,J=void 0}},St="#ff0000",Lt=2,d=(t,e,s=St)=>new v(t,e,Lt,s),h=20;function Et(){return[...Ct(),...At(),...It(),...jt(),...Bt(),...Xt(),...Yt()]}function Ct(){return[...f(200,250,h,t=>d(t,100)),...f(100,150,h,t=>d(225,t))]}function At(){return[...f(100,150,h,t=>d(270,t)),...V(270,135,h),...f(100,150,h,t=>d(310,t))]}function It(){return[...f(170,220,h,t=>d(150,t)),...f(150,170,h,t=>d(t,170)),...f(170,220,h,t=>d(170,t))]}function jt(){return[...f(170,220,h,t=>d(190,t)),...Dt(190,220,h),...f(170,220,h,t=>d(230,t))]}function Bt(){return[...f(170,220,h,t=>d(260,t)),...V(260,195,h,25)]}function Xt(){return[...V(325,185,h,15,1),...f(180,210,h,t=>d(310,t)),...f(180,210,h,t=>d(340,t)),...V(325,205,h,15,2)]}function Yt(){return[...f(170,220,h,t=>d(370,t)),...V(370,185,h,15,1.5)]}function V(t,e,s,i=15,r=1.5){let a=[];for(var o=0;o<=s;o++)a.push(d(t+i*Math.cos(Math.PI*o/s+Math.PI*r),e+i*Math.sin(Math.PI*o/s+Math.PI*r)));return a}function Dt(t,e,s){let i=[];for(var r=0;r<s;r++)i.push(d(t+2*r,e-2.5*r));return i}function f(t,e,s,i){let r=e-t,a=Math.trunc(r/(s-1)),o=[];for(let l=t;l<=e;l+=a)o.push(i(l));return o}function Rt(t){return{vx(e,s){return-(e-s)*t},vy(e,s){return-(e-s)*t}}}function Wt(t){return{vx(){return t},vy(){return t}}}let ue,N,j,qt={friction:Ut(.99),spring:Ot(0)};const Ft={settings:{name:"balls_touch"},init:(t,e)=>{j=new nt(t),ue=xt(2e3,e),N=new v(e.width/2,e.height/2,30,"#eebe0a")},render:t=>{j.pressed&&N.set(j.x,j.y),N.render(t),ue.forEach(e=>{e.think(N,qt),e.render(t)})},destroy(){j.destroy(),j=void 0,ue=void 0,N=void 0}};function xt(t,e){let s=[],i=e.width/20,r=e.height/20;for(let a=0;a<t;a++){let o=i+Math.random()*(e.width-i*2),l=r+Math.random()*(e.height-r*2);s.push(new v(o,l,2,"#00bcd4"))}return s}function Ot(t){return{vx(e,s){return-(e-s)*t},vy(e,s){return-(e-s)*t}}}function Ut(t){return{vx(){return t},vy(){return t}}}const zt=[Mt,pt,$t,Ft],Gt={name:"chapter_2",expamples:zt};let Le;const Jt={settings:{name:"curves",injectors:[A]},init(t,e){Le=new Nt(e.injectors.mouse,e)},render(t){Le.draw(t)},destroy(){}};let Nt=class{constructor(e,s){n(this,"points",[]);n(this,"point",{x0:0,y0:0,x1:0,y1:0});n(this,"mouse");this.mouse=e,this.points=pe(20,()=>({x:Math.random()*s.width,y:Math.random()*s.height})),this.point={x0:Math.random()*s.width,y0:Math.random()*s.height,x1:Math.random()*s.width,y1:Math.random()*s.height}}draw(e){e.beginPath(),e.strokeStyle="#00ff00",e.lineWidth=10,e.lineCap="butt",e.lineJoin="round",e.miterLimit=20,e.moveTo(this.point.x0,this.point.y0),e.quadraticCurveTo(this.mouse.x,this.mouse.y,this.point.x1,this.point.y1),e.stroke(),e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10,e.moveTo(this.points[0].x,this.points[0].y);for(let s=1;s<this.points.length-1;s+=2)e.quadraticCurveTo(this.points[s].x,this.points[s].y,this.points[s+1].x,this.points[s+1].y);e.stroke()}},Ee={x:100,y:100},Ce={x:200,y:200},fe={x:350,y:150,r:0},ce={x:350,y:150,r:50};const Ht={settings:{name:"gradient"},init(){},render(t){let e=t.createLinearGradient(Ee.x,Ee.y,Ce.x,Ce.y);e.addColorStop(0,"#ffffff"),e.addColorStop(.5,"#0000ff"),e.addColorStop(1,"#ff0000"),t.fillStyle=e,t.fillRect(100,100,200,200);let s=t.createRadialGradient(fe.x,fe.y,fe.r,ce.x,ce.y,ce.r);s.addColorStop(0,"#000000"),s.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=s,t.fillRect(300,100,100,100)},destroy(){}};let H={status:"new",data:new Image},Ae,Ie;const Qt={settings:{name:"image"},init(){H.data.src="./vovka.png",H.data.onload=()=>{H.status="ready"},Ae=document.getElementById("picture"),Ie=document.getElementById("video")},render(t){H.status==="ready"&&t.drawImage(H.data,80,0,135,135,90,90,65,65),t.drawImage(Ae,230,20,80,140,200,130,100,120),t.drawImage(Ie,300,150,100,100)},destroy(){}};let je;const Vt={settings:{name:"line",injectors:[A]},init(t,e){je=new Kt(e.injectors.mouse)},render(t){return je.draw(t),Zt},destroy(){}};function Zt(){}let Kt=class{constructor(e){n(this,"mouse");n(this,"prevPos");this.mouse=e}draw(e){g(this.prevPos)&&this.mouse.leftButtonDown?(e.strokeStyle="#ff0000",e.lineWidth=2,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.beginPath(),e.moveTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos()):!g(this.prevPos)&&this.mouse.leftButtonDown?(e.lineTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos(),e.stroke()):!g(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},Be;const es={settings:{name:"multi_curves",injectors:[A]},init(t,e){Be=new ts(e.injectors.mouse,e)},render(t){Be.draw(t)},destroy(){}};let ts=class{constructor(e,s){n(this,"count",10);n(this,"mouse");n(this,"points",[]);n(this,"ctrlPoint",{});this.mouse=e,this.points=pe(this.count,()=>({x:Math.random()*s.width,y:Math.random()*s.height}))}draw(e){e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10;let s=(this.points[0].x+this.points[this.count-1].x)/2,i=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(s,i);let r;for(r=1;r<this.points.length-2;r++){let a=(this.points[r].x+this.points[r+1].x)/2,o=(this.points[r].y+this.points[r+1].y)/2;e.quadraticCurveTo(this.points[r].x,this.points[r].y,a,o)}e.quadraticCurveTo(this.points[r].x,this.points[r].y,s,i),e.stroke(),e.beginPath(),e.strokeStyle="#0000ff",e.lineWidth=3,e.arc(100,200,40,0,Math.PI*2,!0),e.closePath(),e.stroke(),e.beginPath(),e.strokeStyle="#00ff44",e.lineWidth=5,e.moveTo(200,200),e.arcTo(200,50,150,200,20),e.stroke()}};class ss{static colorToRGB(e,s=1){let i;typeof e=="string"&&e[0]==="#"&&(i=parseInt(e.slice(1),16));var r=i>>16&255,a=i>>8&255,o=i&255,l=s<0?0:s>1?1:s;return l===1?`rgb(${r},${a},${o})`:`rgb(${r},${a},${o},${l})`}static parse(e,s=!1){return s===!0?typeof e=="number"?e|0:(typeof e=="string"&&e[0]==="#"&&(e=e.slice(1)),parseInt(e,16)):(typeof e=="number"&&(e="#"+("00000"+(e|0).toString(16)).substr(-6)),e)}}let Xe,Ye;const is={settings:{name:"pixel",injectors:[A]},init(t,e,s){Ye=s.getImageData(0,0,e.width,e.height),Xe=new ns(e.injectors.mouse)},render(t){return Xe.draw(t,Ye),rs},destroy(){}};function rs(){}let ns=class{constructor(e){n(this,"mouse");n(this,"prevPos");n(this,"brush_size",25);n(this,"brush_density",50);n(this,"brush_color",0);this.mouse=e}draw(e,s){let i=s.data;if(g(this.prevPos)&&this.mouse.leftButtonDown)this.brush_color=ss.parse(Math.random()*16777215,!0),this.prevPos=this.mouse.copyPos();else if(!g(this.prevPos)&&this.mouse.leftButtonDown){for(let r=0;r<this.brush_density;r++){let a=Math.random()*Math.PI*2,o=Math.random()*this.brush_size,l=this.mouse.x+Math.cos(a)*o|0,S=this.mouse.y+Math.sin(a)*o|0,L=(l+S*s.width)*4;i[L]=this.brush_color>>16&255,i[L+1]=this.brush_color>>8&255,i[L+2]=this.brush_color&255,i[L+3]=255}e.putImageData(s,0,0),this.prevPos=this.mouse.copyPos()}else!g(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},De;const os={settings:{name:"shapes",injectors:[A]},init(t,e){De=new as(e.injectors.mouse,e)},render(t){De.draw(t)},destroy(){}};class as{constructor(e,s){n(this,"count",10);n(this,"mouse");n(this,"points",[]);n(this,"ctrlPoint",{});this.mouse=e,this.points=pe(this.count,()=>({x:Math.random()*s.width,y:Math.random()*s.height}))}draw(e){e.beginPath(),e.fillStyle="#ff0000";let s=(this.points[0].x+this.points[this.count-1].x)/2,i=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(s,i);let r;for(r=1;r<this.points.length-2;r++){let a=(this.points[r].x+this.points[r+1].x)/2,o=(this.points[r].y+this.points[r+1].y)/2;e.quadraticCurveTo(this.points[r].x,this.points[r].y,a,o)}e.quadraticCurveTo(this.points[r].x,this.points[r].y,s,i),e.fill(),e.beginPath(),e.fillStyle="#00ff44",e.moveTo(100,100),e.arcTo(200,50,150,200,20),e.fill()}}const ls={name:"chapter 4",expamples:[is,Qt,Ht,os,es,Jt,Vt]};let Q,$,w=0;const hs={settings:{name:"acceleration",injectors:[A,ge]},init(t,e){$=new ds(e.width/2,e.height/2),w=0,Q=e.injectors.keyboard},render(t){Q.pressed(X.ArrowLeft)&&($.rotation-=2*Math.PI/180),Q.pressed(X.ArrowRight)&&($.rotation+=2*Math.PI/180),Q.pressed(X.ArrowUp)&&w<4&&(w+=.2),Q.pressed(X.ArrowDown)&&(w-=.2),w<0?w=0:w-=.05;let e=Math.cos($.rotation)*w,s=Math.sin($.rotation)*w;$.x+=e,$.y+=s,$.draw(t)},destroy(){}};let ds=class{constructor(e=0,s=0,i="#ffff00"){n(this,"x");n(this,"y");n(this,"color","");n(this,"rotation",0);this.x=e,this.y=s,this.color=i,this.rotation=0}ratateTo({x:e,y:s}){let i=e-this.x,r=s-this.y;this.rotation=Math.atan2(r,i)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}};class us{constructor(e=0,s=0,i="#ffff00"){n(this,"x");n(this,"y");n(this,"color","");n(this,"rotation",0);this.x=e,this.y=s,this.color=i,this.rotation=0}ratateTo({x:e,y:s}){let i=e-this.x,r=s-this.y;this.rotation=Math.atan2(r,i)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}}let ye,C,me=.05,Re=0,We=0;const fs={settings:{name:"mouse_1",injectors:[A,ge]},init(t,e){C=new us(e.width/2,e.height/2),me=.05,ye=e.injectors.mouse},render(t){let e=ye.x-C.x,s=ye.y-C.y,i=Math.atan2(s,e),r=Math.cos(i)*me,a=Math.sin(i)*me;C.rotation=i,Re+=r,We+=a,C.x+=Re,C.y+=We,C.draw(t)},destroy(){}},cs={name:"chapter 5",expamples:[fs,hs]};class ys{constructor(){n(this,"vr",0);n(this,"vx",0);n(this,"vy",0);n(this,"trust",0);n(this,"gravity",.01);n(this,"rotation",0)}left(){this.vr=-3}rigth(){this.vr=3}up(){this.trust=.05}forward(){this.vr=0}stop(){this.trust=0}calculate(){this.rotation+=this.vr*Math.PI/180;let e=Math.cos(this.rotation)*this.trust,s=Math.sin(this.rotation)*this.trust;return this.vx+=e,this.vy+=s,this.vx+=this.vx>0?-this.gravity:this.gravity,this.vy+=this.vy>0?-this.gravity:this.gravity,{vx:this.vx,vy:this.vy,rotation:this.rotation}}}class ms{constructor(e,s,i=0,r=0,a){n(this,"x");n(this,"y");n(this,"width");n(this,"height");n(this,"rotation");n(this,"showFlame");n(this,"keyboard");n(this,"acceleration");n(this,"weapon");this.x=i,this.y=r,this.width=25,this.height=20,this.weapon=a,this.rotation=0,this.keyboard=e,this.showFlame=!1,this.acceleration=s,this.keyboard.up({keys:[m.keys.ArrowUp,m.keys.ArrowLeft,m.keys.ArrowRight],cb:o=>{if(o===m.keys.ArrowUp){this.showFlame=!1,this.acceleration.stop();return}this.acceleration.forward()}})}shot(e){this.weapon.shot(this,e.bullets)}think(e){this.keyboard.pressed(m.keys.Space)&&this.shot(e),this.keyboard.pressed(m.keys.ArrowLeft)&&this.acceleration.left(),this.keyboard.pressed(m.keys.ArrowRight)&&this.acceleration.rigth(),this.keyboard.pressed(m.keys.ArrowUp)&&(this.acceleration.up(),this.showFlame=!0);let{vx:s,vy:i,rotation:r}=this.acceleration.calculate();this.rotation=r,this.x+=s,this.y+=i}render(e){if(e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(10,0),e.lineTo(-10,10),e.lineTo(-5,0),e.lineTo(-10,-10),e.lineTo(10,0),e.stroke(),this.showFlame){let s=Math.random()>.5?17:15;e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-7.5,-5),e.lineTo(-s,0),e.lineTo(-7.5,5),e.stroke()}e.restore()}}class ps{constructor(){n(this,"rate");n(this,"prevShotTime");this.rate=1,this.prevShotTime=0}shot(e,s){let i=new Date().getTime();i-this.prevShotTime>1e3/this.rate&&(this.prevShotTime=i,s.push(new gs(e.x,e.y,e.rotation)))}}class gs{constructor(e=0,s=0,i=0,r=2){n(this,"x");n(this,"y");n(this,"speed");n(this,"rotation");this.x=e+5*Math.cos(i),this.y=s+5*Math.sin(i),this.speed=r,this.rotation=i}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(8,1),e.lineTo(-8,1),e.lineTo(-8,-1),e.lineTo(8,-1),e.lineTo(8,1),e.stroke(),Math.random()>.1&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-8,-2),e.lineTo(-12,0),e.lineTo(-8,2),e.stroke()),e.restore()}}let B={enemies:[],bullets:[]},se;const ws={settings:{name:"spacesship",injectors:[ge]},init(t,e){let s=e.injectors.keyboard,i=new ys;se=new ms(s,i,e.width/2,e.height/2,new ps)},render(t,e){B.enemies.forEach(s=>{s.think(B),s.render(t)}),B.bullets.forEach(s=>{s.think(B),s.render(t)}),se.think(B),se.render(t),vs(B,e)},destroy(){se=void 0}};function vs(t,e){t.bullets=t.bullets.filter(s=>qe(0,e.width,s.x)&&qe(0,e.height,s.y))}function qe(t,e,s){return s>t&&s<e}const bs={name:"games",expamples:[ws]};it([cs,ls,yt,Gt,bs]);
