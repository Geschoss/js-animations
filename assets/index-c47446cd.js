var It=Object.defineProperty;var $t=(i,e,t)=>e in i?It(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var o=(i,e,t)=>($t(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();function vt(i,e){return e.expamples.find(({settings:t})=>t.name===i)}function Tt(i,e){let t=new URL(window.location.href);t.searchParams.set(i,e),window.history.pushState("Animations",i,t)}function Lt(){let i=new URLSearchParams(window.location.search);return{chapter:i.get("chapter")||"",example:i.get("example")||""}}function At(i,e){let t=e[i];return t??Object.values(e)[0]}function Wt(i,e){let t=vt(i,e);return t??e.expamples[0]}const Ct=()=>{let i={chapters:document.getElementById("chapters_menu"),examples:document.getElementById("examples_menu"),canvas:document.getElementById("canvas"),body:document.body};return{...i,onResize:Dt(),updateExamplesMenu:Bt(i.examples),updateChaptersMenu:Rt(i.chapters)}};function Dt(){return i=>{window.addEventListener("resize",()=>{i()})}}function Bt(i){return(e,t,s)=>{jt(i);let n;e.expamples.forEach(r=>{let a=document.createElement("div");a.classList.add("menu__item"),a.innerText=r.settings.name,t===r&&(n=a,n.classList.add("menu__item_selected")),a.addEventListener("click",()=>{n!==a&&(n&&n.classList.remove("menu__item_selected"),n=a,n.classList.add("menu__item_selected"),Tt("example",r.settings.name),s(r.settings.name))}),i.appendChild(a)})}}function Rt(i){return(e,t,s)=>{let n;Object.keys(e).forEach(r=>{let a=e[r],l=document.createElement("div");l.classList.add("menu__item"),l.innerText=a.name,t===a&&(n=l,n.classList.add("menu__item_selected")),l.addEventListener("click",()=>{n!==l&&(n&&n.classList.remove("menu__item_selected"),n=l,n.classList.add("menu__item_selected"),Tt("chapter",r),s(r))}),i.appendChild(l)}),s(t.name)}}function jt(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function M(i){return i==null||i==null}function Ot(i){return Object.values(i)}function fe(i,e){let t=[];for(let s=0;s<i;s++)t.push(e(s,i));return t}function _e(i,e){return Math.random()>.5?i:e}function Nt(i){const e=i.reduce((T,J)=>({...T,[J.name]:J}),{}),t=Ct(),s=Lt(),n=t.canvas.getContext("2d");let r=At(s.chapter,e),a,l,d,m={width:t.body.offsetWidth,height:t.body.offsetHeight,injectors:{}},c=m;t.updateChaptersMenu(e,r,kt),t.onResize(()=>{c={...c,width:a.settings.width||t.body.offsetWidth,height:a.settings.height||t.body.offsetHeight,tile_dimensions:a.settings.tile_dimensions},t.canvas.width=c.width,t.canvas.height=c.height,a.resize&&a.resize(n,c)});function kt(T){qe(),r=e[T],a=Wt(s.example,r),t.updateExamplesMenu(r,a,Pt),Ye()}function Pt(T){qe(),a=vt(T,r),Ye()}function Ye(){var J;if(a.inited)return;let T=((J=a.settings.injectors)==null?void 0:J.reduce((Et,ze)=>({...Et,[ze.name]:Xt(ze,{canvas:t.canvas})}),{}))||{};c={width:a.settings.width||t.body.offsetWidth,height:a.settings.height||t.body.offsetHeight,tile_dimensions:a.settings.tile_dimensions,injectors:T},t.canvas.width=c.width,t.canvas.height=c.height,a.init(t.canvas,c,n),a.inited=!0,He(0)}function He(T){M(d)?St():d(),d=a.render(n,c,T)||null,l=requestAnimationFrame(He)}function qe(){l&&cancelAnimationFrame(l),a&&a.inited&&(M(c.injectors)||Ot(c.injectors).map(T=>T.destroy()),a.destroy(t.canvas),a.inited=!1),c=m}function St(){n.clearRect(0,0,t.canvas.width,t.canvas.height)}}function Xt(i,e){let t=i.deps.map(({name:s})=>{let n=e[s];if(M(n))throw new Error(`${i.name} has unknow dep ${s}`);return n});return new i.instance(...t)}class Yt{constructor(e=0,t=0){o(this,"dx");o(this,"dy");this.dx=e,this.dy=t}think(e){e.x+=this.dx,e.y+=this.dy}}class Ht{constructor(e=.3,t=.3){o(this,"vy");o(this,"vx");this.vx=e,this.vy=t}think(e){e.x+=this.vx,e.y+=this.vy}}class Ne{think(){}}class Fe{render(e,{x:t,y:s,radius:n,color:r}){e.save(),e.beginPath(),e.arc(t,s,n,0,2*Math.PI),e.fillStyle=r,e.fill(),e.closePath(),e.restore()}}class qt{render(e,{x:t,y:s,width:n,height:r,color:a}){e.save(),e.strokeStyle=a,e.beginPath(),e.rect(t,s,n,r),e.closePath(),e.stroke(),e.restore()}}let _t=class{constructor(e=0,t=0,s=10,n="#ff6600",r=new Ne,a=new Fe){o(this,"x");o(this,"y");o(this,"color");o(this,"radius");o(this,"behavior");o(this,"view");this.x=e,this.y=t,this.color=n,this.radius=s,this.view=a,this.behavior=r}static create({x:e=0,y:t=0,radius:s=10,color:n="#ff6600",view:r=new Fe,behavior:a=new Ne}){return new _t(e,t,s,n,a,r)}think(){this.behavior.think(this)}render(e){this.view.render(e,this)}};class y{constructor(e,t){o(this,"x");o(this,"y");this.x=e,this.y=t}static create(e=0,t=0){return new y(e,t)}static from({x:e,y:t}){return new y(e,t)}add(e){return new y(this.x+e.x,this.y+e.y)}}class be{constructor(e,t,s,n){o(this,"x1");o(this,"x2");o(this,"y1");o(this,"y2");this.x1=e,this.y1=t,this.x2=s,this.y2=n}static create(e,t,s,n){return new be(e,t,e+s-1,t+n-1)}intersect(e){return this.x1<=e.x2&&this.x2>=e.x1&&this.y1<=e.y2&&this.y2>=e.y1}intersect_with_padding(e,t){return this.x1-t<=e.x2&&this.x2+t>=e.x1&&this.y1-t<=e.y2&&this.y2+t>=e.y1}for_each(e){for(let t=this.x1;t<=this.x2;t++)for(let s=this.y1;s<=this.y2;s++)e(y.from({x:t,y:s}))}center(){return new y((this.x1+this.x2)/2,(this.y1+this.y2)/2)}center_trunc(){return new y(Math.trunc((this.x1+this.x2)/2),Math.trunc((this.y1+this.y2)/2))}center_floor(){return new y(Math.floor((this.x1+this.x2)/2),Math.floor((this.y1+this.y2)/2))}cut_by_window(e,t){this.x1=this.x1<1?1:this.x1,this.x2=this.x2>e?e:this.x2,this.y1=this.y1<1?1:this.y1,this.y2=this.y2>t?t:this.y2}}class N{constructor(e=100,t=100,s=200,n=200,r="#ff0000",a=new Ne,l=new qt){o(this,"width");o(this,"height");o(this,"y");o(this,"x");o(this,"right");o(this,"bottom");o(this,"color");o(this,"behavior");o(this,"view");this.x=e,this.y=t,this.color=r,this.width=s,this.height=n,this.right=e+s,this.bottom=t+n,this.view=l,this.behavior=a}static create({x:e,y:t,width:s,height:n,color:r,view:a,behavior:l}){return new N(e,t,s,n,r,l,a)}think(){this.behavior.think(this)}render(e){this.view.render(e,this)}}class zt{constructor(e){o(this,"x",0);o(this,"y",0);o(this,"pressed",!1);o(this,"rect");o(this,"canvas");o(this,"touch_start",()=>{this.pressed=!0});o(this,"touch_end",()=>{this.pressed=!1,this.x=0,this.y=0});o(this,"touch_move",e=>{let t=0,s=0,n=e.touches[0];n.pageX||n.pageY?(t=n.pageX,s=n.pageY):(t=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=n.clientY+document.body.scrollTop+document.documentElement.scrollTop),t-=this.canvas.offsetLeft,s-=this.canvas.offsetTop,this.x=t,this.y=s});this.canvas=e,e.addEventListener("touchstart",this.touch_start,!1),e.addEventListener("touchmove",this.touch_move,!1),e.addEventListener("touchend",this.touch_end,!1)}destroy(){this.canvas.removeEventListener("touchstart",this.touch_start,!1),this.canvas.removeEventListener("touchmove",this.touch_move,!1),this.canvas.removeEventListener("touchend",this.touch_end,!1)}}class K{constructor(e){o(this,"x",0);o(this,"y",0);o(this,"leftButtonDown",!1);o(this,"rect");o(this,"canvas");o(this,"mousedown",e=>{this.leftButtonDown=!0});o(this,"mouseup",e=>{this.leftButtonDown=!1});o(this,"move",e=>{let t=0,s=0;e.pageX||e.pageY?(t=e.pageX,s=e.pageY):(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),t-=this.canvas.offsetLeft,s-=this.canvas.offsetTop,this.x=t,this.y=s});this.canvas=e,e.addEventListener("mousemove",this.move,!1),e.addEventListener("mousedown",this.mousedown,!1),e.addEventListener("mouseup",this.mouseup,!1)}destroy(){this.canvas.removeEventListener("mousemove",this.move,!1),this.canvas.removeEventListener("mousedown",this.mousedown,!1),this.canvas.removeEventListener("mouseup",this.mouseup,!1)}copyPos(){return{x:this.x,y:this.y}}}const X={name:"mouse",instance:K,deps:[{name:"canvas"}]};var G=(i=>(i.KeyO="KeyO",i.KeyP="KeyP",i.KeyL="KeyL",i.Space="Space",i.Enter="Enter",i.ArrowUp="ArrowUp",i.Semicolon="Semicolon",i.ArrowLeft="ArrowLeft",i.ArrowDown="ArrowDown",i.ArrowRight="ArrowRight",i))(G||{});function Ue(){return Math.random().toString(16).slice(2)}class h{constructor(){o(this,"keys_pressed",[]);o(this,"up_subscribers",[]);o(this,"down_subscribers",[]);o(this,"keydown",e=>{let t=e.code;this.keys_pressed.push(t),this.down_subscribers.forEach(({keys:s,cb:n})=>{(s.length===0||s.includes(t))&&n(t)})});o(this,"keyup",e=>{this.keys_pressed=this.keys_pressed.filter(s=>s!==e.code);let t=e.code;this.up_subscribers.forEach(({keys:s,cb:n})=>{(s.length===0||s.includes(t))&&n(t)})});window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1)}destroy(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1)}pressed(e){return M(e)?this.keys_pressed.length!=0:this.keys_pressed.includes(e)}down(e){let t=Ue();return this.down_subscribers.push({...e,hash:t}),t}up(e){let t=Ue();return this.up_subscribers.push({...e,hash:t}),t}}o(h,"keys",G);const me={name:"keyboard",instance:h,deps:[]},Z={coin(i,e){return Math.random()>.5?i:e},range(i,e){return Math.trunc(i+Math.random()*(e-i))}};var U=(i=>(i[i.Wall=0]="Wall",i[i.Floor=1]="Floor",i))(U||{});class Xe{constructor(e,t,s){o(this,"tiles");o(this,"width",0);o(this,"height",0);this.width=t,this.tiles=e,this.height=s}static create(e,t){let s=fe(e*t,()=>1);return new Xe(s,e,t)}render(e,t,s){for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++){let a=this.idx(n,r),l=this.tiles[a],d=t.centre.x+(n-t.position.x)*s.tile_dimensions.x,m=t.centre.y+(r-t.position.y)*s.tile_dimensions.y;switch(l){case 1:Ft(e,d,m,s.tile_dimensions.x,s.tile_dimensions.y);break}}}can_enter_tile(e){return this.in_bounds(e)&&this.tiles[this.idx(e.x,e.y)]===1}in_bounds(e){return e.x>=0&&e.x<this.width-1&&e.y>=0&&e.y<this.height-1}try_idx(e){if(this.in_bounds(e))return this.idx(e.x,e.y)}idx(e,t){return t*this.width+e}}function Ft(i,e,t,s,n){i.save(),i.fillStyle="#ff00ff",i.beginPath(),i.rect(e,t,s,n),i.closePath(),i.fill(),i.restore()}const Ut=60,Ge=25,Ke=5,Gt=200;class Me{constructor(e,t,s){o(this,"map");o(this,"rooms");o(this,"player_start");this.map=e,this.rooms=t,this.player_start=s}static create(e,t){let s=new Me(Xe.create(e,t),[],y.create());return s.fill(U.Wall),s.build_random_rooms(e,t),s.build_corridors(),s.player_start=s.rooms[0].center_trunc(),s}fill(e){this.map.tiles=this.map.tiles.map(()=>e)}mock_rooms(e,t){this.rooms=Kt().map(({x1:s,x2:n,y1:r,y2:a})=>new be(s,r,n,a)),this.rooms.forEach(s=>{s.for_each(({x:n,y:r})=>{if(n>0&&n<e-1&&r>0&&r<t-1){let a=this.map.idx(n,r);this.map.tiles[a]=U.Floor}})})}build_random_rooms(e,t){let s=0;for(;this.rooms.length<Ut;){let n=be.create(Z.range(-2,e-2),Z.range(-2,t-2),Z.range(Ke,Ge),Z.range(Ke,Ge));if(n.cut_by_window(e-2,t-2),s+=1,this.rooms.some(a=>a.intersect_with_padding(n,1))||(s=0,n.for_each(({x:a,y:l})=>{let d=this.map.idx(a,l);this.map.tiles[d]=U.Floor}),this.rooms.push(n)),Gt<s)break}}apply_horizontal_tunnel(e,t,s){for(let n=Math.min(e,t);n<=Math.max(e,t);n++){let r=this.map.try_idx(y.create(n,s));r&&(this.map.tiles[r]=U.Floor)}}apply_vertical_tunnel(e,t,s){for(let n=Math.min(e,t);n<=Math.max(e,t);n++){let r=this.map.try_idx(y.create(s,n));r&&(this.map.tiles[r]=U.Floor)}}build_corridors(){let e=this.rooms.sort((n,r)=>n.center_trunc().x-r.center_trunc().x),[t,...s]=e;s.forEach(n=>{let r=n.center_trunc(),a=t.center_trunc();Z.coin(!0,!1)?(this.apply_horizontal_tunnel(a.x,r.x,a.y),this.apply_vertical_tunnel(a.y,r.y,r.x)):(this.apply_vertical_tunnel(a.y,r.y,a.x),this.apply_horizontal_tunnel(a.x,r.x,r.y)),t=n})}}function Kt(){return[{x1:1,x2:6,y1:9,y2:14},{x1:10,x2:15,y1:3,y2:8},{x1:13,x2:19,y1:17,y2:23}]}class ke{constructor(e,t,s){o(this,"position");o(this,"centre");o(this,"prevMove");this.position=y.create(e,t),this.centre=s,this.prevMove=0,console.log(e,t,s)}static create(e=0,t=0,s){return new ke(e,t,s)}render(e,t){e.save(),e.fillStyle="#00ff00",e.beginPath(),e.rect(this.centre.x,this.centre.y,t.tile_dimensions.x||16,t.tile_dimensions.y||16),e.closePath(),e.fill(),e.restore()}update(e,t){let s=new Date().getTime();if(s-this.prevMove>50){this.prevMove=s;let n=this.move(t.injectors.keyboard),r=this.position.add(n);e.can_enter_tile(r)&&(this.position=r)}}move(e){return e.pressed(h.keys.ArrowLeft)?y.from({x:-1,y:0}):e.pressed(h.keys.ArrowRight)?y.from({x:1,y:0}):e.pressed(h.keys.ArrowUp)?y.from({x:0,y:-1}):e.pressed(h.keys.ArrowDown)?y.from({x:0,y:1}):y.from({x:0,y:0})}}const Je=24,k={map:null,camera:null,player:null},Jt={settings:{name:"dungeon_crawl",injectors:[me],tile_dimensions:{x:Je,y:Je}},init(i,e){let t=Me.create(100,100);k.map=t.map,k.player=ke.create(t.player_start.x,t.player_start.y,y.create(e.width/2,e.height/2))},render(i,e){k.player.update(k.map,e),k.map.render(i,k.player,e),k.player.render(i,e)},resize(i,e){let t=Me.create(100,100);k.map=t.map,k.player=ke.create(t.player_start.x,t.player_start.y,y.create(e.width/2,e.height/2))},destroy(){}};class bt{constructor(){o(this,"rect");o(this,"velocity");o(this,"keyboard");this.rect=N.create({x:150,y:350,width:50,height:50,color:"#00ff00"}),this.velocity=0}render(e){this.rect.render(e)}think(){this.rect.y+=this.velocity,this.velocity<6&&(this.velocity+=.2)}collision(e,t){return this.rect.color="#00ff00",t.y>this.rect.y||t.bottom<this.rect.y+this.rect.width?!0:e.some(s=>s.collision(this.rect))}}const u=class{constructor(e,t,s,n=0){o(this,"top");o(this,"bottom");o(this,"x");o(this,"y");o(this,"behavior");this.x=e,this.y=t,this.behavior=new Yt(u.SPEED-n/10);let r=u.GAP-n;this.top=N.create({x:e,y:t,width:u.WIDTH,height:u.MIN_HEIGHT+Math.random()*(s-(r+u.MIN_HEIGHT))}),this.bottom=N.create({x:this.top.x,y:this.top.bottom+r,width:u.WIDTH,height:s-this.top.height-r})}think(){this.behavior.think(this),this.top.x=this.x,this.bottom.x=this.x}render(e){this.top.render(e),this.bottom.render(e)}collision(e){let t={x:e.x,y:e.y},s={x:e.x+e.width,y:e.y},n={x:e.x,y:e.y+e.height},r={x:e.x+e.width,y:e.y+e.height},a={x:this.top.x,y:this.top.y+this.top.height},l={x:this.top.x+u.WIDTH,y:this.top.y+this.top.height},d={x:this.bottom.x,y:this.bottom.y},m={x:this.bottom.x+u.WIDTH,y:this.bottom.y};return s.x<this.x||this.x+u.WIDTH<e.x?!1:!!(Y(a.x,s.x,l.x)&&Y(this.y,s.y,a.y)||Y(a.x,t.x,l.x)&&Y(this.y,t.y,a.y)||Y(d.x,r.x,m.x)&&d.y<r.y||Y(d.x,n.x,m.x)&&d.y<n.y)}static create(e){let t=[],s=e.width,n=e.y,r=e.height,a=e.width/(u.WIDTH+u.DISTANCE_BEETWEN)+1;for(let l=0;l<a;l++)t.push(new u(s,n,r)),s+=u.WIDTH+u.DISTANCE_BEETWEN;return t}static move(e,t,s){let n=e[0],r=e[e.length-1],a=t.x-u.WIDTH;if(n.x<a){e.shift();let l=t.y,d=t.height;return e.push(new u(r.x+u.WIDTH+u.DISTANCE_BEETWEN,l,d,s)),!0}return!1}};let _=u;o(_,"GAP",290),o(_,"WIDTH",50),o(_,"MIN_HEIGHT",10),o(_,"DISTANCE_BEETWEN",290),o(_,"SPEED",-4);function Y(i,e,t){return i<e&&e<t}let D={type:"init",bird:null,screen:null,pipes:[],score:0};const Zt={settings:{name:"Flappy_Bird",injectors:[me]},init(i,e){D.screen=ei(e)},render(i,e){switch(D.screen.render(i),D.type){case"init":Vt(D,e,i);break;case"play":Qt(D,e,i);break;case"dead":xt(D,e,i);break}},destroy(){D={type:"init",bird:null,screen:null,pipes:[],score:0}}};function Vt(i,e,t){t.font="30px Arial",t.fillStyle="#0000ff",t.fillText("Press ENTER to start",e.width/2-150,e.height/2),e.injectors.keyboard.pressed(h.keys.Enter)&&(i.type="play",i.bird=new bt,i.pipes=_.create(i.screen),i.score=0)}function Qt(i,e,t){if(Mt(i,e,t),e.injectors.keyboard.pressed(h.keys.Space)&&(i.bird.velocity=-6),i.bird.think(),i.bird.collision(i.pipes,i.screen)){i.type="dead";return}i.bird.render(t),i.pipes.forEach(s=>{s.think(),s.render(t)}),_.move(i.pipes,i.screen,i.score)&&(i.score+=1)}function xt(i,e,t){Mt(i,e,t),t.font="30px Arial",t.fillStyle="#0000ff",t.fillText("You are dead",e.width/2-100,e.height/2-30),t.fillText("Press ENTER to start",e.width/2-150,e.height/2),e.injectors.keyboard.pressed(h.keys.Enter)&&(i.type="play",i.bird=new bt,i.pipes=_.create(i.screen),i.score=0)}function ei(i){let e=i.width*5/100,t=i.height*10/100;return new N(e,t,i.width-2*e,i.height-2*t,"#0000ff")}function Mt(i,e,t){t.font="35px Arial",t.fillStyle="#0000ff",t.fillText(`Score: ${i.score}`,e.width/2-70,150)}class ti{constructor(){o(this,"vr",0);o(this,"vx",0);o(this,"vy",0);o(this,"trust",0);o(this,"gravity",.01);o(this,"rotation",0)}left(){this.vr=-3}rigth(){this.vr=3}up(){this.trust=.05}forward(){this.vr=0}stop(){this.trust=0}calculate(){this.rotation+=this.vr*Math.PI/180;let e=Math.cos(this.rotation)*this.trust,t=Math.sin(this.rotation)*this.trust;return this.vx+=e,this.vy+=t,this.vx+=this.vx>0?-this.gravity:this.gravity,this.vy+=this.vy>0?-this.gravity:this.gravity,{vx:this.vx,vy:this.vy,rotation:this.rotation}}}class ii{constructor(e,t,s=0,n=0,r,a){o(this,"x");o(this,"y");o(this,"width");o(this,"height");o(this,"rotation");o(this,"moving");o(this,"keyboard");o(this,"acceleration");o(this,"weapon");o(this,"view");this.x=s,this.y=n,this.width=25,this.height=20,this.rotation=0,this.keyboard=e,this.moving=!1,this.acceleration=t,this.weapon=r,this.view=new a(r),this.keyboard.up({keys:[h.keys.ArrowUp,h.keys.ArrowLeft,h.keys.ArrowRight],cb:l=>{if(l===h.keys.ArrowUp){this.moving=!1,this.acceleration.stop();return}this.acceleration.forward()}})}changeChip(e){this.view=new e(this.weapon)}cnahgeWeapon(e){this.view.changeWeapon(e)}shot(e){const t=this.view.shot(this);t&&e.bullets.push(...t)}think(e){this.keyboard.pressed(h.keys.Space)&&this.shot(e),this.keyboard.pressed(h.keys.ArrowLeft)&&this.acceleration.left(),this.keyboard.pressed(h.keys.ArrowRight)&&this.acceleration.rigth(),this.keyboard.pressed(h.keys.ArrowUp)&&(this.acceleration.up(),this.moving=!0);let{vx:t,vy:s,rotation:n}=this.acceleration.calculate();this.rotation=n,this.x+=t,this.y+=s}render(e){this.view.render(e,this)}}class si{constructor(e){o(this,"name","classic");o(this,"weapon_name");o(this,"weapon");const t=new e;this.weapon_name=t.name,this.weapon=new e}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapon=new e}shot(e){const t=this.weapon.shot({x:e.x,y:e.y,rotation:e.rotation});if(t)return[t]}render(e,t){if(e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(10,0),e.lineTo(-10,10),e.lineTo(-5,0),e.lineTo(-10,-10),e.lineTo(10,0),e.stroke(),t.moving){let s=Math.random()>.5?17:15;e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-7.5,-5),e.lineTo(-s,0),e.lineTo(-7.5,5),e.stroke()}e.restore()}}class ni{constructor(e){o(this,"name","эх-100");o(this,"weapon_name");o(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}shot(e){const n=this.weapons[0].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*1.88),y:e.y+15*Math.sin(e.rotation+Math.PI*1.88),rotation:e.rotation}),r=.12,a=this.weapons[1].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*r),y:e.y+15*Math.sin(e.rotation+Math.PI*r),rotation:e.rotation});let l=[];return n&&l.push(n),a&&l.push(a),l.length>0?l:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(15,10),e.lineTo(10,10),e.lineTo(10,5),e.lineTo(-10,5),e.lineTo(-10,10),e.lineTo(-15,10),e.lineTo(-15,-10),e.lineTo(-10,-10),e.lineTo(-10,-5),e.lineTo(-10,-5),e.lineTo(10,-5),e.lineTo(10,-10),e.lineTo(15,-10),e.stroke(),e.beginPath(),e.moveTo(15,10),e.quadraticCurveTo(30,0,15,-10),e.stroke(),t.moving&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-15,-10),e.lineTo(-Ze(25,22),-5),e.lineTo(-15,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-15,10),e.lineTo(-Ze(25,22),5),e.lineTo(-15,0),e.stroke()),e.restore()}}function Ze(i,e){return Math.random()>.5?i:e}class oi{constructor(e){o(this,"name","еф-100");o(this,"weapon_name");o(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}shot(e){const n=this.weapons[0].shot({x:e.x+17*Math.cos(e.rotation+Math.PI*1.88),y:e.y+17*Math.sin(e.rotation+Math.PI*1.88),rotation:e.rotation}),r=.12,a=this.weapons[1].shot({x:e.x+17*Math.cos(e.rotation+Math.PI*r),y:e.y+17*Math.sin(e.rotation+Math.PI*r),rotation:e.rotation});let l=[];return n&&l.push(n),a&&l.push(a),l.length>0?l:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.strokeStyle="#ff0000",e.beginPath(),e.arc(0,0,15,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.arc(0,0,5,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(3,15),e.quadraticCurveTo(5,22,10,21),e.stroke(),e.beginPath(),e.moveTo(8,13),e.quadraticCurveTo(10,18,15,17),e.stroke(),e.beginPath(),e.moveTo(15,17),e.lineTo(20,17),e.stroke(),e.beginPath(),e.moveTo(10,21),e.lineTo(20,21),e.stroke(),e.beginPath(),e.moveTo(20,21),e.lineTo(20,17),e.stroke(),e.beginPath(),e.moveTo(20,21),e.lineTo(24,19),e.stroke(),e.beginPath(),e.moveTo(20,17),e.lineTo(24,18),e.stroke(),e.beginPath(),e.moveTo(13,7),e.lineTo(30,3),e.stroke(),e.beginPath(),e.moveTo(15,2),e.lineTo(30,2),e.stroke(),e.beginPath(),e.moveTo(13,-7),e.lineTo(30,-3),e.stroke(),e.beginPath(),e.moveTo(15,-2),e.lineTo(30,-2),e.stroke(),e.beginPath(),e.moveTo(15,0),e.lineTo(5,0),e.stroke(),e.beginPath(),e.moveTo(0,15),e.lineTo(0,5),e.stroke(),e.beginPath(),e.moveTo(0,-15),e.lineTo(0,-5),e.stroke(),e.beginPath(),e.moveTo(-15,0),e.lineTo(-5,0),e.stroke(),e.beginPath(),e.moveTo(4,4),e.lineTo(11,11),e.stroke(),e.beginPath(),e.moveTo(4,-4),e.lineTo(11,-11),e.stroke(),e.beginPath(),e.moveTo(-4,-4),e.lineTo(-11,-11),e.stroke(),e.beginPath(),e.moveTo(-4,4),e.lineTo(-11,11),e.stroke(),t.moving&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-10,-12),e.lineTo(-pe(21,19),-11),e.lineTo(-14,-7),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-12,-7),e.lineTo(-pe(22,20),-4),e.lineTo(-14,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-12,7),e.lineTo(-pe(22,20),4),e.lineTo(-14,0),e.stroke(),e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-14,7),e.lineTo(-pe(21,19),11),e.lineTo(-10,12),e.stroke()),e.restore()}}function pe(i,e){return Math.random()>.5?i:e}class ri{constructor(e){o(this,"name","т-50");o(this,"weapon_name");o(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e]}shot(e){const s=[],r=this.weapons[0].shot({x:e.x+10*Math.cos(e.rotation+Math.PI*1.5),y:e.y+10*Math.sin(e.rotation+Math.PI*1.5),rotation:e.rotation});r&&s.push(r);const a=.5,l=this.weapons[1].shot({x:e.x+10*Math.cos(e.rotation+Math.PI*a),y:e.y+10*Math.sin(e.rotation+Math.PI*a),rotation:e.rotation});return l&&s.push(l),s.length>0?s:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(20,0),e.lineTo(15,-5),e.lineTo(-15,-5),e.lineTo(-20,-10),e.lineTo(-20,10),e.lineTo(-15,5),e.lineTo(15,5),e.lineTo(20,0),e.stroke(),e.beginPath(),e.moveTo(0,-5),e.lineTo(0,-10),e.lineTo(5,-10),e.lineTo(5,-5),e.stroke(),e.beginPath(),e.moveTo(0,5),e.lineTo(0,10),e.lineTo(5,10),e.lineTo(5,5),e.stroke(),t.moving&&(e.strokeStyle="#ff9200",e.beginPath(),e.moveTo(-20,-10),e.lineTo(-_e(30,27),-6),e.lineTo(-20,-2),e.stroke(),e.beginPath(),e.moveTo(-20,10),e.lineTo(-_e(30,27),6),e.lineTo(-20,2),e.stroke()),e.restore()}}class ai{constructor(e){o(this,"name","еф-50");o(this,"weapon_name");o(this,"weapons");const t=new e;this.weapon_name=t.name,this.weapons=[t,new e,new e]}changeWeapon(e){const t=new e;this.weapon_name=t.name,this.weapons=[t,new e,new e]}shot(e){const s=[],r=this.weapons[0].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*1.84),y:e.y+15*Math.sin(e.rotation+Math.PI*1.84),rotation:e.rotation-.03});r&&s.push(r);const a=.16,l=this.weapons[1].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*a),y:e.y+15*Math.sin(e.rotation+Math.PI*a),rotation:e.rotation+.03});l&&s.push(l);const d=0,m=this.weapons[2].shot({x:e.x+15*Math.cos(e.rotation+Math.PI*d),y:e.y+15*Math.sin(e.rotation+Math.PI*d),rotation:e.rotation});return m&&s.push(m),s.length>0?s:void 0}render(e,t){e.save(),e.translate(t.x,t.y),e.rotate(t.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(20,0),e.lineTo(15,-10),e.lineTo(-15,-15),e.lineTo(-10,0),e.lineTo(-15,15),e.lineTo(15,10),e.lineTo(20,0),e.stroke(),e.beginPath(),e.moveTo(15,-10),e.quadraticCurveTo(8,0,15,10),e.stroke(),e.beginPath(),e.moveTo(-12,-2),e.lineTo(-20,-2),e.lineTo(-20,-9),e.lineTo(-14,-9),e.stroke(),e.beginPath(),e.moveTo(-12,2),e.lineTo(-20,2),e.lineTo(-20,9),e.lineTo(-14,9),e.stroke(),e.beginPath(),e.moveTo(7,11),e.lineTo(7,15),e.lineTo(14,15),e.stroke(),e.beginPath(),e.moveTo(7,-11),e.lineTo(7,-15),e.lineTo(14,-15),e.stroke(),t.moving&&(e.strokeStyle="#ff9200",e.beginPath(),e.moveTo(-20,-9),e.lineTo(-_e(30,27),-6),e.lineTo(-20,-2),e.stroke(),e.beginPath(),e.moveTo(-20,9),e.lineTo(-_e(30,27),6),e.lineTo(-20,2),e.stroke()),e.restore()}}class li{constructor(){o(this,"name","Рокетница");o(this,"rate");o(this,"prevShotTime");this.rate=1,this.prevShotTime=0}shot(e){let t=new Date().getTime();if(t-this.prevShotTime>1e3/this.rate)return this.prevShotTime=t,new hi(e.x,e.y,e.rotation)}}class hi{constructor(e=0,t=0,s=0,n=0,r=.04){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");o(this,"acceleration");o(this,"max_speed");this.x=e+5*Math.cos(s),this.y=t+5*Math.sin(s),this.speed=n,this.rotation=s,this.acceleration=r,this.max_speed=6}think(){this.speed+=this.acceleration,this.speed>=this.max_speed?this.acceleration=0:this.acceleration+=.02,this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=1,e.strokeStyle="#ff0000",e.beginPath(),e.moveTo(8,1),e.lineTo(-8,1),e.lineTo(-8,-1),e.lineTo(8,-1),e.lineTo(8,1),e.stroke(),Math.random()>.1&&(e.beginPath(),e.strokeStyle="#ff9200",e.moveTo(-8,-2),e.lineTo(-12,0),e.lineTo(-8,2),e.stroke()),e.restore()}}class di{constructor(){o(this,"name","Пулимет");o(this,"rate");o(this,"bulletSpeed");o(this,"prevShotTime");this.rate=10,this.prevShotTime=0,this.bulletSpeed=6}shot(e){let t=new Date().getTime();if(t-this.prevShotTime>1e3/this.rate)return this.prevShotTime=t,new ui(e.x,e.y,e.rotation,this.bulletSpeed)}}class ui{constructor(e,t,s,n=3){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");this.x=e,this.y=t,this.speed=n,this.rotation=s}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){let t=5*Math.cos(this.rotation),s=5*Math.sin(this.rotation);e.save(),e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=2,e.moveTo(this.x,this.y),e.lineTo(this.x+t,this.y+s),e.closePath(),e.stroke(),e.restore()}}class yi{constructor(){o(this,"name","Плазма");o(this,"rate");o(this,"bulletSpeed");o(this,"prevShotTime");this.rate=5,this.prevShotTime=0,this.bulletSpeed=6}shot(e){let t=new Date().getTime();if(t-this.prevShotTime>1e3/this.rate)return this.prevShotTime=t,new fi(e.x,e.y,e.rotation,this.bulletSpeed)}}class fi{constructor(e,t,s,n=4){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");this.x=e,this.y=t,this.speed=n,this.rotation=s}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(e){e.save(),e.beginPath(),e.fillStyle="#00ff00",e.beginPath(),e.arc(this.x,this.y,3,0,2*Math.PI),e.fill(),e.closePath(),e.restore()}}const Pe=[ai,ri,si,ni,oi],Te=[di,li,yi];let j=0,O=0,H={enemies:[],bullets:[]},P;const mi={settings:{name:"Spacesship",injectors:[me]},init(i,e){let t=e.injectors.keyboard,s=new ti,n=Pe[O];P=new ii(t,s,e.width/2,e.height/2,Te[j],n),t.down({keys:[h.keys.KeyL,h.keys.Semicolon,h.keys.KeyO,h.keys.KeyP],cb:r=>{r===h.keys.KeyL&&Qe(P,Pe,1),r===h.keys.Semicolon&&Qe(P,Pe,-1),r===h.keys.KeyO&&xe(P,1),r===h.keys.KeyP&&xe(P,-1)}})},render(i,e){ci(i,e),wi(i,e,P),H.enemies.forEach(t=>{t.think(H),t.render(i)}),H.bullets.forEach(t=>{t.think(H),t.render(i)}),P.think(H),P.render(i),pi(H,e)},destroy(){P=void 0}};function pi(i,e){i.bullets=i.bullets.filter(t=>Ve(0,e.width,t.x)&&Ve(0,e.height,t.y))}function Ve(i,e,t){return t>i&&t<e}function Qe(i,e,t){O+=t,O>=e.length&&(O=0),O<0&&(O=e.length-1),i.changeChip(e[O])}function xe(i,e){j+=e,j>=Te.length&&(j=0),j<0&&(j=Te.length-1),i.cnahgeWeapon(Te[j])}function ci(i,e){i.save(),i.fillStyle="#ff0000",i.font="20px Arial",i.fillText("Смена корабля: Д или Ж",10,e.height-10),i.fillText("Смена оружия: Щ или З",10,e.height-30),i.fillText("Летать на стрелки",10,e.height-50),i.restore()}function wi(i,e,t){i.save(),i.fillStyle="#ff0000",i.font="20px Arial",i.fillText(`корабль: ${t.view.name}`,10,e.height-80),i.fillText(`оружие: ${t.view.weapon_name}`,10,e.height-100),i.restore()}const gi={name:"games",expamples:[mi,Zt,Jt]};let E=class{constructor(e=0,t=0,s=0,n="#ff6600"){o(this,"x");o(this,"y");o(this,"r");o(this,"c");o(this,"vx");o(this,"vy");o(this,"originX");o(this,"originY");this.x=e,this.y=t,this.r=s,this.c=n,this.vx=0,this.vy=0,this.originX=e,this.originY=t}set(e,t){this.x=e,this.y=t}think(e,t){let s=this.x-e.x,n=this.y-e.y;if(Math.sqrt(s*s+n*n)<e.r){let a=Math.atan2(n,s),l=e.x+Math.cos(a)*e.r,d=e.y+Math.sin(a)*e.r;this.vx+=l-this.x,this.vy+=d-this.y}this.vx+=t.spring.vx(this.x,this.originX,t),this.vy+=t.spring.vy(this.y,this.originY,t),this.vx*=t.friction.vx(this.x,this.originX,t),this.vy*=t.friction.vy(this.x,this.originX,t),this.x+=this.vx,this.y+=this.vy}render(e){e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI),e.fillStyle=this.c,e.fill(),e.closePath()}},V,Se,Ee,et;const vi={settings:{name:"arrow"},init(i){Se=new Ti(150,150),V=new K(i),Ee=new E(100,100,20,"#eebe0a"),et=new h},render(i){Ee.set(V.x,V.y),Ee.render(i),Se.ratateTo(V),Se.draw(i)},destroy(){et.destroy(),V.destroy()}};let Ti=class{constructor(e=0,t=0,s="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=e,this.y=t,this.color=s,this.rotation=0}ratateTo({x:e,y:t}){let s=e-this.x,n=t-this.y;this.rotation=Math.atan2(n,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}},Q={x:0,y:0},I={x:0,y:0},x;const _i={settings:{name:"distance"},init(i,e){x=new K(i),Q.x=Math.random()*e.width,Q.y=Math.random()*e.height,I.x=Math.random()*e.width,I.y=Math.random()*e.height},render(i){i.fillStyle="#000000",i.fillRect(Q.x-2,Q.y-2,4,4),i.fillStyle="#ff0000",i.fillRect(I.x-2,I.y-2,4,4),i.font="30px Arial",i.fillText(`points distance: ${tt(Q,I)}`,10,100),i.fillText(`mouse distance: ${tt(x,I)}`,10,130),i.beginPath(),i.moveTo(I.x,I.y),i.lineTo(x.x,x.y),i.closePath(),i.stroke()},destroy(){x.destroy()}};function tt(i,e){let t=i.x-e.x,s=i.y-e.y;return Math.sqrt(t*t+s*s).toFixed(2)}class b{constructor(e=100,t=100,s=20,n="#ff0000"){o(this,"x",200);o(this,"y",100);o(this,"scaleX",1);o(this,"scaleY",1);o(this,"lineWidth",1);o(this,"color","");o(this,"radius",10);o(this,"rotation",0);this.x=e,this.y=t,this.color=n,this.radius=s}ratateTo({x:e,y:t}){let s=e-this.x,n=t-this.y;this.rotation=Math.atan2(n,s)}render(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY),e.lineWidth=this.lineWidth,e.fillStyle=this.color,e.beginPath(),e.arc(0,0,this.radius,0,Math.PI*2,!0),e.closePath(),e.fill(),this.lineWidth>0&&e.stroke(),e.restore()}}let $,B={angle:0,centrY:200,range:50,xspeed:3,yspeed:.05},ce,L={angle:0,centryScale:1,range:.5,speed:.1},we,w={angleX:0,angleY:0,range:150,centerX:0,centerY:0,xspeed:.07,yspeed:.11};const bi={settings:{name:"liner"},init(i,e){$=new b(0,0),ce=new b(e.width/2,e.height/2,30,"#00ff00"),we=new b(e.width/2,e.height/2,30,"#0000ff"),w.centerX=e.width/2,w.centerY=e.height/2},render(i,e){return B.angle+=B.yspeed,$.x+=B.xspeed,$.y=B.centrY/2+Math.sin(B.angle)*B.range,$.x>e.width+$.radius&&($.x=-$.radius,B.range+=1),ce.scaleX=L.centryScale+Math.sin(L.angle)*L.range,ce.scaleY=L.centryScale+Math.sin(L.angle)*L.range,L.angle+=L.speed,we.x=w.centerX+Math.sin(w.angleX)*w.range,we.y=w.centerY+Math.sin(w.angleY)*w.range,w.angleX+=w.xspeed,w.angleY+=w.yspeed,w.range+=.01,ce.render(i),$.render(i),we.render(i),()=>{}},destroy(){}};let A,q,ee=0,it=0,st=0,nt=100,Mi=.02;const ki={settings:{name:"circle"},init(i,e){A=new b(200,200,40,"#11bbff"),q=new b(200,200,20,"#00ffff"),it=e.width/2,st=e.height/2},render(i){ee+=Mi,A.x=it+Math.sin(ee)*nt,A.y=st+Math.cos(ee)*nt,q.x=A.x+Math.sin(ee*2)*100,q.y=A.y+Math.cos(ee*2)*40,A.y-q.y>0?(q.render(i),A.render(i)):(A.render(i),q.render(i))},destroy(){}};let Ie,$e,ge,ve,Le,v=40,W=0;const Pi={settings:{name:"waves"},init(i,e){Ie=new b(e.width/2,e.height/2,v,"#ffee00"),$e=new b(e.width/2,e.height/2,v,"#00ff00"),ge=new b(e.width/2,e.height/2,v,"#0000ff"),ve=new b(e.width/2,e.height/2,v,"#f0f0f0"),Le=new b(e.width/2,e.height/2,v)},render(i,e){W+=.03;let t=e.width/2,s=e.height/2;Ie.x=t+Math.sin(W*.2)*(t-v),$e.y=s+Math.sin(W*.3)*(s-v),ge.y=s+Math.sin(W*.4)*(s-v),ge.x=t+Math.sin(W)*(t-v),ve.y=s+Math.sin(W*.5)*(s-v),ve.x=t+Math.cos(W*.2)*(t-v),Le.x=t+Math.sin(W*2)*(t-v),Ie.render(i),$e.render(i),ge.render(i),ve.render(i),Le.render(i)},destroy(){}},Si=[_i,ki,bi,Pi,vi],Ei={name:"chapter 3",expamples:Si};let te,Ae,ie,Ii={friction:Wi(),spring:Ai()};const $i={settings:{name:"balls_2"},init:(i,e)=>{te=new K(i),Ae=Li(5e3,e),ie=new E(100,100,20,"#eebe0a")},render:(i,e)=>{ie.set(te.x,te.y),ie.render(i),Ae.forEach(t=>{t.think(ie,{...e,...Ii}),t.render(i)})},destroy(){te.destroy(),te=void 0,Ae=void 0,ie=void 0}};function Li(i,e){let t=[],s=e.width/10,n=e.height/10;for(let r=0;r<i;r++){let a=s+Math.random()*(e.width-s*2),l=n+Math.random()*(e.height-n*2);t.push(new E(a,l,a>e.width/2?2:3,a>e.width/2?"#00bcd4":"#bdb76b"))}return t}function Ai(){let i=0,e=0;return{vx(t,s,n){let r=s>n.width/2?i:e;return-(t-s)*r},vy(t,s,n){let r=s>n.width/2?i:e;return-(t-s)*r}}}function Wi(){let i=.99,e=.4;return{vx(t,s,n){return s>n.width/2?i:e},vy(t,s,n){return s>n.width/2?i:e}}}let se,We,ne,Ci={friction:ji(.5),spring:Ri(.01)};const Di={settings:{name:"balls"},init:(i,e)=>{se=new K(i),We=Bi(5e3,e),ne=new E(100,100,20,"#eebe0a")},render:i=>{ne.set(se.x,se.y),ne.render(i),We.forEach(e=>{e.think(ne,Ci),e.render(i)})},destroy(){se.destroy(),se=void 0,We=void 0,ne=void 0}};function Bi(i,e){let t=[],s=e.width/10,n=e.height/10;for(let r=0;r<i;r++){let a=s+Math.random()*(e.width-s*2),l=n+Math.random()*(e.height-n*2);t.push(new E(a,l,2,"#ff0000"))}return t}function Ri(i){return{vx(e,t){return-(e-t)*i},vy(e,t){return-(e-t)*i}}}function ji(i){return{vx(){return i},vy(){return i}}}let oe,Ce,re,Oi={friction:Qi(.8),spring:Vi(.007)};const Ni={settings:{name:"p_dor"},init:i=>{oe=new K(i),Ce=Hi().map(e=>(e.set(100+Math.random()*500,100+Math.random()*400),e)),re=new E(100,100,20,"#eebe0a")},render:i=>{re.set(oe.x,oe.y),re.render(i),Ce.forEach(e=>{e.think(re,Oi),e.render(i)})},destroy(){oe.destroy(),oe=void 0,Ce=void 0,re=void 0}},Xi="#ff0000",Yi=2,p=(i,e,t=Xi)=>new E(i,e,Yi,t),f=20;function Hi(){return[...qi(),...zi(),...Fi(),...Ui(),...Gi(),...Ki(),...Ji()]}function qi(){return[...g(200,250,f,i=>p(i,100)),...g(100,150,f,i=>p(225,i))]}function zi(){return[...g(100,150,f,i=>p(270,i)),...ye(270,135,f),...g(100,150,f,i=>p(310,i))]}function Fi(){return[...g(170,220,f,i=>p(150,i)),...g(150,170,f,i=>p(i,170)),...g(170,220,f,i=>p(170,i))]}function Ui(){return[...g(170,220,f,i=>p(190,i)),...Zi(190,220,f),...g(170,220,f,i=>p(230,i))]}function Gi(){return[...g(170,220,f,i=>p(260,i)),...ye(260,195,f,25)]}function Ki(){return[...ye(325,185,f,15,1),...g(180,210,f,i=>p(310,i)),...g(180,210,f,i=>p(340,i)),...ye(325,205,f,15,2)]}function Ji(){return[...g(170,220,f,i=>p(370,i)),...ye(370,185,f,15,1.5)]}function ye(i,e,t,s=15,n=1.5){let r=[];for(var a=0;a<=t;a++)r.push(p(i+s*Math.cos(Math.PI*a/t+Math.PI*n),e+s*Math.sin(Math.PI*a/t+Math.PI*n)));return r}function Zi(i,e,t){let s=[];for(var n=0;n<t;n++)s.push(p(i+2*n,e-2.5*n));return s}function g(i,e,t,s){let n=e-i,r=Math.trunc(n/(t-1)),a=[];for(let l=i;l<=e;l+=r)a.push(s(l));return a}function Vi(i){return{vx(e,t){return-(e-t)*i},vy(e,t){return-(e-t)*i}}}function Qi(i){return{vx(){return i},vy(){return i}}}let De,ae,z,xi={friction:ss(.99),spring:is(0)};const es={settings:{name:"balls_touch"},init:(i,e)=>{z=new zt(i),De=ts(2e3,e),ae=new E(e.width/2,e.height/2,30,"#eebe0a")},render:i=>{z.pressed&&ae.set(z.x,z.y),ae.render(i),De.forEach(e=>{e.think(ae,xi),e.render(i)})},destroy(){z.destroy(),z=void 0,De=void 0,ae=void 0}};function ts(i,e){let t=[],s=e.width/20,n=e.height/20;for(let r=0;r<i;r++){let a=s+Math.random()*(e.width-s*2),l=n+Math.random()*(e.height-n*2);t.push(new E(a,l,2,"#00bcd4"))}return t}function is(i){return{vx(e,t){return-(e-t)*i},vy(e,t){return-(e-t)*i}}}function ss(i){return{vx(){return i},vy(){return i}}}const ns=[Di,$i,Ni,es],os={name:"chapter_2",expamples:ns};let ot;const rs={settings:{name:"curves",injectors:[X]},init(i,e){ot=new as(e.injectors.mouse,e)},render(i){ot.draw(i)},destroy(){}};let as=class{constructor(e,t){o(this,"points",[]);o(this,"point",{x0:0,y0:0,x1:0,y1:0});o(this,"mouse");this.mouse=e,this.points=fe(20,()=>({x:Math.random()*t.width,y:Math.random()*t.height})),this.point={x0:Math.random()*t.width,y0:Math.random()*t.height,x1:Math.random()*t.width,y1:Math.random()*t.height}}draw(e){e.beginPath(),e.strokeStyle="#00ff00",e.lineWidth=10,e.lineCap="butt",e.lineJoin="round",e.miterLimit=20,e.moveTo(this.point.x0,this.point.y0),e.quadraticCurveTo(this.mouse.x,this.mouse.y,this.point.x1,this.point.y1),e.stroke(),e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10,e.moveTo(this.points[0].x,this.points[0].y);for(let t=1;t<this.points.length-1;t+=2)e.quadraticCurveTo(this.points[t].x,this.points[t].y,this.points[t+1].x,this.points[t+1].y);e.stroke()}},rt={x:100,y:100},at={x:200,y:200},Be={x:350,y:150,r:0},Re={x:350,y:150,r:50};const ls={settings:{name:"gradient"},init(){},render(i){let e=i.createLinearGradient(rt.x,rt.y,at.x,at.y);e.addColorStop(0,"#ffffff"),e.addColorStop(.5,"#0000ff"),e.addColorStop(1,"#ff0000"),i.fillStyle=e,i.fillRect(100,100,200,200);let t=i.createRadialGradient(Be.x,Be.y,Be.r,Re.x,Re.y,Re.r);t.addColorStop(0,"#000000"),t.addColorStop(1,"rgba(0, 0, 0, 0)"),i.fillStyle=t,i.fillRect(300,100,100,100)},destroy(){}};let le={status:"new",data:new Image},lt,ht;const hs={settings:{name:"image"},init(){le.data.src="./vovka.png",le.data.onload=()=>{le.status="ready"},lt=document.getElementById("picture"),ht=document.getElementById("video")},render(i){le.status==="ready"&&i.drawImage(le.data,80,0,135,135,90,90,65,65),i.drawImage(lt,230,20,80,140,200,130,100,120),i.drawImage(ht,300,150,100,100)},destroy(){}};let dt;const ds={settings:{name:"line",injectors:[X]},init(i,e){dt=new ys(e.injectors.mouse)},render(i){return dt.draw(i),us},destroy(){}};function us(){}let ys=class{constructor(e){o(this,"mouse");o(this,"prevPos");this.mouse=e}draw(e){M(this.prevPos)&&this.mouse.leftButtonDown?(e.strokeStyle="#ff0000",e.lineWidth=2,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.beginPath(),e.moveTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos()):!M(this.prevPos)&&this.mouse.leftButtonDown?(e.lineTo(this.mouse.x,this.mouse.y),this.prevPos=this.mouse.copyPos(),e.stroke()):!M(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},ut;const fs={settings:{name:"multi_curves",injectors:[X]},init(i,e){ut=new ms(e.injectors.mouse,e)},render(i){ut.draw(i)},destroy(){}};let ms=class{constructor(e,t){o(this,"count",10);o(this,"mouse");o(this,"points",[]);o(this,"ctrlPoint",{});this.mouse=e,this.points=fe(this.count,()=>({x:Math.random()*t.width,y:Math.random()*t.height}))}draw(e){e.beginPath(),e.strokeStyle="#ff0000",e.lineWidth=5,e.lineCap="butt",e.lineJoin="round",e.miterLimit=10;let t=(this.points[0].x+this.points[this.count-1].x)/2,s=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(t,s);let n;for(n=1;n<this.points.length-2;n++){let r=(this.points[n].x+this.points[n+1].x)/2,a=(this.points[n].y+this.points[n+1].y)/2;e.quadraticCurveTo(this.points[n].x,this.points[n].y,r,a)}e.quadraticCurveTo(this.points[n].x,this.points[n].y,t,s),e.stroke(),e.beginPath(),e.strokeStyle="#0000ff",e.lineWidth=3,e.arc(100,200,40,0,Math.PI*2,!0),e.closePath(),e.stroke(),e.beginPath(),e.strokeStyle="#00ff44",e.lineWidth=5,e.moveTo(200,200),e.arcTo(200,50,150,200,20),e.stroke()}};class ps{static colorToRGB(e,t=1){let s;typeof e=="string"&&e[0]==="#"&&(s=parseInt(e.slice(1),16));var n=s>>16&255,r=s>>8&255,a=s&255,l=t<0?0:t>1?1:t;return l===1?`rgb(${n},${r},${a})`:`rgb(${n},${r},${a},${l})`}static parse(e,t=!1){return t===!0?typeof e=="number"?e|0:(typeof e=="string"&&e[0]==="#"&&(e=e.slice(1)),parseInt(e,16)):(typeof e=="number"&&(e="#"+("00000"+(e|0).toString(16)).substr(-6)),e)}}let yt,ft;const cs={settings:{name:"pixel",injectors:[X]},init(i,e,t){ft=t.getImageData(0,0,e.width,e.height),yt=new gs(e.injectors.mouse)},render(i){return yt.draw(i,ft),ws},destroy(){}};function ws(){}let gs=class{constructor(e){o(this,"mouse");o(this,"prevPos");o(this,"brush_size",25);o(this,"brush_density",50);o(this,"brush_color",0);this.mouse=e}draw(e,t){let s=t.data;if(M(this.prevPos)&&this.mouse.leftButtonDown)this.brush_color=ps.parse(Math.random()*16777215,!0),this.prevPos=this.mouse.copyPos();else if(!M(this.prevPos)&&this.mouse.leftButtonDown){for(let n=0;n<this.brush_density;n++){let r=Math.random()*Math.PI*2,a=Math.random()*this.brush_size,l=this.mouse.x+Math.cos(r)*a|0,d=this.mouse.y+Math.sin(r)*a|0,m=(l+d*t.width)*4;s[m]=this.brush_color>>16&255,s[m+1]=this.brush_color>>8&255,s[m+2]=this.brush_color&255,s[m+3]=255}e.putImageData(t,0,0),this.prevPos=this.mouse.copyPos()}else!M(this.prevPos)&&!this.mouse.leftButtonDown&&(this.prevPos=null)}},mt;const vs={settings:{name:"shapes",injectors:[X]},init(i,e){mt=new Ts(e.injectors.mouse,e)},render(i){mt.draw(i)},destroy(){}};class Ts{constructor(e,t){o(this,"count",10);o(this,"mouse");o(this,"points",[]);o(this,"ctrlPoint",{});this.mouse=e,this.points=fe(this.count,()=>({x:Math.random()*t.width,y:Math.random()*t.height}))}draw(e){e.beginPath(),e.fillStyle="#ff0000";let t=(this.points[0].x+this.points[this.count-1].x)/2,s=(this.points[0].y+this.points[this.count-1].y)/2;e.moveTo(t,s);let n;for(n=1;n<this.points.length-2;n++){let r=(this.points[n].x+this.points[n+1].x)/2,a=(this.points[n].y+this.points[n+1].y)/2;e.quadraticCurveTo(this.points[n].x,this.points[n].y,r,a)}e.quadraticCurveTo(this.points[n].x,this.points[n].y,t,s),e.fill(),e.beginPath(),e.fillStyle="#00ff44",e.moveTo(100,100),e.arcTo(200,50,150,200,20),e.fill()}}const _s={name:"chapter 4",expamples:[cs,hs,ls,vs,fs,rs,ds]};let he,C,S=0;const bs={settings:{name:"acceleration",injectors:[X,me]},init(i,e){C=new Ms(e.width/2,e.height/2),S=0,he=e.injectors.keyboard},render(i){he.pressed(G.ArrowLeft)&&(C.rotation-=2*Math.PI/180),he.pressed(G.ArrowRight)&&(C.rotation+=2*Math.PI/180),he.pressed(G.ArrowUp)&&S<4&&(S+=.2),he.pressed(G.ArrowDown)&&(S-=.2),S<0?S=0:S-=.05;let e=Math.cos(C.rotation)*S,t=Math.sin(C.rotation)*S;C.x+=e,C.y+=t,C.draw(i)},destroy(){}};let Ms=class{constructor(e=0,t=0,s="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=e,this.y=t,this.color=s,this.rotation=0}ratateTo({x:e,y:t}){let s=e-this.x,n=t-this.y;this.rotation=Math.atan2(n,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}};class ks{constructor(e=0,t=0,s="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=e,this.y=t,this.color=s,this.rotation=0}ratateTo({x:e,y:t}){let s=e-this.x,n=t-this.y;this.rotation=Math.atan2(n,s)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.lineWidth=2,e.fillStyle=this.color,e.strokeStyle="#000000",e.beginPath(),e.moveTo(-50,-25),e.lineTo(0,-25),e.lineTo(0,-50),e.lineTo(50,0),e.lineTo(0,50),e.lineTo(0,25),e.lineTo(-50,25),e.lineTo(-50,-25),e.closePath(),e.fill(),e.stroke(),e.restore()}}let je,R,Oe=.05,pt=0,ct=0;const Ps={settings:{name:"mouse_1",injectors:[X,me]},init(i,e){R=new ks(e.width/2,e.height/2),Oe=.05,je=e.injectors.mouse},render(i){let e=je.x-R.x,t=je.y-R.y,s=Math.atan2(t,e),n=Math.cos(s)*Oe,r=Math.sin(s)*Oe;R.rotation=s,pt+=n,ct+=r,R.x+=pt,R.y+=ct,R.draw(i)},destroy(){}},Ss={name:"chapter 5",expamples:[Ps,bs]},Es=50,de=10;let F,ue=[];const Is={settings:{name:"removal"},init(i,e){F=wt(e),ue=gt(F)},render(i){ue=$s(ue,F),ue.forEach(e=>{e.think(),e.render(i)}),F.render(i)},destroy(){},resize(i,e){F=wt(e),ue=gt(F)}};function $s(i,e){return i.filter(t=>!(t.x-t.radius>e.right||t.x+t.radius<e.x||t.y-t.radius>e.bottom||t.y+t.radius<e.y))}function wt(i){return new N(100,100,i.width-200,i.height-200,"#00ff00")}function gt(i){return fe(Es,()=>new _t(de+i.x+Math.random()*(i.right-2*de),de+i.y+Math.random()*(i.bottom-2*de),de,"#ff6600",new Ht(Math.random()*2-1,Math.random()*2-1)))}const Ls={name:"chapter 6",expamples:[Is]};Nt([gi,Ls,Ss,_s,Ei,os]);
