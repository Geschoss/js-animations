var zt=Object.defineProperty;var Rt=(r,t,e)=>t in r?zt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var o=(r,t,e)=>(Rt(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();class $t{constructor(t){o(this,"chapters");o(this,"examples");this.chapters=t.getElementById("chapters_menu"),this.examples=t.getElementById("examples_menu")}updateModuleMenu(t,e,i){this.removeChildren(this.examples);let s;t.modules.forEach(n=>{let a=document.createElement("div");a.classList.add("menu__item"),a.innerText=n.id,e.id===n.id&&(s=a,s.classList.add("menu__item_selected")),a.addEventListener("click",()=>{s!==a&&(s&&s.classList.remove("menu__item_selected"),s=a,s.classList.add("menu__item_selected"),i(n.id))}),this.examples.appendChild(a)})}updateChaptersMenu(t,e,i){let s;Object.keys(t).forEach(n=>{let a=t[n],h=document.createElement("div");h.classList.add("menu__item"),h.innerText=a.name,e===a&&(s=h,s.classList.add("menu__item_selected")),h.addEventListener("click",()=>{s!==h&&(s&&s.classList.remove("menu__item_selected"),s=h,s.classList.add("menu__item_selected"),i(n))}),this.chapters.appendChild(h)}),i(e.name)}removeChildren(t){for(;t.lastChild;)t.removeChild(t.lastChild)}}class Bt{constructor(){o(this,"module");o(this,"chapter");let t=new URLSearchParams(window.location.search);this.chapter=t.get("chapter")||"",this.module=t.get("module")||""}setModule(t){this.setSearchParam("module",t)}setChapter(t){this.setSearchParam("chapter",t)}setSearchParam(t,e){let i=new URL(window.location.href);i.searchParams.set(t,e),window.history.pushState("Animations",t,i)}}class Ht{constructor(t){o(this,"chaptersMap");o(this,"currentChapter");o(this,"currentModule");o(this,"dom");o(this,"routing");this.chaptersMap=t.reduce((e,i)=>{if(Object.hasOwn(e,i.name))throw new Error(`Chapter ${i.name} alredy has in list!`);return{...e,[i.name]:i}},{}),this.dom=new $t(document),this.routing=new Bt,this.currentChapter=this.getSelectedChapter(this.routing.chapter),this.dom.updateChaptersMenu(this.chaptersMap,this.currentChapter,this.selectChapter.bind(this))}selectChapter(t){this.routing.setChapter(t),this.currentModule&&(this.currentModule.module.destroy(),this.currentModule=void 0),this.currentChapter=this.chaptersMap[t];const e=this.getSelectedExample(this.routing.module,this.currentChapter);e&&(this.currentModule={id:e.name,module:new e}),this.dom.updateModuleMenu(this.currentChapter,this.currentModule,this.selectModule.bind(this))}selectModule(t){this.routing.setModule(t),this.currentModule&&(this.currentModule.module.destroy(),this.currentModule=void 0);const e=this.currentChapter.modules.find(({name:i})=>i===t);e&&(this.currentModule={id:e.name,module:new e})}getSelectedChapter(t){let e=this.chaptersMap[t];return e??Object.values(this.chaptersMap)[0]}getSelectedExample(t,e){let i=e.modules.find(({name:s})=>s===t);return i??e.modules[0]}}class ot{constructor(t,e){o(this,"name");o(this,"modules");this.name=t,this.modules=e}}class Xt{constructor(t=0,e=0){o(this,"dx");o(this,"dy");this.dx=t,this.dy=e}think(t){t.x+=this.dx,t.y+=this.dy}}class Yt{constructor(t=.3,e=.3){o(this,"vy");o(this,"vx");this.vx=t,this.vy=e}think(t){t.x+=this.vx,t.y+=this.vy}}class N{think(){}}class j{render(t,{x:e,y:i,radius:s,color:n}){t.save(),t.beginPath(),t.arc(e,i,s,0,2*Math.PI),t.fillStyle=n,t.fill(),t.closePath(),t.restore()}}class Nt{render(t,{x:e,y:i,width:s,height:n,color:a}){t.save(),t.strokeStyle=a,t.beginPath(),t.rect(e,i,s,n),t.closePath(),t.stroke(),t.restore()}}let rt=class{constructor(t=0,e=0,i=10,s="#ff6600",n=new N,a=new j){o(this,"x");o(this,"y");o(this,"color");o(this,"radius");o(this,"behavior");o(this,"view");this.x=t,this.y=e,this.color=s,this.radius=i,this.view=a,this.behavior=n}static create({x:t=0,y:e=0,radius:i=10,color:s="#ff6600",view:n=new j,behavior:a=new N}){return new rt(t,e,i,s,a,n)}think(){this.behavior.think(this)}render(t){this.view.render(t,this)}};class f{constructor(t,e){o(this,"x");o(this,"y");this.x=t,this.y=e}static create(t=0,e=0){return new f(t,e)}static from({x:t,y:e}){return new f(t,e)}add(t){return new f(this.x+t.x,this.y+t.y)}left(){this.x-=1}right(){this.x+=1}up(){this.y-=1}down(){this.y+=1}}class H{constructor(t,e,i,s){o(this,"x1");o(this,"x2");o(this,"y1");o(this,"y2");this.x1=t,this.y1=e,this.x2=i,this.y2=s}static create(t,e,i,s){return new H(t,e,t+i-1,e+s-1)}intersect(t){return this.x1<=t.x2&&this.x2>=t.x1&&this.y1<=t.y2&&this.y2>=t.y1}intersect_with_padding(t,e){return this.x1-e<=t.x2&&this.x2+e>=t.x1&&this.y1-e<=t.y2&&this.y2+e>=t.y1}for_each(t){for(let e=this.x1;e<=this.x2;e++)for(let i=this.y1;i<=this.y2;i++)t(f.from({x:e,y:i}))}center(){return new f((this.x1+this.x2)/2,(this.y1+this.y2)/2)}center_trunc(){return new f(Math.trunc((this.x1+this.x2)/2),Math.trunc((this.y1+this.y2)/2))}center_floor(){return new f(Math.floor((this.x1+this.x2)/2),Math.floor((this.y1+this.y2)/2))}cut_by_window(t,e){this.x1=this.x1<1?1:this.x1,this.x2=this.x2>t?t:this.x2,this.y1=this.y1<1?1:this.y1,this.y2=this.y2>e?e:this.y2}}class S{constructor(t=100,e=100,i=200,s=200,n="#ff0000",a=new N,h=new Nt){o(this,"width");o(this,"height");o(this,"y");o(this,"x");o(this,"right");o(this,"bottom");o(this,"color");o(this,"behavior");o(this,"view");this.x=t,this.y=e,this.color=n,this.width=i,this.height=s,this.right=t+i,this.bottom=e+s,this.view=h,this.behavior=a}static create({x:t,y:e,width:i,height:s,color:n,view:a,behavior:h}){return new S(t,e,i,s,n,h,a)}think(){this.behavior.think(this)}render(t){this.view.render(t,this)}}class Ot{constructor(t){o(this,"raw");o(this,"status","new");this.raw=new Image,this.raw.src=t,this.raw.onload=()=>{this.status="ready"},this.raw.onerror=e=>{this.status="error",console.error(e)}}isReady(){return this.status==="ready"}data(){return this.raw}}const W={coin(r,t){return Math.random()>.5?r:t},range(r,t){return Math.trunc(r+Math.random()*(t-r))}};function D(r){return r==null||r==null}function R(r,t){let e=[];for(let i=0;i<r;i++)e.push(t(i,r));return e}function X(r,t){return Math.random()>.5?r:t}var L=(r=>(r[r.Wall=0]="Wall",r[r.Floor=1]="Floor",r))(L||{});class O{constructor(t,e,i,s){o(this,"tiles");o(this,"sectors");o(this,"width",0);o(this,"height",0);this.tiles=t,this.width=i,this.sectors=e,this.height=s}static create(t,e,i){let s=R(e*i,()=>1);return new O(t,s,e,i)}render(t,e,i){for(let s=0;s<this.width;s++)for(let n=0;n<this.height;n++){let a=this.idx(s,n),h=this.sectors[a],l=e.centre.x+(s-e.position.x)*i.tile_dimensions.x,c=e.centre.y+(n-e.position.y)*i.tile_dimensions.y;switch(h){case 1:this.tiles.renderFloor(t,f.from({x:l,y:c}));break}}}can_enter_tile(t){return this.in_bounds(t)&&this.sectors[this.idx(t.x,t.y)]===1}in_bounds(t){return t.x>=0&&t.x<this.width-1&&t.y>=0&&t.y<this.height-1}try_idx(t){if(this.in_bounds(t))return this.idx(t.x,t.y)}idx(t,e){return e*this.width+t}}const Ft=60,K=25,J=5,qt=200;class F{constructor(t,e,i){o(this,"map");o(this,"tiles");o(this,"rooms");o(this,"player_start");this.map=t,this.rooms=e,this.player_start=i}static create(t,e,i){let s=new F(O.create(t,e,i),[],f.create());return s.fill(L.Wall),s.build_random_rooms(e,i),s.build_corridors(),s.player_start=s.rooms[0].center_trunc(),s}fill(t){this.map.sectors=this.map.sectors.map(()=>t)}mock_rooms(t,e){this.rooms=Gt().map(({x1:i,x2:s,y1:n,y2:a})=>new H(i,n,s,a)),this.rooms.forEach(i=>{i.for_each(({x:s,y:n})=>{if(s>0&&s<t-1&&n>0&&n<e-1){let a=this.map.idx(s,n);this.map.sectors[a]=L.Floor}})})}build_random_rooms(t,e){let i=0;for(;this.rooms.length<Ft;){let s=H.create(W.range(-2,t-2),W.range(-2,e-2),W.range(J,K),W.range(J,K));if(s.cut_by_window(t-2,e-2),i+=1,this.rooms.some(a=>a.intersect_with_padding(s,1))||(i=0,s.for_each(({x:a,y:h})=>{let l=this.map.idx(a,h);this.map.sectors[l]=L.Floor}),this.rooms.push(s)),qt<i)break}}apply_horizontal_tunnel(t,e,i){for(let s=Math.min(t,e);s<=Math.max(t,e);s++){let n=this.map.try_idx(f.create(s,i));n&&(this.map.sectors[n]=L.Floor)}}apply_vertical_tunnel(t,e,i){for(let s=Math.min(t,e);s<=Math.max(t,e);s++){let n=this.map.try_idx(f.create(i,s));n&&(this.map.sectors[n]=L.Floor)}}build_corridors(){let t=this.rooms.sort((s,n)=>s.center_trunc().x-n.center_trunc().x),[e,...i]=t;i.forEach(s=>{let n=s.center_trunc(),a=e.center_trunc();W.coin(!0,!1)?(this.apply_horizontal_tunnel(a.x,n.x,a.y),this.apply_vertical_tunnel(a.y,n.y,n.x)):(this.apply_vertical_tunnel(a.y,n.y,a.x),this.apply_horizontal_tunnel(a.x,n.x,n.y)),e=s})}}function Gt(){return[{x1:1,x2:6,y1:9,y2:14},{x1:10,x2:15,y1:3,y2:8},{x1:13,x2:19,y1:17,y2:23}]}class q{constructor(t,e,i,s){o(this,"tiles");o(this,"centre");o(this,"position");o(this,"prevMove");this.tiles=t,this.centre=s,this.position=f.create(e,i),this.prevMove=0}static create(t,e=0,i=0,s){return new q(t,e,i,s)}render(t){this.tiles.isReady()&&this.tiles.renderPlayer(t,this.centre)}update(t,e){let i=new Date().getTime();if(i-this.prevMove>50){this.prevMove=i;let s=this.move(e),n=this.position.add(s);t.can_enter_tile(n)&&(this.position=n)}}move(t){let e=f.from({x:0,y:0});return t.pressed("ArrowLeft")&&e.left(),t.pressed("ArrowRight")&&e.right(),t.pressed("ArrowUp")&&e.up(),t.pressed("ArrowDown")&&e.down(),e}}class G{constructor(t,e,i){o(this,"env");o(this,"size");o(this,"image");this.env=t,this.size=i,this.image=new Ot(e)}static create(t,e,i){return new G(t,e,i)}isReady(){return this.image.isReady()}renderFloor(t,e){t.drawImage(this.image.data(),this.size*2,0,this.size,this.size,e.x,e.y,this.env.tile_dimensions.x,this.env.tile_dimensions.y)}renderWall(t,e){t.drawImage(this.image.data(),this.size*2,this.size*2,this.size,this.size,e.x,e.y,this.env.tile_dimensions.x,this.env.tile_dimensions.y)}renderPlayer(t,e){t.save(),t.fillStyle="#00ff00",t.beginPath(),t.rect(e.x,e.y,this.env.tile_dimensions.x,this.env.tile_dimensions.y),t.closePath(),t.fill(),t.restore()}}class nt{constructor(){o(this,"destroyed",!1);o(this,"cb");o(this,"animationCbId")}tick(t){this.cb=t;const e=i=>{(this.cb||!this.destroyed)&&(this.cb(i),this.animationCbId=requestAnimationFrame(e))};e(0)}destroy(){this.destroyed=!0,this.animationCbId&&cancelAnimationFrame(this.animationCbId)}}class at{constructor(t){o(this,"x",0);o(this,"y",0);o(this,"pressed",!1);o(this,"rect");o(this,"canvas");o(this,"mousedown",t=>{this.pressed=!0});o(this,"mouseup",t=>{this.pressed=!1});o(this,"move",t=>{let e=0,i=0;t.pageX||t.pageY?(e=t.pageX,i=t.pageY):(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),e-=this.canvas.offsetLeft,i-=this.canvas.offsetTop,this.x=e,this.y=i});this.canvas=t,t.addEventListener("mousemove",this.move,!1),t.addEventListener("mousedown",this.mousedown,!1),t.addEventListener("mouseup",this.mouseup,!1)}destroy(){this.canvas.removeEventListener("mousemove",this.move,!1),this.canvas.removeEventListener("mousedown",this.mousedown,!1),this.canvas.removeEventListener("mouseup",this.mouseup,!1)}copyPos(){return{x:this.x,y:this.y}}}class ht{constructor(t=document.body){o(this,"cb");o(this,"resizeFn");this.cb=()=>{},this.resizeFn=()=>{const{offsetWidth:e,offsetHeight:i}=t;this.cb(e,i)},window.addEventListener("resize",this.resizeFn)}changed(t){this.cb=t}destroy(){this.cb=void 0,window.removeEventListener("resize",this.resizeFn),this.resizeFn=void 0}}function V(){return Math.random().toString(16).slice(2)}class Ut{constructor(){o(this,"keys_pressed",[]);o(this,"up_subscribers",[]);o(this,"down_subscribers",[]);o(this,"keydown",t=>{let e=t.code;this.keys_pressed.push(e),this.down_subscribers.forEach(({keys:i,cb:s})=>{(i.length===0||i.includes(e))&&s(e)})});o(this,"keyup",t=>{this.keys_pressed=this.keys_pressed.filter(i=>i!==t.code);let e=t.code;this.up_subscribers.forEach(({keys:i,cb:s})=>{(i.length===0||i.includes(e))&&s(e)})});window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1)}destroy(){window.removeEventListener("keydown",this.keydown,!1),window.removeEventListener("keyup",this.keyup,!1)}pressed(t){return D(t)?this.keys_pressed.length!=0:this.keys_pressed.includes(t)}down(t){let e=V();return this.down_subscribers.push({...t,hash:e}),e}up(t){let e=V();return this.up_subscribers.push({...t,hash:e}),e}}class U{constructor(t,e){o(this,"width");o(this,"height");o(this,"ctx");o(this,"canvas");this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.width,this.canvas.height=this.height,document.body.appendChild(this.canvas)}destroy(){this.ctx=null,this.canvas.remove()}clean(){this.ctx.clearRect(0,0,this.width,this.height)}resize(t,e){this.width=t,this.height=e,this.canvas.width=this.width,this.canvas.height=this.height}}class p{constructor(t={}){o(this,"loop");o(this,"resize");o(this,"keyboard");o(this,"context2d");o(this,"controller");o(this,"env");const{controller:e=at}=t,i=document.body;this.env={width:i.offsetWidth,height:i.offsetHeight},this.loop=new nt,this.resize=new ht(i),this.context2d=new U(i.offsetWidth,i.offsetHeight),this.keyboard=new Ut,this.controller=new e(this.context2d.canvas),this.resize.changed((s,n)=>{this.context2d.resize(s,n)})}tick(t){this.loop.tick(e=>{this.context2d.clean(),t(this.context2d.ctx,this.controller,this.keyboard,e)})}destroy(){this.loop.destroy(),this.resize.destroy(),this.keyboard.destroy(),this.context2d.destroy(),this.controller.destroy(),this.loop=void 0,this.resize=void 0,this.keyboard=void 0,this.context2d=void 0,this.controller=void 0}}const jt="/js-animations/assets/floor_tiles-899c51d6.png",Z=24,v={map:null,camera:null,player:null,tiles:null};class lt{constructor(){o(this,"game2D");this.game2D=new p;const{env:t}=this.game2D,e={x:Z,y:Z};v.tiles=G.create({tile_dimensions:e},jt,32);let i=F.create(v.tiles,100,100);v.map=i.map,v.player=q.create(v.tiles,i.player_start.x,i.player_start.y,f.create(t.width/2,t.height/2)),this.game2D.tick((s,n,a)=>{v.tiles.isReady()&&(v.player.update(v.map,a),v.map.render(s,v.player,{...t,tile_dimensions:e}),v.player.render(s))})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(lt,"id","DungeonCrawl");class dt{constructor(){o(this,"rect");o(this,"velocity");o(this,"keyboard");this.rect=S.create({x:150,y:350,width:50,height:50,color:"#00ff00"}),this.velocity=0}render(t){this.rect.render(t)}think(){this.rect.y+=this.velocity,this.velocity<6&&(this.velocity+=.2)}collision(t,e){return this.rect.color="#00ff00",e.y>this.rect.y||e.bottom<this.rect.y+this.rect.width?!0:t.some(i=>i.collision(this.rect))}}const d=class{constructor(t,e,i,s=0){o(this,"top");o(this,"bottom");o(this,"x");o(this,"y");o(this,"behavior");this.x=t,this.y=e,this.behavior=new Xt(d.SPEED-s/10);let n=d.GAP-s;this.top=S.create({x:t,y:e,width:d.WIDTH,height:d.MIN_HEIGHT+Math.random()*(i-(n+d.MIN_HEIGHT))}),this.bottom=S.create({x:this.top.x,y:this.top.bottom+n,width:d.WIDTH,height:i-this.top.height-n})}think(){this.behavior.think(this),this.top.x=this.x,this.bottom.x=this.x}render(t){this.top.render(t),this.bottom.render(t)}collision(t){let e={x:t.x,y:t.y},i={x:t.x+t.width,y:t.y},s={x:t.x,y:t.y+t.height},n={x:t.x+t.width,y:t.y+t.height},a={x:this.top.x,y:this.top.y+this.top.height},h={x:this.top.x+d.WIDTH,y:this.top.y+this.top.height},l={x:this.bottom.x,y:this.bottom.y},c={x:this.bottom.x+d.WIDTH,y:this.bottom.y};return i.x<this.x||this.x+d.WIDTH<t.x?!1:!!(E(a.x,i.x,h.x)&&E(this.y,i.y,a.y)||E(a.x,e.x,h.x)&&E(this.y,e.y,a.y)||E(l.x,n.x,c.x)&&l.y<n.y||E(l.x,s.x,c.x)&&l.y<s.y)}static create(t){let e=[],i=t.width,s=t.y,n=t.height,a=t.width/(d.WIDTH+d.DISTANCE_BEETWEN)+1;for(let h=0;h<a;h++)e.push(new d(i,s,n)),i+=d.WIDTH+d.DISTANCE_BEETWEN;return e}static move(t,e,i){let s=t[0],n=t[t.length-1],a=e.x-d.WIDTH;if(s.x<a){t.shift();let h=e.y,l=e.height;return t.push(new d(n.x+d.WIDTH+d.DISTANCE_BEETWEN,h,l,i)),!0}return!1}};let w=d;o(w,"GAP",290),o(w,"WIDTH",50),o(w,"MIN_HEIGHT",10),o(w,"DISTANCE_BEETWEN",290),o(w,"SPEED",-4);function E(r,t,e){return r<t&&t<e}class ut{constructor(){o(this,"state");o(this,"game2D");this.game2D=new p;const t=this.game2D.env;this.state={type:"init",bird:null,screen:Zt(t),pipes:[],score:0},this.game2D.tick((e,i,s)=>{switch(this.state.screen.render(e),this.state.type){case"init":Kt(this.state,t,e,s);break;case"play":Jt(this.state,t,e,s);break;case"dead":Vt(this.state,t,e,s);break}})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(ut,"id","FlappyBird");function Kt(r,t,e,i){e.font="30px Arial",e.fillStyle="#0000ff",e.fillText("Press ENTER to start",t.width/2-150,t.height/2),i.pressed("Enter")&&(r.type="play",r.bird=new dt,r.pipes=w.create(r.screen),r.score=0)}function Jt(r,t,e,i){if(ct(r,t,e),i.pressed("Space")&&(r.bird.velocity=-6),r.bird.think(),r.bird.collision(r.pipes,r.screen)){r.type="dead";return}r.bird.render(e),r.pipes.forEach(s=>{s.think(),s.render(e)}),w.move(r.pipes,r.screen,r.score)&&(r.score+=1)}function Vt(r,t,e,i){ct(r,t,e),e.font="30px Arial",e.fillStyle="#0000ff",e.fillText("You are dead",t.width/2-100,t.height/2-30),e.fillText("Press ENTER to start",t.width/2-150,t.height/2),i.pressed("Enter")&&(r.type="play",r.bird=new dt,r.pipes=w.create(r.screen),r.score=0)}function Zt(r){let t=r.width*5/100,e=r.height*10/100;return new S(t,e,r.width-2*t,r.height-2*e,"#0000ff")}function ct(r,t,e){e.font="35px Arial",e.fillStyle="#0000ff",e.fillText(`Score: ${r.score}`,t.width/2-70,150)}class Qt{constructor(){o(this,"vr",0);o(this,"vx",0);o(this,"vy",0);o(this,"trust",0);o(this,"gravity",.01);o(this,"rotation",0)}left(){this.vr=-3}rigth(){this.vr=3}up(){this.trust=.05}forward(){this.vr=0}stop(){this.trust=0}calculate(){this.rotation+=this.vr*Math.PI/180;let t=Math.cos(this.rotation)*this.trust,e=Math.sin(this.rotation)*this.trust;return this.vx+=t,this.vy+=e,this.vx+=this.vx>0?-this.gravity:this.gravity,this.vy+=this.vy>0?-this.gravity:this.gravity,{vx:this.vx,vy:this.vy,rotation:this.rotation}}}class xt{constructor(t,e,i=0,s=0,n,a){o(this,"x");o(this,"y");o(this,"width");o(this,"height");o(this,"rotation");o(this,"moving");o(this,"keyboard");o(this,"acceleration");o(this,"weapon");o(this,"view");this.x=i,this.y=s,this.width=25,this.height=20,this.rotation=0,this.keyboard=t,this.moving=!1,this.acceleration=e,this.weapon=n,this.view=new a(n),this.keyboard.up({keys:["ArrowUp","ArrowLeft","ArrowRight"],cb:h=>{if(h==="ArrowUp"){this.moving=!1,this.acceleration.stop();return}this.acceleration.forward()}})}changeChip(t){this.view=new t(this.weapon)}cnahgeWeapon(t){this.view.changeWeapon(t)}shot(t){const e=this.view.shot(this);e&&t.bullets.push(...e)}think(t){this.keyboard.pressed("Space")&&this.shot(t),this.keyboard.pressed("ArrowLeft")&&this.acceleration.left(),this.keyboard.pressed("ArrowRight")&&this.acceleration.rigth(),this.keyboard.pressed("ArrowUp")&&(this.acceleration.up(),this.moving=!0);let{vx:e,vy:i,rotation:s}=this.acceleration.calculate();this.rotation=s,this.x+=e,this.y+=i}render(t){this.view.render(t,this)}}class te{constructor(t){o(this,"name","classic");o(this,"weapon_name");o(this,"weapon");const e=new t;this.weapon_name=e.name,this.weapon=new t}changeWeapon(t){const e=new t;this.weapon_name=e.name,this.weapon=new t}shot(t){const e=this.weapon.shot({x:t.x,y:t.y,rotation:t.rotation});if(e)return[e]}render(t,e){if(t.save(),t.translate(e.x,e.y),t.rotate(e.rotation),t.lineWidth=1,t.strokeStyle="#ff0000",t.beginPath(),t.moveTo(10,0),t.lineTo(-10,10),t.lineTo(-5,0),t.lineTo(-10,-10),t.lineTo(10,0),t.stroke(),e.moving){let i=Math.random()>.5?17:15;t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-7.5,-5),t.lineTo(-i,0),t.lineTo(-7.5,5),t.stroke()}t.restore()}}class ee{constructor(t){o(this,"name","эх-100");o(this,"weapon_name");o(this,"weapons");const e=new t;this.weapon_name=e.name,this.weapons=[e,new t]}changeWeapon(t){const e=new t;this.weapon_name=e.name,this.weapons=[e,new t]}shot(t){const s=this.weapons[0].shot({x:t.x+15*Math.cos(t.rotation+Math.PI*1.88),y:t.y+15*Math.sin(t.rotation+Math.PI*1.88),rotation:t.rotation}),n=.12,a=this.weapons[1].shot({x:t.x+15*Math.cos(t.rotation+Math.PI*n),y:t.y+15*Math.sin(t.rotation+Math.PI*n),rotation:t.rotation});let h=[];return s&&h.push(s),a&&h.push(a),h.length>0?h:void 0}render(t,e){t.save(),t.translate(e.x,e.y),t.rotate(e.rotation),t.lineWidth=1,t.strokeStyle="#ff0000",t.beginPath(),t.moveTo(15,10),t.lineTo(10,10),t.lineTo(10,5),t.lineTo(-10,5),t.lineTo(-10,10),t.lineTo(-15,10),t.lineTo(-15,-10),t.lineTo(-10,-10),t.lineTo(-10,-5),t.lineTo(-10,-5),t.lineTo(10,-5),t.lineTo(10,-10),t.lineTo(15,-10),t.stroke(),t.beginPath(),t.moveTo(15,10),t.quadraticCurveTo(30,0,15,-10),t.stroke(),e.moving&&(t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-15,-10),t.lineTo(-Q(25,22),-5),t.lineTo(-15,0),t.stroke(),t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-15,10),t.lineTo(-Q(25,22),5),t.lineTo(-15,0),t.stroke()),t.restore()}}function Q(r,t){return Math.random()>.5?r:t}class ie{constructor(t){o(this,"name","еф-100");o(this,"weapon_name");o(this,"weapons");const e=new t;this.weapon_name=e.name,this.weapons=[e,new t]}changeWeapon(t){const e=new t;this.weapon_name=e.name,this.weapons=[e,new t]}shot(t){const s=this.weapons[0].shot({x:t.x+17*Math.cos(t.rotation+Math.PI*1.88),y:t.y+17*Math.sin(t.rotation+Math.PI*1.88),rotation:t.rotation}),n=.12,a=this.weapons[1].shot({x:t.x+17*Math.cos(t.rotation+Math.PI*n),y:t.y+17*Math.sin(t.rotation+Math.PI*n),rotation:t.rotation});let h=[];return s&&h.push(s),a&&h.push(a),h.length>0?h:void 0}render(t,e){t.save(),t.translate(e.x,e.y),t.rotate(e.rotation),t.strokeStyle="#ff0000",t.beginPath(),t.arc(0,0,15,0,2*Math.PI),t.stroke(),t.closePath(),t.beginPath(),t.arc(0,0,5,0,2*Math.PI),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(3,15),t.quadraticCurveTo(5,22,10,21),t.stroke(),t.beginPath(),t.moveTo(8,13),t.quadraticCurveTo(10,18,15,17),t.stroke(),t.beginPath(),t.moveTo(15,17),t.lineTo(20,17),t.stroke(),t.beginPath(),t.moveTo(10,21),t.lineTo(20,21),t.stroke(),t.beginPath(),t.moveTo(20,21),t.lineTo(20,17),t.stroke(),t.beginPath(),t.moveTo(20,21),t.lineTo(24,19),t.stroke(),t.beginPath(),t.moveTo(20,17),t.lineTo(24,18),t.stroke(),t.beginPath(),t.moveTo(13,7),t.lineTo(30,3),t.stroke(),t.beginPath(),t.moveTo(15,2),t.lineTo(30,2),t.stroke(),t.beginPath(),t.moveTo(13,-7),t.lineTo(30,-3),t.stroke(),t.beginPath(),t.moveTo(15,-2),t.lineTo(30,-2),t.stroke(),t.beginPath(),t.moveTo(15,0),t.lineTo(5,0),t.stroke(),t.beginPath(),t.moveTo(0,15),t.lineTo(0,5),t.stroke(),t.beginPath(),t.moveTo(0,-15),t.lineTo(0,-5),t.stroke(),t.beginPath(),t.moveTo(-15,0),t.lineTo(-5,0),t.stroke(),t.beginPath(),t.moveTo(4,4),t.lineTo(11,11),t.stroke(),t.beginPath(),t.moveTo(4,-4),t.lineTo(11,-11),t.stroke(),t.beginPath(),t.moveTo(-4,-4),t.lineTo(-11,-11),t.stroke(),t.beginPath(),t.moveTo(-4,4),t.lineTo(-11,11),t.stroke(),e.moving&&(t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-10,-12),t.lineTo(-$(21,19),-11),t.lineTo(-14,-7),t.stroke(),t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-12,-7),t.lineTo(-$(22,20),-4),t.lineTo(-14,0),t.stroke(),t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-12,7),t.lineTo(-$(22,20),4),t.lineTo(-14,0),t.stroke(),t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-14,7),t.lineTo(-$(21,19),11),t.lineTo(-10,12),t.stroke()),t.restore()}}function $(r,t){return Math.random()>.5?r:t}class se{constructor(t){o(this,"name","т-50");o(this,"weapon_name");o(this,"weapons");const e=new t;this.weapon_name=e.name,this.weapons=[e,new t]}changeWeapon(t){const e=new t;this.weapon_name=e.name,this.weapons=[e,new t]}shot(t){const i=[],n=this.weapons[0].shot({x:t.x+10*Math.cos(t.rotation+Math.PI*1.5),y:t.y+10*Math.sin(t.rotation+Math.PI*1.5),rotation:t.rotation});n&&i.push(n);const a=.5,h=this.weapons[1].shot({x:t.x+10*Math.cos(t.rotation+Math.PI*a),y:t.y+10*Math.sin(t.rotation+Math.PI*a),rotation:t.rotation});return h&&i.push(h),i.length>0?i:void 0}render(t,e){t.save(),t.translate(e.x,e.y),t.rotate(e.rotation),t.lineWidth=1,t.strokeStyle="#ff0000",t.beginPath(),t.moveTo(20,0),t.lineTo(15,-5),t.lineTo(-15,-5),t.lineTo(-20,-10),t.lineTo(-20,10),t.lineTo(-15,5),t.lineTo(15,5),t.lineTo(20,0),t.stroke(),t.beginPath(),t.moveTo(0,-5),t.lineTo(0,-10),t.lineTo(5,-10),t.lineTo(5,-5),t.stroke(),t.beginPath(),t.moveTo(0,5),t.lineTo(0,10),t.lineTo(5,10),t.lineTo(5,5),t.stroke(),e.moving&&(t.strokeStyle="#ff9200",t.beginPath(),t.moveTo(-20,-10),t.lineTo(-X(30,27),-6),t.lineTo(-20,-2),t.stroke(),t.beginPath(),t.moveTo(-20,10),t.lineTo(-X(30,27),6),t.lineTo(-20,2),t.stroke()),t.restore()}}class oe{constructor(t){o(this,"name","еф-50");o(this,"weapon_name");o(this,"weapons");const e=new t;this.weapon_name=e.name,this.weapons=[e,new t,new t]}changeWeapon(t){const e=new t;this.weapon_name=e.name,this.weapons=[e,new t,new t]}shot(t){const i=[],n=this.weapons[0].shot({x:t.x+15*Math.cos(t.rotation+Math.PI*1.84),y:t.y+15*Math.sin(t.rotation+Math.PI*1.84),rotation:t.rotation-.03});n&&i.push(n);const a=.16,h=this.weapons[1].shot({x:t.x+15*Math.cos(t.rotation+Math.PI*a),y:t.y+15*Math.sin(t.rotation+Math.PI*a),rotation:t.rotation+.03});h&&i.push(h);const l=0,c=this.weapons[2].shot({x:t.x+15*Math.cos(t.rotation+Math.PI*l),y:t.y+15*Math.sin(t.rotation+Math.PI*l),rotation:t.rotation});return c&&i.push(c),i.length>0?i:void 0}render(t,e){t.save(),t.translate(e.x,e.y),t.rotate(e.rotation),t.lineWidth=1,t.strokeStyle="#ff0000",t.beginPath(),t.moveTo(20,0),t.lineTo(15,-10),t.lineTo(-15,-15),t.lineTo(-10,0),t.lineTo(-15,15),t.lineTo(15,10),t.lineTo(20,0),t.stroke(),t.beginPath(),t.moveTo(15,-10),t.quadraticCurveTo(8,0,15,10),t.stroke(),t.beginPath(),t.moveTo(-12,-2),t.lineTo(-20,-2),t.lineTo(-20,-9),t.lineTo(-14,-9),t.stroke(),t.beginPath(),t.moveTo(-12,2),t.lineTo(-20,2),t.lineTo(-20,9),t.lineTo(-14,9),t.stroke(),t.beginPath(),t.moveTo(7,11),t.lineTo(7,15),t.lineTo(14,15),t.stroke(),t.beginPath(),t.moveTo(7,-11),t.lineTo(7,-15),t.lineTo(14,-15),t.stroke(),e.moving&&(t.strokeStyle="#ff9200",t.beginPath(),t.moveTo(-20,-9),t.lineTo(-X(30,27),-6),t.lineTo(-20,-2),t.stroke(),t.beginPath(),t.moveTo(-20,9),t.lineTo(-X(30,27),6),t.lineTo(-20,2),t.stroke()),t.restore()}}class re{constructor(){o(this,"name","Рокетница");o(this,"rate");o(this,"prevShotTime");this.rate=1,this.prevShotTime=0}shot(t){let e=new Date().getTime();if(e-this.prevShotTime>1e3/this.rate)return this.prevShotTime=e,new ne(t.x,t.y,t.rotation)}}class ne{constructor(t=0,e=0,i=0,s=0,n=.04){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");o(this,"acceleration");o(this,"max_speed");this.x=t+5*Math.cos(i),this.y=e+5*Math.sin(i),this.speed=s,this.rotation=i,this.acceleration=n,this.max_speed=6}think(){this.speed+=this.acceleration,this.speed>=this.max_speed?this.acceleration=0:this.acceleration+=.02,this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.lineWidth=1,t.strokeStyle="#ff0000",t.beginPath(),t.moveTo(8,1),t.lineTo(-8,1),t.lineTo(-8,-1),t.lineTo(8,-1),t.lineTo(8,1),t.stroke(),Math.random()>.1&&(t.beginPath(),t.strokeStyle="#ff9200",t.moveTo(-8,-2),t.lineTo(-12,0),t.lineTo(-8,2),t.stroke()),t.restore()}}class ae{constructor(){o(this,"name","Пулимет");o(this,"rate");o(this,"bulletSpeed");o(this,"prevShotTime");this.rate=10,this.prevShotTime=0,this.bulletSpeed=6}shot(t){let e=new Date().getTime();if(e-this.prevShotTime>1e3/this.rate)return this.prevShotTime=e,new he(t.x,t.y,t.rotation,this.bulletSpeed)}}class he{constructor(t,e,i,s=3){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");this.x=t,this.y=e,this.speed=s,this.rotation=i}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(t){let e=5*Math.cos(this.rotation),i=5*Math.sin(this.rotation);t.save(),t.beginPath(),t.strokeStyle="#ff0000",t.lineWidth=2,t.moveTo(this.x,this.y),t.lineTo(this.x+e,this.y+i),t.closePath(),t.stroke(),t.restore()}}class le{constructor(){o(this,"name","Плазма");o(this,"rate");o(this,"bulletSpeed");o(this,"prevShotTime");this.rate=5,this.prevShotTime=0,this.bulletSpeed=6}shot(t){let e=new Date().getTime();if(e-this.prevShotTime>1e3/this.rate)return this.prevShotTime=e,new de(t.x,t.y,t.rotation,this.bulletSpeed)}}class de{constructor(t,e,i,s=4){o(this,"x");o(this,"y");o(this,"speed");o(this,"rotation");this.x=t,this.y=e,this.speed=s,this.rotation=i}think(){this.x+=this.speed*Math.cos(this.rotation),this.y+=this.speed*Math.sin(this.rotation)}render(t){t.save(),t.beginPath(),t.fillStyle="#00ff00",t.beginPath(),t.arc(this.x,this.y,3,0,2*Math.PI),t.fill(),t.closePath(),t.restore()}}const Y=[oe,se,te,ee,ie],B=[ae,re,le];let k=0,P=0,I={enemies:[],bullets:[]},M;class yt{constructor(){o(this,"game2D");this.game2D=new p;const{env:t,keyboard:e}=this.game2D;let i=new Qt,s=Y[P];M=new xt(e,i,t.width/2,t.height/2,B[k],s),this.game2D.tick((n,a,h)=>{h.pressed("KeyL")&&tt(M,Y,1),h.pressed("Semicolon")&&tt(M,Y,-1),h.pressed("KeyO")&&et(M,1),h.pressed("KeyP")&&et(M,-1),ce(n,t),ye(n,t,M),I.enemies.forEach(l=>{l.think(I),l.render(n)}),I.bullets.forEach(l=>{l.think(I),l.render(n)}),M.think(I),M.render(n),ue(I,t)})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(yt,"id","SpacesShip");function ue(r,t){r.bullets=r.bullets.filter(e=>x(0,t.width,e.x)&&x(0,t.height,e.y))}function x(r,t,e){return e>r&&e<t}function tt(r,t,e){P+=e,P>=t.length&&(P=0),P<0&&(P=t.length-1),r.changeChip(t[P])}function et(r,t){k+=t,k>=B.length&&(k=0),k<0&&(k=B.length-1),r.cnahgeWeapon(B[k])}function ce(r,t){r.save(),r.fillStyle="#ff0000",r.font="20px Arial",r.fillText("Смена корабля: Д или Ж",10,t.height-10),r.fillText("Смена оружия: Щ или З",10,t.height-30),r.fillText("Летать на стрелки",10,t.height-50),r.restore()}function ye(r,t,e){r.save(),r.fillStyle="#ff0000",r.font="20px Arial",r.fillText(`корабль: ${e.view.name}`,10,t.height-80),r.fillText(`оружие: ${e.view.weapon_name}`,10,t.height-100),r.restore()}const fe=new ot("simple_2d_games",[ut,yt,lt]);let b=class{constructor(t=0,e=0,i=0,s="#ff6600"){o(this,"x");o(this,"y");o(this,"r");o(this,"c");o(this,"vx");o(this,"vy");o(this,"originX");o(this,"originY");this.x=t,this.y=e,this.r=i,this.c=s,this.vx=0,this.vy=0,this.originX=t,this.originY=e}set(t,e){this.x=t,this.y=e}think(t,e){let i=this.x-t.x,s=this.y-t.y;if(Math.sqrt(i*i+s*s)<t.r){let a=Math.atan2(s,i),h=t.x+Math.cos(a)*t.r,l=t.y+Math.sin(a)*t.r;this.vx+=h-this.x,this.vy+=l-this.y}this.vx+=e.spring.vx(this.x,this.originX,e),this.vy+=e.spring.vy(this.y,this.originY,e),this.vx*=e.friction.vx(this.x,this.originX,e),this.vy*=e.friction.vy(this.x,this.originX,e),this.x+=this.vx,this.y+=this.vy}render(t){t.beginPath(),t.arc(this.x,this.y,this.r,0,2*Math.PI),t.fillStyle=this.c,t.fill(),t.closePath()}};class ft{constructor(){o(this,"balls");o(this,"player");o(this,"game2D");this.game2D=new p,this.balls=me(5e3,this.game2D.env),this.player=new b(100,100,20,"#eebe0a");let t={friction:ge(.5),spring:pe(.01)};this.game2D.tick((e,i)=>{this.player.set(i.x,i.y),this.player.render(e),this.balls.forEach(s=>{s.think(this.player,t),s.render(e)})})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.balls=void 0,this.player=void 0}}o(ft,"id","Balls");function me(r,t){let e=[],i=t.width/10,s=t.height/10;for(let n=0;n<r;n++){let a=i+Math.random()*(t.width-i*2),h=s+Math.random()*(t.height-s*2);e.push(new b(a,h,2,"#ff0000"))}return e}function pe(r){return{vx(t,e){return-(t-e)*r},vy(t,e){return-(t-e)*r}}}function ge(r){return{vx(){return r},vy(){return r}}}class mt{constructor(){o(this,"balls");o(this,"player");o(this,"game2D");this.game2D=new p,this.balls=ve(5e3,this.game2D.env),this.player=new b(100,100,20,"#eebe0a");let t={friction:Te(),spring:we()};this.game2D.tick((e,i)=>{this.player.set(i.x,i.y),this.player.render(e),this.balls.forEach(s=>{s.think(this.player,{...this.game2D.env,...t}),s.render(e)})})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.balls=void 0,this.player=void 0}}o(mt,"id","Balls2");function ve(r,t){let e=[],i=t.width/10,s=t.height/10;for(let n=0;n<r;n++){let a=i+Math.random()*(t.width-i*2),h=s+Math.random()*(t.height-s*2);e.push(new b(a,h,a>t.width/2?2:3,a>t.width/2?"#00bcd4":"#bdb76b"))}return e}function we(){let r=0,t=0;return{vx(e,i,s){let n=i>s.width/2?r:t;return-(e-i)*n},vy(e,i,s){let n=i>s.width/2?r:t;return-(e-i)*n}}}function Te(){let r=.99,t=.4;return{vx(e,i,s){return i>s.width/2?r:t},vy(e,i,s){return i>s.width/2?r:t}}}class be{constructor(t){o(this,"x",0);o(this,"y",0);o(this,"pressed",!1);o(this,"rect");o(this,"canvas");o(this,"touch_start",()=>{this.pressed=!0});o(this,"touch_end",()=>{this.pressed=!1,this.x=0,this.y=0});o(this,"touch_move",t=>{let e=0,i=0,s=t.touches[0];s.pageX||s.pageY?(e=s.pageX,i=s.pageY):(e=s.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=s.clientY+document.body.scrollTop+document.documentElement.scrollTop),e-=this.canvas.offsetLeft,i-=this.canvas.offsetTop,this.x=e,this.y=i});this.canvas=t,t.addEventListener("touchstart",this.touch_start,!1),t.addEventListener("touchmove",this.touch_move,!1),t.addEventListener("touchend",this.touch_end,!1)}destroy(){this.canvas.removeEventListener("touchstart",this.touch_start,!1),this.canvas.removeEventListener("touchmove",this.touch_move,!1),this.canvas.removeEventListener("touchend",this.touch_end,!1)}}class pt{constructor(){o(this,"balls");o(this,"player");o(this,"game2D");this.game2D=new p({controller:be});const t=this.game2D.env;this.balls=_e(2e3,t),this.player=new b(t.width/2,t.height/2,30,"#eebe0a");let e={friction:ke(.99),spring:Me(0)};this.game2D.tick((i,s)=>{s.pressed&&this.player.set(s.x,s.y),this.player.render(i),this.balls.forEach(n=>{n.think(this.player,e),n.render(i)})})}destroy(){this.game2D.destroy(),this.balls=void 0,this.game2D=void 0,this.player=void 0}}o(pt,"id","BallTouch");function _e(r,t){let e=[],i=t.width/20,s=t.height/20;for(let n=0;n<r;n++){let a=i+Math.random()*(t.width-i*2),h=s+Math.random()*(t.height-s*2);e.push(new b(a,h,2,"#00bcd4"))}return e}function Me(r){return{vx(t,e){return-(t-e)*r},vy(t,e){return-(t-e)*r}}}function ke(r){return{vx(){return r},vy(){return r}}}class gt{constructor(){o(this,"balls");o(this,"player");o(this,"game2D");this.game2D=new p,this.balls=Se().map(e=>(e.set(100+Math.random()*500,100+Math.random()*400),e)),this.player=new b(100,100,20,"#eebe0a");let t={friction:Be(.8),spring:$e(.007)};this.game2D.tick((e,i)=>{this.player.set(i.x,i.y),this.player.render(e),this.balls.forEach(s=>{s.think(this.player,t),s.render(e)})})}destroy(){this.game2D.destroy(),this.balls=void 0,this.game2D=void 0,this.player=void 0}}o(gt,"id","Pidor");const Pe="#ff0000",De=2,m=(r,t,e=Pe)=>new b(r,t,De,e),u=20;function Se(){return[...Ee(),...Ie(),...Le(),...Ce(),...We(),...Ae(),...ze()]}function Ee(){return[...g(200,250,u,r=>m(r,100)),...g(100,150,u,r=>m(225,r))]}function Ie(){return[...g(100,150,u,r=>m(270,r)),...z(270,135,u),...g(100,150,u,r=>m(310,r))]}function Le(){return[...g(170,220,u,r=>m(150,r)),...g(150,170,u,r=>m(r,170)),...g(170,220,u,r=>m(170,r))]}function Ce(){return[...g(170,220,u,r=>m(190,r)),...Re(190,220,u),...g(170,220,u,r=>m(230,r))]}function We(){return[...g(170,220,u,r=>m(260,r)),...z(260,195,u,25)]}function Ae(){return[...z(325,185,u,15,1),...g(180,210,u,r=>m(310,r)),...g(180,210,u,r=>m(340,r)),...z(325,205,u,15,2)]}function ze(){return[...g(170,220,u,r=>m(370,r)),...z(370,185,u,15,1.5)]}function z(r,t,e,i=15,s=1.5){let n=[];for(var a=0;a<=e;a++)n.push(m(r+i*Math.cos(Math.PI*a/e+Math.PI*s),t+i*Math.sin(Math.PI*a/e+Math.PI*s)));return n}function Re(r,t,e){let i=[];for(var s=0;s<e;s++)i.push(m(r+2*s,t-2.5*s));return i}function g(r,t,e,i){let s=t-r,n=Math.trunc(s/(e-1)),a=[];for(let h=r;h<=t;h+=n)a.push(i(h));return a}function $e(r){return{vx(t,e){return-(t-e)*r},vy(t,e){return-(t-e)*r}}}function Be(r){return{vx(){return r},vy(){return r}}}class vt{constructor(){o(this,"game2D");this.game2D=new p;let t=new He(150,150),e=new b(100,100,20,"#eebe0a");this.game2D.tick((i,s)=>{e.set(s.x,s.y),e.render(i),t.ratateTo(s),t.draw(i)})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(vt,"id","Arrow");let He=class{constructor(t=0,e=0,i="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=t,this.y=e,this.color=i,this.rotation=0}ratateTo({x:t,y:e}){let i=t-this.x,s=e-this.y;this.rotation=Math.atan2(s,i)}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.lineWidth=2,t.fillStyle=this.color,t.beginPath(),t.moveTo(-50,-25),t.lineTo(0,-25),t.lineTo(0,-50),t.lineTo(50,0),t.lineTo(0,50),t.lineTo(0,25),t.lineTo(-50,25),t.lineTo(-50,-25),t.closePath(),t.fill(),t.stroke(),t.restore()}};class wt{constructor(){o(this,"game2D");o(this,"rect_1");o(this,"rect_2");this.game2D=new p;const t=this.game2D.env;this.rect_1={x:Math.random()*t.width,y:Math.random()*t.height},this.rect_2={x:Math.random()*t.width,y:Math.random()*t.height},this.game2D.tick((e,i)=>{e.fillStyle="#000000",e.fillRect(this.rect_1.x-2,this.rect_1.y-2,4,4),e.fillStyle="#ff0000",e.fillRect(this.rect_2.x-2,this.rect_2.y-2,4,4),e.font="30px Arial",e.fillText(`points distance: ${it(this.rect_1,this.rect_2)}`,10,100),e.fillText(`mouse distance: ${it(i,this.rect_2)}`,10,130),e.beginPath(),e.moveTo(this.rect_2.x,this.rect_2.y),e.lineTo(i.x,i.y),e.closePath(),e.stroke()})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.rect_1=void 0,this.rect_2=void 0}}o(wt,"id","Distance");function it(r,t){let e=r.x-t.x,i=r.y-t.y;return Math.sqrt(e*e+i*i).toFixed(2)}class T{constructor(t=100,e=100,i=20,s="#ff0000"){o(this,"x",200);o(this,"y",100);o(this,"scaleX",1);o(this,"scaleY",1);o(this,"lineWidth",1);o(this,"color","");o(this,"radius",10);o(this,"rotation",0);this.x=t,this.y=e,this.color=s,this.radius=i}ratateTo({x:t,y:e}){let i=t-this.x,s=e-this.y;this.rotation=Math.atan2(s,i)}render(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.scale(this.scaleX,this.scaleY),t.lineWidth=this.lineWidth,t.fillStyle=this.color,t.beginPath(),t.arc(0,0,this.radius,0,Math.PI*2,!0),t.closePath(),t.fill(),this.lineWidth>0&&t.stroke(),t.restore()}}class Tt{constructor(){o(this,"game2D");this.game2D=new p;const t=this.game2D.env;let e={angle:0,centrY:200,range:50,xspeed:3,yspeed:.05},i={angle:0,centryScale:1,range:.5,speed:.1},s={angleX:0,angleY:0,range:150,centerX:0,centerY:0,xspeed:.07,yspeed:.11},n=new T(0,0),a=new T(t.width/2,t.height/2,30,"#00ff00"),h=new T(t.width/2,t.height/2,30,"#0000ff");s.centerX=t.width/2,s.centerY=t.height/2,this.game2D.tick(l=>{e.angle+=e.yspeed,n.x+=e.xspeed,n.y=e.centrY/2+Math.sin(e.angle)*e.range,n.x>t.width+n.radius&&(n.x=-n.radius,e.range+=1),a.scaleX=i.centryScale+Math.sin(i.angle)*i.range,a.scaleY=i.centryScale+Math.sin(i.angle)*i.range,i.angle+=i.speed,h.x=s.centerX+Math.sin(s.angleX)*s.range,h.y=s.centerY+Math.sin(s.angleY)*s.range,s.angleX+=s.xspeed,s.angleY+=s.yspeed,s.range+=.01,a.render(l),n.render(l),h.render(l)})}destroy(){this.game2D.destroy()}}o(Tt,"id","Liner");class bt{constructor(){o(this,"game2D");o(this,"ball");o(this,"ball_oval");this.game2D=new p;const t=this.game2D.env;this.ball=new T(200,200,40,"#11bbff"),this.ball_oval=new T(200,200,20,"#00ffff");let e=t.width/2,i=t.height/2,s=0,n=100,a=.02;this.game2D.tick(h=>{s+=a,this.ball.x=e+Math.sin(s)*n,this.ball.y=i+Math.cos(s)*n,this.ball_oval.x=this.ball.x+Math.sin(s*2)*100,this.ball_oval.y=this.ball.y+Math.cos(s*2)*40,this.ball.y-this.ball_oval.y>0?(this.ball_oval.render(h),this.ball.render(h)):(this.ball.render(h),this.ball_oval.render(h))})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(bt,"id","Circle");class _t{constructor(){o(this,"game2D");this.game2D=new p;const t=this.game2D.env;let e=40,i=0,s=new T(t.width/2,t.height/2,e,"#ffee00"),n=new T(t.width/2,t.height/2,e,"#00ff00"),a=new T(t.width/2,t.height/2,e,"#0000ff"),h=new T(t.width/2,t.height/2,e,"#f0f0f0"),l=new T(t.width/2,t.height/2,e);this.game2D.tick(c=>{i+=.03;let y=t.width/2,_=t.height/2;s.x=y+Math.sin(i*.2)*(y-e),n.y=_+Math.sin(i*.3)*(_-e),a.y=_+Math.sin(i*.4)*(_-e),a.x=y+Math.sin(i)*(y-e),h.y=_+Math.sin(i*.5)*(_-e),h.x=y+Math.cos(i*.2)*(y-e),l.x=y+Math.sin(i*2)*(y-e),s.render(c),n.render(c),a.render(c),h.render(c),l.render(c)})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(_t,"id","Waves");class C{constructor(t={}){o(this,"loop");o(this,"resize");o(this,"context2d");o(this,"controller");o(this,"env");const{controller:e=at}=t,i=document.body;this.env={width:i.offsetWidth,height:i.offsetHeight},this.loop=new nt,this.resize=new ht(i),this.context2d=new U(i.offsetWidth,i.offsetHeight),this.controller=new e(this.context2d.canvas),this.resize.changed((s,n)=>{this.context2d.resize(s,n)})}tick(t){this.loop.tick(e=>{t(this.context2d.ctx,this.controller,e)})}destroy(){this.loop.destroy(),this.resize.destroy(),this.context2d.destroy(),this.controller.destroy(),this.loop=void 0,this.resize=void 0,this.context2d=void 0,this.controller=void 0}}class Mt{constructor(){o(this,"pencil");o(this,"game2D");this.game2D=new C;const t=this.game2D.env;this.pencil=new Xe(t),this.game2D.tick((e,i)=>{this.pencil.draw(e,i)})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.pencil=void 0}}o(Mt,"id","Curves");let Xe=class{constructor(t){o(this,"points",[]);o(this,"point",{x0:0,y0:0,x1:0,y1:0});this.points=R(20,()=>({x:Math.random()*t.width,y:Math.random()*t.height})),this.point={x0:Math.random()*t.width,y0:Math.random()*t.height,x1:Math.random()*t.width,y1:Math.random()*t.height}}draw(t,e){t.beginPath(),t.strokeStyle="#00ff00",t.lineWidth=10,t.lineCap="butt",t.lineJoin="round",t.miterLimit=20,t.moveTo(this.point.x0,this.point.y0),t.quadraticCurveTo(e.x,e.y,this.point.x1,this.point.y1),t.stroke(),t.beginPath(),t.strokeStyle="#ff0000",t.lineWidth=5,t.lineCap="butt",t.lineJoin="round",t.miterLimit=10,t.moveTo(this.points[0].x,this.points[0].y);for(let i=1;i<this.points.length-1;i+=2)t.quadraticCurveTo(this.points[i].x,this.points[i].y,this.points[i+1].x,this.points[i+1].y);t.stroke()}};class kt{constructor(){o(this,"context2d");let t={x:100,y:100},e={x:200,y:200},i={x:350,y:150,r:0},s={x:350,y:150,r:50};const n=document.body;this.context2d=new U(n.offsetWidth,n.offsetHeight);const a=this.context2d.ctx;let h=a.createLinearGradient(t.x,t.y,e.x,e.y);h.addColorStop(0,"#ffffff"),h.addColorStop(.5,"#0000ff"),h.addColorStop(1,"#ff0000"),a.fillStyle=h,a.fillRect(100,100,200,200);let l=a.createRadialGradient(i.x,i.y,i.r,s.x,s.y,s.r);l.addColorStop(0,"#000000"),l.addColorStop(1,"rgba(0, 0, 0, 0)"),a.fillStyle=l,a.fillRect(300,100,100,100)}destroy(){this.context2d.destroy(),this.context2d=void 0}}o(kt,"id","Gradient");class Ye{constructor(t,e,i){o(this,"url");o(this,"data");o(this,"status");this.url=t,this.data=document.createElement("video"),this.data.width=e,this.data.height=i,this.data.autoplay=!0,this.status="new"}load(t){this.data.setAttribute("src",this.url),this.data.addEventListener("loadeddata",()=>{this.data.readyState>=3&&t()})}get isLoaded(){return this.status==="loaded"}}class st{constructor(t){o(this,"url");o(this,"data");o(this,"status");this.url=t,this.data=new Image,this.status="new"}load(t){this.data.src=this.url,this.data.onload=t}get isLoaded(){return this.status==="loaded"}}class Ne{constructor(t){o(this,"assets");this.assets=t}load(){return new Promise(t=>{let e=this.assets.length;const i=()=>{e=e-1,e===0&&t(this.assets)};this.assets.forEach(s=>s.load(i))})}}const Oe="/js-animations/assets/vovka-3b8ecfa6.png",Fe="/js-animations/assets/floor_tiles-899c51d6.png",qe="/js-animations/assets/video-f1e39b4f.mov";class Pt{constructor(){o(this,"game2D");this.game2D=new C,new Ne([new st(Oe),new st(Fe),new Ye(qe,640,360)]).load().then(([e,i,s])=>{this.game2D.tick(n=>{n.drawImage(i.data,230,20,80,140,200,130,100,120),n.drawImage(e.data,80,0,135,135,90,90,65,65),n.drawImage(s.data,300,150,100,100)})})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(Pt,"id","Images");class Dt{constructor(){o(this,"pencil");o(this,"game2D");this.game2D=new C,this.pencil=new Ge,this.game2D.tick((t,e)=>{this.pencil.draw(t,e)})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.pencil=void 0}}o(Dt,"id","Line");let Ge=class{constructor(){o(this,"prevPos")}draw(t,e){D(this.prevPos)&&e.pressed?(t.strokeStyle="#ff0000",t.lineWidth=2,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.beginPath(),t.moveTo(e.x,e.y),this.prevPos={x:e.x,y:e.y}):!D(this.prevPos)&&e.pressed?(t.lineTo(e.x,e.y),this.prevPos={x:e.x,y:e.y},t.stroke()):!D(this.prevPos)&&!e.pressed&&(this.prevPos=null)}};class St{constructor(){o(this,"pencil");o(this,"game2D");this.game2D=new C;const t=this.game2D.env;this.pencil=new Ue(t),this.game2D.tick(e=>{this.pencil.draw(e)})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.pencil=void 0}}o(St,"id","MultiCurves");let Ue=class{constructor(t){o(this,"count",10);o(this,"points",[]);o(this,"ctrlPoint",{});this.points=R(this.count,()=>({x:Math.random()*t.width,y:Math.random()*t.height}))}draw(t){t.beginPath(),t.strokeStyle="#ff0000",t.lineWidth=5,t.lineCap="butt",t.lineJoin="round",t.miterLimit=10;let e=(this.points[0].x+this.points[this.count-1].x)/2,i=(this.points[0].y+this.points[this.count-1].y)/2;t.moveTo(e,i);let s;for(s=1;s<this.points.length-2;s++){let n=(this.points[s].x+this.points[s+1].x)/2,a=(this.points[s].y+this.points[s+1].y)/2;t.quadraticCurveTo(this.points[s].x,this.points[s].y,n,a)}t.quadraticCurveTo(this.points[s].x,this.points[s].y,e,i),t.stroke(),t.beginPath(),t.strokeStyle="#0000ff",t.lineWidth=3,t.arc(100,200,40,0,Math.PI*2,!0),t.closePath(),t.stroke(),t.beginPath(),t.strokeStyle="#00ff44",t.lineWidth=5,t.moveTo(200,200),t.arcTo(200,50,150,200,20),t.stroke()}};class je{static colorToRGB(t,e=1){let i;typeof t=="string"&&t[0]==="#"&&(i=parseInt(t.slice(1),16));var s=i>>16&255,n=i>>8&255,a=i&255,h=e<0?0:e>1?1:e;return h===1?`rgb(${s},${n},${a})`:`rgb(${s},${n},${a},${h})`}static parse(t,e=!1){return e===!0?typeof t=="number"?t|0:(typeof t=="string"&&t[0]==="#"&&(t=t.slice(1)),parseInt(t,16)):(typeof t=="number"&&(t="#"+("00000"+(t|0).toString(16)).substr(-6)),t)}}class Et{constructor(){o(this,"game2D");o(this,"pencil");this.game2D=new C;const t=this.game2D.env,e=this.game2D.context2d.ctx.getImageData(0,0,t.width,t.height);this.pencil=new Ke,this.game2D.tick((i,s)=>{this.pencil.draw(i,s,e)})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.pencil=void 0}}o(Et,"id","Pixel");let Ke=class{constructor(){o(this,"prevPos");o(this,"brush_size",25);o(this,"brush_density",50);o(this,"brush_color",0)}draw(t,e,i){let s=i.data;if(D(this.prevPos)&&e.pressed)this.brush_color=je.parse(Math.random()*16777215,!0),this.prevPos={x:e.x,y:e.y};else if(!D(this.prevPos)&&e.pressed){for(let n=0;n<this.brush_density;n++){let a=Math.random()*Math.PI*2,h=Math.random()*this.brush_size,l=e.x+Math.cos(a)*h|0,c=e.y+Math.sin(a)*h|0,y=(l+c*i.width)*4;s[y]=this.brush_color>>16&255,s[y+1]=this.brush_color>>8&255,s[y+2]=this.brush_color&255,s[y+3]=255}t.putImageData(i,0,0),this.prevPos={x:e.x,y:e.y}}else!D(this.prevPos)&&!e.pressed&&(this.prevPos=null)}};class It{constructor(){o(this,"pencil");o(this,"game2D");this.game2D=new C;const t=this.game2D.env;this.pencil=new Je(t),this.game2D.tick(e=>{this.pencil.draw(e)})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.pencil=void 0}}o(It,"id","Shapes");class Je{constructor(t){o(this,"count",10);o(this,"points",[]);o(this,"ctrlPoint",{});this.points=R(this.count,()=>({x:Math.random()*t.width,y:Math.random()*t.height}))}draw(t){t.beginPath(),t.fillStyle="#ff0000";let e=(this.points[0].x+this.points[this.count-1].x)/2,i=(this.points[0].y+this.points[this.count-1].y)/2;t.moveTo(e,i);let s;for(s=1;s<this.points.length-2;s++){let n=(this.points[s].x+this.points[s+1].x)/2,a=(this.points[s].y+this.points[s+1].y)/2;t.quadraticCurveTo(this.points[s].x,this.points[s].y,n,a)}t.quadraticCurveTo(this.points[s].x,this.points[s].y,e,i),t.fill(),t.beginPath(),t.fillStyle="#00ff44",t.moveTo(100,100),t.arcTo(200,50,150,200,20),t.fill()}}class Lt{constructor(){o(this,"game2D");this.game2D=new p;const t=this.game2D.env;let e=new Ve(t.width/2,t.height/2),i=0;this.game2D.tick((s,n,a)=>{a.pressed("ArrowLeft")&&(e.rotation-=2*Math.PI/180),a.pressed("ArrowRight")&&(e.rotation+=2*Math.PI/180),a.pressed("ArrowUp")&&i<4&&(i+=.2),a.pressed("ArrowDown")&&(i-=.2),i<0?i=0:i-=.05;let h=Math.cos(e.rotation)*i,l=Math.sin(e.rotation)*i;e.x+=h,e.y+=l,e.draw(s)})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(Lt,"id","Acceleration");let Ve=class{constructor(t=0,e=0,i="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=t,this.y=e,this.color=i,this.rotation=0}ratateTo({x:t,y:e}){let i=t-this.x,s=e-this.y;this.rotation=Math.atan2(s,i)}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.lineWidth=2,t.fillStyle=this.color,t.strokeStyle="#000000",t.beginPath(),t.moveTo(-50,-25),t.lineTo(0,-25),t.lineTo(0,-50),t.lineTo(50,0),t.lineTo(0,50),t.lineTo(0,25),t.lineTo(-50,25),t.lineTo(-50,-25),t.closePath(),t.fill(),t.stroke(),t.restore()}};class Ze{constructor(t=0,e=0,i="#ffff00"){o(this,"x");o(this,"y");o(this,"color","");o(this,"rotation",0);this.x=t,this.y=e,this.color=i,this.rotation=0}ratateTo({x:t,y:e}){let i=t-this.x,s=e-this.y;this.rotation=Math.atan2(s,i)}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.lineWidth=2,t.fillStyle=this.color,t.strokeStyle="#000000",t.beginPath(),t.moveTo(-50,-25),t.lineTo(0,-25),t.lineTo(0,-50),t.lineTo(50,0),t.lineTo(0,50),t.lineTo(0,25),t.lineTo(-50,25),t.lineTo(-50,-25),t.closePath(),t.fill(),t.stroke(),t.restore()}}class Ct{constructor(){o(this,"game2D");let t=.05,e=0,i=0;this.game2D=new p;const s=this.game2D.env;let n=new Ze(s.width/2,s.height/2);this.game2D.tick((a,h)=>{let l=h.x-n.x,c=h.y-n.y,y=Math.atan2(c,l),_=Math.cos(y)*t,At=Math.sin(y)*t;n.rotation=y,e+=_,i+=At,n.x+=e,n.y+=i,n.draw(a)})}destroy(){this.game2D.destroy(),this.game2D=void 0}}o(Ct,"id","Mouse1");const Qe=50,A=10;class Wt{constructor(){o(this,"game2D");o(this,"rect");o(this,"balls",[]);this.game2D=new p;const t=this.game2D.env;this.rect=ti(t),this.balls=ei(this.rect),this.game2D.tick(e=>{this.balls=xe(this.balls,this.rect),this.balls.forEach(i=>{i.think(),i.render(e)}),this.rect.render(e)})}destroy(){this.game2D.destroy(),this.game2D=void 0,this.rect=void 0,this.balls=[]}}o(Wt,"id","Removal");function xe(r,t){return r.filter(e=>!(e.x-e.radius>t.right||e.x+e.radius<t.x||e.y-e.radius>t.bottom||e.y+e.radius<t.y))}function ti(r){return new S(100,100,r.width-200,r.height-200,"#00ff00")}function ei(r){return R(Qe,()=>new rt(A+r.x+Math.random()*(r.right-2*A),A+r.y+Math.random()*(r.bottom-2*A),A,"#ff6600",new Yt(Math.random()*2-1,Math.random()*2-1)))}const ii=new ot("simple_examples",[Wt,Ct,Lt,Et,Pt,kt,It,St,Mt,Dt,wt,bt,Tt,_t,vt,ft,mt,pt,gt]);new Ht([fe,ii]);
